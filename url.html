<!doctype html><html lang="en">
 <head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <meta content="#3c790a" name="theme-color">
  <title>URL Standard</title>
  <link href="https://resources.whatwg.org/standard.css" rel="stylesheet">
  <link href="https://resources.whatwg.org/bikeshed.css" rel="stylesheet">
  <link href="https://resources.whatwg.org/logo-url.svg" rel="icon">
  <meta content="Bikeshed 1.0.0" name="generator">
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
        .highlight:not(.idl) { background: hsl(24, 20%, 95%); }
        code.highlight { padding: .1em; border-radius: .3em; }
        pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
        .highlight .c { color: #708090 } /* Comment */
        .highlight .k { color: #990055 } /* Keyword */
        .highlight .l { color: #000000 } /* Literal */
        .highlight .n { color: #0077aa } /* Name */
        .highlight .o { color: #999999 } /* Operator */
        .highlight .p { color: #999999 } /* Punctuation */
        .highlight .cm { color: #708090 } /* Comment.Multiline */
        .highlight .cp { color: #708090 } /* Comment.Preproc */
        .highlight .c1 { color: #708090 } /* Comment.Single */
        .highlight .cs { color: #708090 } /* Comment.Special */
        .highlight .kc { color: #990055 } /* Keyword.Constant */
        .highlight .kd { color: #990055 } /* Keyword.Declaration */
        .highlight .kn { color: #990055 } /* Keyword.Namespace */
        .highlight .kp { color: #990055 } /* Keyword.Pseudo */
        .highlight .kr { color: #990055 } /* Keyword.Reserved */
        .highlight .kt { color: #990055 } /* Keyword.Type */
        .highlight .ld { color: #000000 } /* Literal.Date */
        .highlight .m { color: #000000 } /* Literal.Number */
        .highlight .s { color: #a67f59 } /* Literal.String */
        .highlight .na { color: #0077aa } /* Name.Attribute */
        .highlight .nc { color: #0077aa } /* Name.Class */
        .highlight .no { color: #0077aa } /* Name.Constant */
        .highlight .nd { color: #0077aa } /* Name.Decorator */
        .highlight .ni { color: #0077aa } /* Name.Entity */
        .highlight .ne { color: #0077aa } /* Name.Exception */
        .highlight .nf { color: #0077aa } /* Name.Function */
        .highlight .nl { color: #0077aa } /* Name.Label */
        .highlight .nn { color: #0077aa } /* Name.Namespace */
        .highlight .py { color: #0077aa } /* Name.Property */
        .highlight .nt { color: #669900 } /* Name.Tag */
        .highlight .nv { color: #222222 } /* Name.Variable */
        .highlight .ow { color: #999999 } /* Operator.Word */
        .highlight .mb { color: #000000 } /* Literal.Number.Bin */
        .highlight .mf { color: #000000 } /* Literal.Number.Float */
        .highlight .mh { color: #000000 } /* Literal.Number.Hex */
        .highlight .mi { color: #000000 } /* Literal.Number.Integer */
        .highlight .mo { color: #000000 } /* Literal.Number.Oct */
        .highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
        .highlight .sc { color: #a67f59 } /* Literal.String.Char */
        .highlight .sd { color: #a67f59 } /* Literal.String.Doc */
        .highlight .s2 { color: #a67f59 } /* Literal.String.Double */
        .highlight .se { color: #a67f59 } /* Literal.String.Escape */
        .highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
        .highlight .si { color: #a67f59 } /* Literal.String.Interpol */
        .highlight .sx { color: #a67f59 } /* Literal.String.Other */
        .highlight .sr { color: #a67f59 } /* Literal.String.Regex */
        .highlight .s1 { color: #a67f59 } /* Literal.String.Single */
        .highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
        .highlight .vc { color: #0077aa } /* Name.Variable.Class */
        .highlight .vg { color: #0077aa } /* Name.Variable.Global */
        .highlight .vi { color: #0077aa } /* Name.Variable.Instance */
        .highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
        </style>
 <body class="h-entry status-LS">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://whatwg.org/"> <img alt="WHATWG" height="100" src="https://resources.whatwg.org/logo-url.svg"> </a> </p>
   <hgroup>
    <h1 class="p-name no-ref allcaps" id="title">URL</h1>
    <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Living Standard — Last Updated <time class="dt-updated" datetime="2016-09-02">2 September 2016</time></span></h2>
   </hgroup>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>Participate:
     <dd><span><a href="https://github.com/whatwg/url">GitHub whatwg/url</a> (<a href="https://github.com/whatwg/url/issues/new">new issue</a>, <a href="https://github.com/whatwg/url/issues">open issues</a>, <a href="https://www.w3.org/Bugs/Public/buglist.cgi?product=WHATWG&amp;component=URL&amp;resolution=---">legacy open bugs</a>)</span>
     <dd><span><a href="https://wiki.whatwg.org/wiki/IRC">IRC: #whatwg on Freenode</a></span>
     <dt>Commits:
     <dd><span><a href="https://github.com/whatwg/url/commits">https://github.com/whatwg/url/commits</a></span>
     <dd><span><a href="https://twitter.com/urlstandard">@urlstandard</a></span>
     <dt>Translation (non-normative):
     <dd><span><span title="Japanese"><a href="https://triple-underscore.github.io/URL-ja.html" hreflang="ja" lang="ja" rel="alternate">日本語</a></span></span>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>The URL Standard defines URLs, domains, IP addresses, the <code title="">application/x-www-form-urlencoded</code> format, and their API.</p>
  </div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#goals"><span class="secno"></span> <span class="content">Goals</span></a>
    <li>
     <a href="#infrastructure"><span class="secno">1</span> <span class="content">Infrastructure</span></a>
     <ol class="toc">
      <li><a href="#parsers"><span class="secno">1.1</span> <span class="content">Parsers</span></a>
      <li><a href="#percent-encoded-bytes"><span class="secno">1.2</span> <span class="content">Percent-encoded bytes</span></a>
     </ol>
    <li><a href="#security-considerations"><span class="secno">2</span> <span class="content">Security considerations</span></a>
    <li>
     <a href="#hosts-(domains-and-ip-addresses)"><span class="secno">3</span> <span class="content">Hosts (domains and IP addresses)</span></a>
     <ol class="toc">
      <li><a href="#idna"><span class="secno">3.1</span> <span class="content">IDNA</span></a>
      <li><a href="#host-syntax"><span class="secno">3.2</span> <span class="content">Host syntax</span></a>
      <li><a href="#host-parsing"><span class="secno">3.3</span> <span class="content">Host parsing</span></a>
      <li><a href="#host-serializing"><span class="secno">3.4</span> <span class="content">Host serializing</span></a>
      <li><a href="#host-equivalence"><span class="secno">3.5</span> <span class="content">Host equivalence</span></a>
     </ol>
    <li>
     <a href="#urls"><span class="secno">4</span> <span class="content">URLs</span></a>
     <ol class="toc">
      <li><a href="#url-syntax"><span class="secno">4.1</span> <span class="content">URL syntax</span></a>
      <li><a href="#url-parsing"><span class="secno">4.2</span> <span class="content">URL parsing</span></a>
      <li><a href="#url-serializing"><span class="secno">4.3</span> <span class="content">URL serializing</span></a>
      <li><a href="#url-equivalence"><span class="secno">4.4</span> <span class="content">URL equivalence</span></a>
      <li><a href="#origin"><span class="secno">4.5</span> <span class="content">Origin</span></a>
      <li><a href="#url-rendering"><span class="secno">4.6</span> <span class="content">URL rendering</span></a>
     </ol>
    <li>
     <a href="#application/x-www-form-urlencoded"><span class="secno">5</span> <span class="content"><code>application/x-www-form-urlencoded</code></span></a>
     <ol class="toc">
      <li><a href="#urlencoded-parsing"><span class="secno">5.1</span> <span class="content"><code>application/x-www-form-urlencoded</code> parsing</span></a>
      <li><a href="#urlencoded-serializing"><span class="secno">5.2</span> <span class="content"><code>application/x-www-form-urlencoded</code> serializing</span></a>
      <li><a href="#urlencoded-hooks"><span class="secno">5.3</span> <span class="content">Hooks</span></a>
     </ol>
    <li>
     <a href="#api"><span class="secno">6</span> <span class="content">API</span></a>
     <ol class="toc">
      <li><a href="#constructors"><span class="secno">6.1</span> <span class="content">Constructors</span></a>
      <li><a href="#url-statics"><span class="secno">6.2</span> <span class="content"><code class="idl"><span>URL</span></code> statics</span></a>
      <li><a href="#urlutils-members"><span class="secno">6.3</span> <span class="content"><code class="idl"><span>URL</span></code> members</span></a>
      <li><a href="#interface-urlsearchparams"><span class="secno">6.4</span> <span class="content">Interface <code class="idl"><span>URLSearchParams</span></code></span></a>
      <li><a href="#url-apis-elsewhere"><span class="secno">6.5</span> <span class="content">URL APIs elsewhere</span></a>
     </ol>
    <li><a href="#acknowledgments"><span class="secno"></span> <span class="content">Acknowledgments</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
<script async="" src="https://resources.whatwg.org/file-issue.js"></script>
<script defer="" id="head" src="https://resources.whatwg.org/dfn.js"></script>
   <h2 class="no-num heading settled" id="goals"><span class="content">Goals</span></h2>
   <p>The URL standard takes the following approach towards making URLs fully interoperable: </p>
   <ul>
    <li>
     <p>Align RFC 3986 and RFC 3987 with contemporary implementations and
 obsolete them in the process. (E.g., spaces, other "illegal" code points,
 query encoding, equality, canonicalization, are all concepts not entirely
 shared, or defined.) URL parsing needs to become as solid as HTML parsing. <a data-link-type="biblio" href="#biblio-rfc3986">[RFC3986]</a> <a data-link-type="biblio" href="#biblio-rfc3987">[RFC3987]</a> </p>
    <li>
     <p>Standardize on the term URL. URI and IRI are just confusing. In
 practice a single algorithm is used for both so keeping them distinct is
 not helping anyone. URL also easily wins the <a href="http://www.googlefight.com/index.php?word1=url&amp;word2=uri">search result popularity contest</a>. </p>
    <li>
     <p>Supplanting <a href="https://tools.ietf.org/html/rfc6454#section-4">Origin of a URI [sic]</a>. <a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a> </p>
    <li>
     <p>Define URL’s existing JavaScript API in full detail and add
 enhancements to make it easier to work with. Add a new <code><a class="idl-code" data-link-type="interface" href="#url">URL</a></code> object as well for URL manipulation without usage of HTML elements. (Useful
 for JavaScript worker environments.) </p>
   </ul>
   <p class="note" role="note">As the editors learn more about the subject matter the goals
might increase in scope somewhat. </p>
   <h2 class="heading settled" data-level="1" id="infrastructure"><span class="secno">1. </span><span class="content">Infrastructure</span><a class="self-link" href="#infrastructure"></a></h2>
   <p>Some terms used in this specification are defined in the
DOM, Encoding, IDNA, and Web IDL Standards. <a data-link-type="biblio" href="#biblio-dom">[DOM]</a> <a data-link-type="biblio" href="#biblio-encoding">[ENCODING]</a> <a data-link-type="biblio" href="#biblio-idna">[IDNA]</a> <a data-link-type="biblio" href="#biblio-webidl">[WEBIDL]</a> </p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="c0-controls">C0 controls<a class="self-link" href="#c0-controls"></a></dfn> are code points in the range U+0000 to U+001F, inclusive. </p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="c0-controls-and-space">C0 controls and space<a class="self-link" href="#c0-controls-and-space"></a></dfn> are <a data-link-type="dfn" href="#c0-controls">C0 controls</a> and code point U+0020. </p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="tab-and-newline">tab and newline<a class="self-link" href="#tab-and-newline"></a></dfn> are code points U+0009, U+000A, and U+000D. </p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="ascii-digits">ASCII digits<a class="self-link" href="#ascii-digits"></a></dfn> are code points in the range U+0030 to U+0039, inclusive. </p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="ascii-hex-digits">ASCII hex digits<a class="self-link" href="#ascii-hex-digits"></a></dfn> are <a data-link-type="dfn" href="#ascii-digits">ASCII digits</a>, code points in the range
U+0041 to U+0046, inclusive, and code points in the range U+0061 to U+0066, inclusive. </p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="ascii-alpha">ASCII alpha<a class="self-link" href="#ascii-alpha"></a></dfn> are code points in the range U+0041 to U+005A, inclusive,
and in the range U+0061 to U+007A, inclusive. </p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="ascii-alphanumeric">ASCII alphanumeric<a class="self-link" href="#ascii-alphanumeric"></a></dfn> are <a data-link-type="dfn" href="#ascii-digits">ASCII digits</a> and <a data-link-type="dfn" href="#ascii-alpha">ASCII alpha</a>. </p>
   <p>An <dfn data-dfn-type="dfn" data-noexport="" id="ascii-string">ASCII string<a class="self-link" href="#ascii-string"></a></dfn> is a <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#string">string</a> in the range U+0000 to U+007F, inclusive. </p>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="ascii-lowercase">ASCII lowercase<a class="self-link" href="#ascii-lowercase"></a></dfn> a <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#string">string</a>, replace all code points in the range
U+0041 to U+005A, inclusive, with the corresponding code points in the range
U+0061 to U+007A, inclusive. </p>
   <hr>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="serialize-an-integer">serialize an integer<a class="self-link" href="#serialize-an-integer"></a></dfn>, represent it as the shortest possible decimal
number. </p>
   <hr>
   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="windows-drive-letter">Windows drive letter<a class="self-link" href="#windows-drive-letter"></a></dfn> is two code points, of which the first is
an <a data-link-type="dfn" href="#ascii-alpha">ASCII alpha</a> and the second is either "<code>:</code>" or "<code>|</code>". </p>
   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="normalized-windows-drive-letter">normalized Windows drive letter<a class="self-link" href="#normalized-windows-drive-letter"></a></dfn> is a <a data-link-type="dfn" href="#windows-drive-letter">Windows drive letter</a> of which
the second code point is "<code>:</code>". </p>
   <h3 class="heading settled" data-level="1.1" id="parsers"><span class="secno">1.1. </span><span class="content">Parsers</span><a class="self-link" href="#parsers"></a></h3>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="eof-code-point">EOF code point<a class="self-link" href="#eof-code-point"></a></dfn> is a conceptual code point that signifies the end of a
string or code point stream. </p>
   <p>Within a parser algorithm that uses a <var>pointer</var> variable, <dfn data-dfn-type="dfn" data-noexport="" id="c">c<a class="self-link" href="#c"></a></dfn> references the code point the <var>pointer</var> variable points to. </p>
   <p>Within a string-based parser algorithm that uses a <var>pointer</var> variable, <dfn data-dfn-type="dfn" data-noexport="" id="remaining">remaining<a class="self-link" href="#remaining"></a></dfn> references the substring after <var>pointer</var> in the string
being processed. </p>
   <p class="example" id="example-12672b6a"><a class="self-link" href="#example-12672b6a"></a>If "<code>mailto:username@example</code>" is a string being
processed and <var>pointer</var> points to "<code>@</code>", <a data-link-type="dfn" href="#c">c</a> is "<code>@</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> is
"<code>example</code>". </p>
   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="syntax-violation">syntax violation<a class="self-link" href="#syntax-violation"></a></dfn> indicates a non-fatal mismatch between input and syntax
requirements. User agents, especially conformance checkers are encouraged to report them
somewhere. </p>
   <p class="note no-backref" role="note">A <a data-link-type="dfn" href="#syntax-violation">syntax violation</a> does not mean that the parser
terminates. Termination of a parser is always stated explicitly. E.g., through a return
statement. </p>
   <h3 class="heading settled" data-level="1.2" id="percent-encoded-bytes"><span class="secno">1.2. </span><span class="content">Percent-encoded bytes</span><a class="self-link" href="#percent-encoded-bytes"></a></h3>
   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="percent-encoded-byte">percent-encoded byte<a class="self-link" href="#percent-encoded-byte"></a></dfn> is "<code>%</code>", followed by two <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digits</a>.
Sequences of <a data-link-type="dfn" href="#percent-encoded-byte">percent-encoded bytes</a>, after conversion to bytes,
should not cause <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decode-without-bom-or-fail">UTF-8 decode without BOM or fail</a> to return failure. </p>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="percent-encode">percent encode<a class="self-link" href="#percent-encode"></a></dfn> a <var>byte</var> into a <a data-link-type="dfn" href="#percent-encoded-byte">percent-encoded byte</a>, return a string consisting of
"<code>%</code>", followed by a double-digit, uppercase, hexadecimal
representation of <var>byte</var>. </p>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="percent-decode">percent decode<a class="self-link" href="#percent-decode"></a></dfn> a byte sequence <var>input</var>, run these steps: </p>
   <p class="warning">Using anything but <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decode-without-bom">UTF-8 decode without BOM</a> when the <var>input</var> contains bytes that are not <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#ascii-byte">ASCII bytes</a> might be insecure and is not recommended. </p>
   <ol>
    <li>
     <p>Let <var>output</var> be an empty byte sequence. </p>
    <li>
     <p>For each byte <var>byte</var> in <var>input</var>, run these steps: </p>
     <ol>
      <li>
       <p>If <var>byte</var> is not `<code>%</code>`, append <var>byte</var> to <var>output</var>. </p>
      <li>
       <p>Otherwise, if <var>byte</var> is `<code>%</code>` and the next two
   bytes after <var>byte</var> in <var>input</var> are not in the ranges
   0x30 to 0x39, 0x41 to 0x46, and 0x61 to 0x66, append <var>byte</var> to <var>output</var>. </p>
      <li>
       <p>Otherwise, run these substeps: </p>
       <ol>
        <li>
         <p>Let <var>bytePoint</var> be the two bytes after <var>byte</var> in <var>input</var>, <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decode-without-bom">decoded</a>, and
     then interpreted as hexadecimal number. </p>
        <li>
         <p>Append a byte whose value is <var>bytePoint</var> to <var>output</var>. </p>
        <li>
         <p>Skip the next two bytes in <var>input</var>. </p>
       </ol>
     </ol>
    <li>
     <p>Return <var>output</var>. </p>
   </ol>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="simple-encode-set">simple encode set<a class="self-link" href="#simple-encode-set"></a></dfn> are <a data-link-type="dfn" href="#c0-controls">C0 controls</a> and all code points greater
than U+007E. </p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="default-encode-set">default encode set<a class="self-link" href="#default-encode-set"></a></dfn> is the <a data-link-type="dfn" href="#simple-encode-set">simple encode set</a> and code points U+0020,
'<code>"</code>', 
"<code>#</code>", 
"<code>&lt;</code>", 
"<code>></code>", 
"<code>?</code>", 
"<code>`</code>", 
"<code>{</code>", 
and
"<code>}</code>". </p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="userinfo-encode-set">userinfo encode set<a class="self-link" href="#userinfo-encode-set"></a></dfn> is the <a data-link-type="dfn" href="#default-encode-set">default encode set</a> and code points
"<code>/</code>", 
"<code>:</code>", 
"<code>;</code>", 
"<code>=</code>", 
"<code>@</code>", 
"<code>[</code>", 
"<code>\</code>", 
"<code>]</code>", 
"<code>^</code>", 
and
"<code>|</code>". </p>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="utf-8-percent-encode">UTF-8 percent encode<a class="self-link" href="#utf-8-percent-encode"></a></dfn> a <var>codePoint</var>, using
an <var>encode set</var>, run these steps: </p>
   <ol>
    <li>
     <p>If <var>codePoint</var> is not in <var>encode set</var>, return <var>codePoint</var>. </p>
    <li>
     <p>Let <var>bytes</var> be the result of running <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-encode">UTF-8 encode</a> on <var>codePoint</var>. </p>
    <li>
     <p><a data-link-type="dfn" href="#percent-encode">Percent encode</a> each byte in <var>bytes</var>, and then return the results
 concatenated, in the same order. </p>
   </ol>
   <h2 class="heading settled" data-level="2" id="security-considerations"><span class="secno">2. </span><span class="content">Security considerations</span><a class="self-link" href="#security-considerations"></a></h2>
   <p>The security of a <a data-link-type="dfn" href="#concept-url">URL</a> is a function of its environment. Care is to be
taken when rendering, interpreting, and passing <a data-link-type="dfn" href="#concept-url">URLs</a> around. </p>
   <p>When rendering and allocating new <a data-link-type="dfn" href="#concept-url">URLs</a> "spoofing" needs to be
considered. An attack whereby one <a data-link-type="dfn" href="#concept-host">host</a> or <a data-link-type="dfn" href="#concept-url">URL</a> can be
confused for another. E.g., consider how 1/l/I, m/rn/rri, 0/O, and а/a can all appear
eerily similar. Or worse, consider how U+202A and similar code points are invisible. <a data-link-type="biblio" href="#biblio-uts36">[UTS36]</a> </p>
   <p>When passing a <a data-link-type="dfn" href="#concept-url">URL</a> from party <var>A</var> to <var>B</var>, both need to
carefully consider what is happening. <var>A</var> might end up leaking data it does not
want to leak. <var>B</var> might receive input it did not expect and take an action that
harms the user. In particular, <var>B</var> should never trust <var>A</var>, as at some
point <a data-link-type="dfn" href="#concept-url">URLs</a> from <var>A</var> can come from untrusted sources. </p>
   <h2 class="heading settled" data-level="3" id="hosts-(domains-and-ip-addresses)"><span class="secno">3. </span><span class="content">Hosts (domains and IP addresses)</span><a class="self-link" href="#hosts-%28domains-and-ip-addresses%29"></a></h2>
   <p>A <dfn data-dfn-for="host" data-dfn-type="dfn" data-export="" id="concept-host">host<a class="self-link" href="#concept-host"></a></dfn> is a <a data-link-type="dfn" href="#concept-domain">domain</a>, an <a data-link-type="dfn" href="#concept-ipv4">IPv4 address</a>, or an <a data-link-type="dfn" href="#concept-ipv6">IPv6 address</a>. Typically a <a data-link-type="dfn" href="#concept-host">host</a> serves as a network address, but it is sometimes (ab)used as opaque
identifier in <a data-link-type="dfn" href="#concept-url">URLs</a> where a network address is not necessary. </p>
   <p>A <dfn data-dfn-for="host" data-dfn-type="dfn" data-export="" id="concept-domain">domain<a class="self-link" href="#concept-domain"></a></dfn> identifies a realm within a
network. <a data-link-type="biblio" href="#biblio-rfc1034">[RFC1034]</a> </p>
   <p>An <dfn data-dfn-for="host" data-dfn-type="dfn" data-export="" id="concept-ipv4">IPv4 address<a class="self-link" href="#concept-ipv4"></a></dfn> is a 32-bit identifier. <a data-link-type="biblio" href="#biblio-rfc791">[RFC791]</a> </p>
   <p>An <dfn data-dfn-for="host" data-dfn-type="dfn" data-export="" id="concept-ipv6">IPv6 address<a class="self-link" href="#concept-ipv6"></a></dfn> is a 128-bit identifier and
for the purposes of this specification represented as an ordered list of
eight <dfn data-dfn-type="dfn" data-lt="IPv6 piece" data-noexport="" id="concept-ipv6-piece">16-bit pieces<a class="self-link" href="#concept-ipv6-piece"></a></dfn>. <a data-link-type="biblio" href="#biblio-rfc4291">[RFC4291]</a> </p>
   <p class="note" role="note">Support for <code>&lt;zone_id></code> is <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=27234#c2">intentionally omitted</a>. </p>
   <h3 class="heading settled" data-level="3.1" id="idna"><span class="secno">3.1. </span><span class="content">IDNA</span><a class="self-link" href="#idna"></a></h3>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-domain-to-ascii">domain to ASCII<a class="self-link" href="#concept-domain-to-ascii"></a></dfn> given a <a data-link-type="dfn" href="#concept-domain">domain</a> <var>domain</var>, runs these steps: </p>
   <ol>
    <li>
     <p>Let <var>result</var> be the result of running <a data-link-type="dfn" href="http://www.unicode.org/reports/tr46/#ToASCII">Unicode ToASCII</a> with <i>domain_name</i> set to <var>domain</var>, <i>UseSTD3ASCIIRules</i> set to false, <i>processing_option</i> set to <i>Transitional_Processing</i>, and <i>VerifyDnsLength</i> set to false. </p>
    <li>
     <p>If <var>result</var> is a failure value, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
    <li>
     <p>Return <var>result</var>. </p>
   </ol>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-domain-to-unicode">domain to Unicode<a class="self-link" href="#concept-domain-to-unicode"></a></dfn> given a <a data-link-type="dfn" href="#concept-domain">domain</a> <var>domain</var>, runs these steps: </p>
   <ol>
    <li>
     <p>Let <var>result</var> be the result of running <a data-link-type="dfn" href="http://www.unicode.org/reports/tr46/#ToUnicode">Unicode ToUnicode</a> with <i>domain_name</i> set to <var>domain</var>, <i>UseSTD3ASCIIRules</i> set to false. </p>
    <li>
     <p>Signify <a data-link-type="dfn" href="#syntax-violation">syntax violations</a> for any returned errors, and then, return <var>result</var>. </p>
   </ol>
   <h3 class="heading settled" data-level="3.2" id="host-syntax"><span class="secno">3.2. </span><span class="content">Host syntax</span><a class="self-link" href="#host-syntax"></a></h3>
   <p>A <dfn data-dfn-for="hostsyntax" data-dfn-type="dfn" data-export="" id="syntax-host">host<a class="self-link" href="#syntax-host"></a></dfn> must be a <a data-link-type="dfn" href="#syntax-host-domain">domain</a>, an <a data-link-type="dfn" href="#syntax-host-ipv4">IPv4 address</a>, or "<code>[</code>",
followed by an <a data-link-type="dfn" href="#syntax-host-ipv6">IPv6 address</a>, followed by "<code>]</code>". </p>
   <p>A <var>domain</var> is a <dfn data-dfn-type="dfn" data-noexport="" id="valid-domain">valid domain<a class="self-link" href="#valid-domain"></a></dfn> if these steps return success: </p>
   <ol>
    <li>
     <p>Let <var>result</var> be the result of running <a data-link-type="dfn" href="http://www.unicode.org/reports/tr46/#ToASCII">Unicode ToASCII</a> with <i>domain_name</i> set to <var>domain</var>, <i>UseSTD3ASCIIRules</i> set to true, <i>processing_option</i> set to <i>Nontransitional_Processing</i>, and <i>VerifyDnsLength</i> set to true. </p>
    <li>
     <p>If <var>result</var> is a failure value, return failure. </p>
    <li>
     <p>Set <var>result</var> to the result of running <a data-link-type="dfn" href="http://www.unicode.org/reports/tr46/#ToUnicode">Unicode ToUnicode</a> with <i>domain_name</i> set to <var>result</var>, <i>UseSTD3ASCIIRules</i> set to true. </p>
    <li>
     <p>If <var>result</var> contains any errors, return failure. </p>
    <li>
     <p>Return success. </p>
   </ol>
   <p class="XXX">Ideally we define this in terms of a sequence of code points that make up a <a data-link-type="dfn" href="#valid-domain">valid domain</a> rather than through a whack-a-mole: <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=25334">bug 25334</a>. </p>
   <p>A <dfn data-dfn-for="hostsyntax" data-dfn-type="dfn" data-export="" id="syntax-host-domain">domain<a class="self-link" href="#syntax-host-domain"></a></dfn> must be a string that
is a <a data-link-type="dfn" href="#valid-domain">valid domain</a>. </p>
   <p>An <dfn data-dfn-for="hostsyntax" data-dfn-type="dfn" data-export="" id="syntax-host-ipv4">IPv4 address<a class="self-link" href="#syntax-host-ipv4"></a></dfn> must be four
sequences of up to three <a data-link-type="dfn" href="#ascii-digits">ASCII digits</a> per sequence, each representing a decimal
number no greater than 255, and separated from each other by "<code>.</code>". </p>
   <p>An <dfn data-dfn-for="hostsyntax" data-dfn-type="dfn" data-export="" id="syntax-host-ipv6">IPv6 address<a class="self-link" href="#syntax-host-ipv6"></a></dfn> is defined in the <a href="https://tools.ietf.org/html/rfc4291#section-2.2">"Text Representation of Addresses" chapter of IP Version 6 Addressing Architecture</a>. <a data-link-type="biblio" href="#biblio-rfc4291">[RFC4291]</a> </p>
   <h3 class="heading settled" data-level="3.3" id="host-parsing"><span class="secno">3.3. </span><span class="content">Host parsing</span><a class="self-link" href="#host-parsing"></a></h3>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-host-parser">host parser<a class="self-link" href="#concept-host-parser"></a></dfn> takes a string <var>input</var> and
an optional <var>Unicode flag</var> (unset unless stated otherwise), and then runs these
steps: </p>
   <ol>
    <li>
     <p>If <var>input</var> starts with "<code>[</code>", run these
  substeps: </p>
     <ol>
      <li>
       <p>If <var>input</var> does not end with
   "<code>]</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
      <li>
       <p>Return the result of <a data-link-type="dfn" href="#concept-ipv6-parser">IPv6 parsing</a> <var>input</var> with its leading "<code>[</code>" and trailing
   "<code>]</code>" removed. </p>
     </ol>
    <li>
     <p>Let <var>domain</var> be the result of <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decode-without-bom">UTF-8 decode without BOM</a> on the <a data-link-type="dfn" href="#percent-decode">percent decoding</a> of <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-encode">UTF-8 encode</a> on <var>input</var>. </p>
    <li>
     <p>Let <var>asciiDomain</var> be the result of running <a data-link-type="dfn" href="#concept-domain-to-ascii">domain to ASCII</a> on <var>domain</var>. </p>
    <li>
     <p>If <var>asciiDomain</var> is failure, return failure. </p>
    <li>
     <p>If <var>asciiDomain</var> contains
  U+0000,
  U+0009,
  U+000A,
  U+000D,
  U+0020,
  "<code>#</code>",
  "<code>%</code>",
  "<code>/</code>",
  "<code>:</code>",
  "<code>?</code>",
  "<code>@</code>",
  "<code>[</code>",
  "<code>\</code>",
  or
  "<code>]</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
    <li>
     <p>Let <var>ipv4Host</var> be the result of <a data-link-type="dfn" href="#concept-ipv4-parser">IPv4 parsing</a> <var>asciiDomain</var>. </p>
    <li>
     <p>If <var>ipv4Host</var> is an <a data-link-type="dfn" href="#concept-ipv4">IPv4 address</a> or failure, return <var>ipv4Host</var>. </p>
    <li>
     <p>Return <var>asciiDomain</var> if the <var>Unicode flag</var> is unset, and the
 result of running <a data-link-type="dfn" href="#concept-domain-to-unicode">domain to Unicode</a> on <var>asciiDomain</var> otherwise. </p>
   </ol>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="ipv4-number-parser">IPv4 number parser<a class="self-link" href="#ipv4-number-parser"></a></dfn> takes a string <var>input</var> and a <var>syntaxViolationFlag</var> pointer, and then runs these steps:</p>
   <ol>
    <li>
     <p>Let <var>R</var> be 10. </p>
    <li>
     <p>If <var>input</var> contains at least two code points and the first two code points
  are either "<code>0x</code>" or "<code>0X</code>", run these substeps: </p>
     <ol>
      <li>
       <p>Set <var>syntaxViolationFlag</var>. </p>
      <li>
       <p>Remove the first two code points from <var>input</var>. </p>
      <li>
       <p>Set <var>R</var> to 16. </p>
     </ol>
    <li>
     <p>If <var>input</var> is the empty string, return zero. </p>
    <li>
     <p>Otherwise, if <var>input</var> contains at least two code points and the first code
  point is "<code>0</code>", run these substeps: </p>
     <ol>
      <li>
       <p>Set <var>syntaxViolationFlag</var>. </p>
      <li>
       <p>Remove the first code point from <var>input</var>. </p>
      <li>
       <p>Set <var>R</var> to 8. </p>
     </ol>
    <li>
     <p>If <var>input</var> contains a code point that is not a radix-<var>R</var> digit,
 and return failure. </p>
    <li>
     <p>Return the mathematical integer value that is represented by <var>input</var> in
 radix-<var>R</var> notation, using <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digits</a> for digits with values 0
 through 15. </p>
   </ol>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-ipv4-parser">IPv4 parser<a class="self-link" href="#concept-ipv4-parser"></a></dfn> takes a string <var>input</var> and then
runs these steps:</p>
   <ol>
    <li>
     <p>Let <var>syntaxViolationFlag</var> be unset. </p>
    <li>
     <p>Let <var>parts</var> be <var>input</var> split on "<code>.</code>". </p>
    <li>
     <p>If the last item in <var>parts</var> is the empty string, set <var>syntaxViolationFlag</var> and remove the last item from <var>parts</var>. </p>
    <li>
     <p>If <var>parts</var> has more than four items, return <var>input</var>. </p>
    <li>
     <p>Let <var>numbers</var> be the empty list. </p>
    <li>
     <p>For each <var>part</var> in <var>parts</var>: </p>
     <ol>
      <li>
       <p>If <var>part</var> is the empty string, return <var>input</var>. </p>
       <p class="example no-backref" id="example-c2afe535"><a class="self-link" href="#example-c2afe535"></a><code>0..0x300</code> is a <a data-link-type="dfn" href="#concept-domain">domain</a>, not
    an <a data-link-type="dfn" href="#concept-ipv4">IPv4 address</a>. </p>
      <li>
       <p>Let <var>n</var> be the result of <a data-link-type="dfn" href="#ipv4-number-parser">parsing</a> <var>part</var> using <var>syntaxViolationFlag</var>. </p>
      <li>
       <p>If <var>n</var> is failure, return <var>input</var>. </p>
      <li>
       <p>Append <var>n</var> to <var>numbers</var>. </p>
     </ol>
    <li>
     <p>If <var>syntaxViolationFlag</var> is set, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
    <li>
     <p>If any item in <var>numbers</var> is greater than 255, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
    <li>
     <p>If any but the last item in <var>numbers</var> is greater than 255, return
 failure. </p>
    <li>
     <p>If the last item in <var>numbers</var> is greater than or equal to
 256<sup>(5 − the number of items in <var>numbers</var>)</sup>, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
    <li>
     <p>Let <var>ipv4</var> be the last item in <var>numbers</var>. </p>
    <li>
     <p>Remove the last item from <var>numbers</var>. </p>
    <li>
     <p>Let <var>counter</var> be zero. </p>
    <li>
     <p>For each <var>n</var> in <var>numbers</var>: </p>
     <ol>
      <li>
       <p>Increment <var>ipv4</var> by <var>n</var> ×
   256<sup>(3 − <var>counter</var>)</sup>. </p>
      <li>
       <p>Increment <var>counter</var> by one. </p>
     </ol>
    <li>
     <p>Return <var>ipv4</var>. </p>
   </ol>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-ipv6-parser">IPv6 parser<a class="self-link" href="#concept-ipv6-parser"></a></dfn> takes a string <var>input</var> and
then runs these steps: </p>
   <ol>
    <li>
     <p>Let <var>address</var> be a new <a data-link-type="dfn" href="#concept-ipv6">IPv6 address</a> with its <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit pieces</a> initialized to 0. </p>
    <li>
     <p>Let <var>piece pointer</var> be a pointer into <var>address</var>’s <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit pieces</a>, initially zero
 (pointing to the first <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit piece</a>),
 and let <var>piece</var> be the <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit piece</a> it points to. </p>
    <li>
     <p>Let <var>compress pointer</var> be another pointer into <var>address</var>’s <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit pieces</a>, initially
 null and pointing to nothing. </p>
    <li>
     <p>Let <var>pointer</var> be a pointer into <var>input</var>, initially zero (pointing to the first code point). </p>
    <li>
     <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>:</code>", run these substeps: </p>
     <ol>
      <li>
       <p>If <a data-link-type="dfn" href="#remaining">remaining</a> does not start with "<code>:</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
      <li>
       <p>Increase <var>pointer</var> by two. </p>
      <li>
       <p>Increase <var>piece pointer</var> by one and then set <var>compress pointer</var> to <var>piece pointer</var>. </p>
     </ol>
    <li>
     <p><dfn data-dfn-type="dfn" data-lt="IPv6 parser Main" data-noexport="" id="concept-ipv6-parser-main">Main<a class="self-link" href="#concept-ipv6-parser-main"></a></dfn>:
  While <a data-link-type="dfn" href="#c">c</a> is not the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, run these
  substeps: </p>
     <ol>
      <li>
       <p>If <var>piece pointer</var> is eight, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
      <li>
       <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>:</code>", run these inner
    substeps: </p>
       <ol>
        <li>
         <p>If <var>compress pointer</var> is non-null, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>,
     return failure. </p>
        <li>Increase <var>pointer</var> and <var>piece pointer</var> by one, set <var>compress pointer</var> to <var>piece pointer</var>,
     and then jump to <a data-link-type="dfn" href="#concept-ipv6-parser-main">Main</a>. 
       </ol>
      <li>
       <p>Let <var>value</var> and <var>length</var> be 0. </p>
      <li>
       <p>While <var>length</var> is less than 4 and <a data-link-type="dfn" href="#c">c</a> is an <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digit</a>, set <var>value</var> to <var>value</var> × 0x10 + <a data-link-type="dfn" href="#c">c</a> interpreted as hexadecimal number,
   and increase <var>pointer</var> and <var>length</var> by one. </p>
      <li>
       <p>Switching on <a data-link-type="dfn" href="#c">c</a>: </p>
       <dl class="switch">
        <dt>"<code>.</code>" 
        <dd>
         <ol>
          <li>
           <p>If <var>length</var> is 0, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
          <li>
           <p>Decrease <var>pointer</var> by <var>length</var>. </p>
          <li>
           <p>Jump to <a data-link-type="dfn" href="#concept-ipv6-parser-ipv4">IPv4</a>. </p>
         </ol>
        <dt>"<code>:</code>" 
        <dd>
         <ol>
          <li>
           <p>Increase <var>pointer</var> by one. </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>,
       return failure. </p>
         </ol>
        <dt>Anything but the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a> 
        <dd>
         <p><a data-link-type="dfn" href="#syntax-violation">Syntax violation</a>, return failure. </p>
       </dl>
      <li>
       <p>Set <var>piece</var> to <var>value</var>. </p>
      <li>
       <p>Increase <var>piece pointer</var> by one. </p>
     </ol>
    <li>
     <p>If <a data-link-type="dfn" href="#c">c</a> is the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, jump to <a data-link-type="dfn" href="#concept-ipv6-parser-finale">Finale</a>. </p>
    <li>
     <p><dfn data-dfn-type="dfn" data-lt="IPv6 parser IPv4" data-noexport="" id="concept-ipv6-parser-ipv4">IPv4<a class="self-link" href="#concept-ipv6-parser-ipv4"></a></dfn>:
 If <var>piece pointer</var> is greater than six, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
    <li>
     <p>Let <var>dots seen</var> be 0. </p>
    <li>
     <p>While <a data-link-type="dfn" href="#c">c</a> is not the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, run
  these substeps: </p>
     <ol>
      <li>
       <p>Let <var>value</var> be null. </p>
      <li>
       <p>If <a data-link-type="dfn" href="#c">c</a> is not an <a data-link-type="dfn" href="#ascii-digits">ASCII digit</a>, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>,
   return failure. </p>
      <li>
       <p>While <a data-link-type="dfn" href="#c">c</a> is an <a data-link-type="dfn" href="#ascii-digits">ASCII digit</a>, run these subsubsteps: </p>
       <ol>
        <li>
         <p>Let <var>number</var> be <a data-link-type="dfn" href="#c">c</a> interpreted as decimal number. </p>
        <li>
         <p>If <var>value</var> is null, set <var>value</var> to <var>number</var>. </p>
         <p>Otherwise, if <var>value</var> is 0, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
         <p>Otherwise, set <var>value</var> to <var>value</var> × 10 + <var>number</var>. </p>
        <li>
         <p>Increase <var>pointer</var> by one. </p>
        <li>
         <p>If <var>value</var> is greater than 255, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>,
     return failure. </p>
       </ol>
      <li>
       <p>If <var>dots seen</var> is less than 3 and <a data-link-type="dfn" href="#c">c</a> is not a "<code>.</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
      <li>
       <p>Set <var>piece</var> to <var>piece</var> × 0x100 + <var>value</var>. </p>
      <li>
       <p>If <var>dots seen</var> is 1 or 3, increase <var>piece pointer</var> by one. </p>
      <li>
       <p>If <a data-link-type="dfn" href="#c">c</a> is not the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, increase <var>pointer</var> by
   one. </p>
      <li>
       <p>If <var>dots seen</var> is 3 and <a data-link-type="dfn" href="#c">c</a> is not
   the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
      <li>
       <p>Increase <var>dots seen</var> by one. </p>
     </ol>
    <li>
     <p><dfn data-dfn-type="dfn" data-lt="IPv6 parser Finale" data-noexport="" id="concept-ipv6-parser-finale">Finale<a class="self-link" href="#concept-ipv6-parser-finale"></a></dfn>:
  If <var>compress pointer</var> is non-null, run these substeps: </p>
     <ol>
      <li>
       <p>Let <var>swaps</var> be <var>piece pointer</var> − <var>compress pointer</var>. </p>
      <li>
       <p>Set <var>piece pointer</var> to seven. </p>
      <li>
       <p>While <var>piece pointer</var> is not zero and <var>swaps</var> is
   greater than zero, swap <var>piece</var> with the <a data-link-type="dfn" href="#concept-ipv6-piece">piece</a> at pointer <var>compress pointer</var> + <var>swaps</var> − 1, and then
   decrease both <var>piece pointer</var> and <var>swaps</var> by one. </p>
     </ol>
    <li>
     <p>Otherwise, if <var>compress pointer</var> is null and <var>piece pointer</var> is
 not eight, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
    <li>
     <p>Return <var>address</var>. </p>
   </ol>
   <p class="note no-backref" role="note">To be clear, <a data-link-type="dfn" href="#concept-ipv6-parser-main">Main</a>, <a data-link-type="dfn" href="#concept-ipv6-parser-ipv4">IPv4</a>, and <a data-link-type="dfn" href="#concept-ipv6-parser-finale">Finale</a> are simple markers.
They serve no purpose other than being a location the algorithm can jump to. </p>
   <h3 class="heading settled" data-level="3.4" id="host-serializing"><span class="secno">3.4. </span><span class="content">Host serializing</span><a class="self-link" href="#host-serializing"></a></h3>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-host-serializer">host serializer<a class="self-link" href="#concept-host-serializer"></a></dfn> takes a <a data-link-type="dfn" href="#concept-host">host</a> <var>host</var> and then runs these steps: </p>
   <ol>
    <li>
     <p>If <var>host</var> is an <a data-link-type="dfn" href="#concept-ipv4">IPv4 address</a>, return the result of
 running the <a data-link-type="dfn" href="#concept-ipv4-serializer">IPv4 serializer</a> on <var>host</var>. </p>
    <li>
     <p>Otherwise, if <var>host</var> is an <a data-link-type="dfn" href="#concept-ipv6">IPv6 address</a>, return
 "<code>[</code>", followed by the result of running the <a data-link-type="dfn" href="#concept-ipv6-serializer">IPv6 serializer</a> on <var>host</var>,
 followed by "<code>]</code>". </p>
    <li>
     <p>Otherwise, <var>host</var> is a <a data-link-type="dfn" href="#concept-domain">domain</a>, return <var>host</var>. </p>
   </ol>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-ipv4-serializer">IPv4 serializer<a class="self-link" href="#concept-ipv4-serializer"></a></dfn> takes an <a data-link-type="dfn" href="#concept-ipv4">IPv4 address</a> <var>address</var> and then runs these steps:</p>
   <ol>
    <li>
     <p>Let <var>output</var> be the empty string. </p>
    <li>
     <p>Let <var>n</var> be the value of <var>address</var>. </p>
    <li>
     <p>Repeat four times: </p>
     <ol>
      <li>
       <p>Prepend <var>n</var> % 256, <a data-link-type="dfn" href="#serialize-an-integer">serialized</a>, to <var>output</var>. </p>
      <li>
       <p>Unless this is the fourth time, prepend "<code>.</code>" to <var>output</var>. </p>
      <li>
       <p>Set <var>n</var> to floor(<var>n</var> / 256). </p>
     </ol>
    <li>
     <p>Return <var>output</var>. </p>
   </ol>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-ipv6-serializer">IPv6 serializer<a class="self-link" href="#concept-ipv6-serializer"></a></dfn> takes an <a data-link-type="dfn" href="#concept-ipv6">IPv6 address</a> <var>address</var> and then runs these steps: </p>
   <ol>
    <li>
     <p>Let <var>output</var> be the empty string. </p>
    <li>
     <p>Let <var>compress pointer</var> be a pointer to the first <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit piece</a> in the first longest
  sequences of <var>address</var>’s <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit pieces</a> that are 0. </p>
     <p class="example" id="example-e2b3492e"><a class="self-link" href="#example-e2b3492e"></a>In <code>0:f:0:0:f:f:0:0</code> it would point to
  the second 0. </p>
    <li>
     <p>If there is no sequence of <var>address</var>’s <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit pieces</a> that are 0 longer than
 one, set <var>compress pointer</var> to null. </p>
    <li>
     <p>For each <var>piece</var> in <var>address</var>’s <a data-link-type="dfn" href="#concept-ipv6-piece">pieces</a>, run these substeps: </p>
     <ol>
      <li>
       <p>If <var>compress pointer</var> points to <var>piece</var>, append "<code>::</code>" to <var>output</var> if <var>piece</var> is <var>address</var>’s first <a data-link-type="dfn" href="#concept-ipv6-piece">piece</a> and append
   "<code>:</code>" otherwise, and then run these substeps again with all
   subsequent <a data-link-type="dfn" href="#concept-ipv6-piece">pieces</a> in <var>address</var>’s <a data-link-type="dfn" href="#concept-ipv6-piece">pieces</a> that are 0 skipped or go the next step in the overall set of steps if
   that leaves no <a data-link-type="dfn" href="#concept-ipv6-piece">pieces</a>. </p>
      <li>
       <p>Append <var>piece</var>, represented as the shortest
   possible lowercase hexadecimal number, to <var>output</var>. </p>
      <li>
       <p>If <var>piece</var> is not <var>address</var>’s last <a data-link-type="dfn" href="#concept-ipv6-piece">piece</a>,
   append "<code>:</code>" to <var>output</var>. </p>
     </ol>
    <li>
     <p>Return <var>output</var>. </p>
   </ol>
   <p class="note" role="note">This algorithm requires the recommendation from
A Recommendation for IPv6 Address Text Representation. <a data-link-type="biblio" href="#biblio-rfc5952">[RFC5952]</a> </p>
   <h3 class="heading settled" data-level="3.5" id="host-equivalence"><span class="secno">3.5. </span><span class="content">Host equivalence</span><a class="self-link" href="#host-equivalence"></a></h3>
   <p>To determine whether a <a data-link-type="dfn" href="#concept-host">host</a> <var>A</var> <dfn data-dfn-for="host" data-dfn-type="dfn" data-export="" id="concept-host-equals">equals<a class="self-link" href="#concept-host-equals"></a></dfn> <var>B</var>, return true if <var>A</var> is <var>B</var>, and false otherwise.</p>
   <p class="XXX">Certificate comparison requires a host equivalence check that ignores the
trailing dot of a domain (if any). However, those hosts have also various other facets
enforced, such as DNS length, that are not enforced here, as URLs do not enforce them. If
anyone has a good suggestion for how to bring these two closer together, or what a good
unified model would be, please file an issue. </p>
   <h2 class="heading settled" data-level="4" id="urls"><span class="secno">4. </span><span class="content">URLs</span><a class="self-link" href="#urls"></a></h2>
   <p>A <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" data-lt="URL|URL record" id="concept-url">URL<a class="self-link" href="#concept-url"></a></dfn> is a universal
identifier. To disambiguate from a <a data-link-type="dfn" href="#syntax-url">URL string</a> it can also be referred to as a <a data-link-type="dfn" href="#concept-url">URL record</a>. </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" id="concept-url-scheme">scheme<a class="self-link" href="#concept-url-scheme"></a></dfn> is an <a data-link-type="dfn" href="#ascii-string">ASCII string</a> that identifies the type of <a data-link-type="dfn" href="#concept-url">URL</a> and can be used to
dispatch a <a data-link-type="dfn" href="#concept-url">URL</a> for further processing after <a data-link-type="dfn" href="#concept-url-parser">parsing</a>.
It is initially the empty string. </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" id="concept-url-username">username<a class="self-link" href="#concept-url-username"></a></dfn> is
an <a data-link-type="dfn" href="#ascii-string">ASCII string</a> identifying a user. It is initially the empty string. </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" id="concept-url-password">password<a class="self-link" href="#concept-url-password"></a></dfn> is
either null or an <a data-link-type="dfn" href="#ascii-string">ASCII string</a> identifying a user’s credentials. It is initially
null. </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" id="concept-url-host">host<a class="self-link" href="#concept-url-host"></a></dfn> is either
null or a <a data-link-type="dfn" href="#concept-host">host</a>. It is initially null. </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" id="concept-url-port">port<a class="self-link" href="#concept-url-port"></a></dfn> is either
null or a 16-bit unsigned integer that identifies a networking port. It is initially null. </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" id="concept-url-path">path<a class="self-link" href="#concept-url-path"></a></dfn> is a list of
zero or more <a data-link-type="dfn" href="#ascii-string">ASCII string</a> holding data, usually identifying a location in
hierarchical form. It is initially the empty list. </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" id="concept-url-query">query<a class="self-link" href="#concept-url-query"></a></dfn> is either
null or an <a data-link-type="dfn" href="#ascii-string">ASCII string</a> holding data. It is initially null. </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" id="concept-url-fragment">fragment<a class="self-link" href="#concept-url-fragment"></a></dfn> is
either null or a string holding data that can be used for further processing on the
resource the <a data-link-type="dfn" href="#concept-url">URL</a>’s other components identify. It is initially null. </p>
   <p class="note no-backref" role="note">This is not an <a data-link-type="dfn" href="#ascii-string">ASCII string</a> on purpose. </p>
   <p id="non-relative-flag">A <a data-link-type="dfn" href="#concept-url">URL</a> also has an associated <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" id="url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag<a class="self-link" href="#url-cannot-be-a-base-url-flag"></a></dfn>. It is initially unset. </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> also has an associated <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" id="concept-url-object">object<a class="self-link" href="#concept-url-object"></a></dfn> that is null, a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/FileAPI/#dfn-Blob">Blob</a></code> object, a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/media-source/#idl-def-MediaSource">MediaSource</a></code> object, or a <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/mediacapture-streams/#idl-def-MediaStream">MediaStream</a></code> object. It is initially null. <a data-link-type="biblio" href="#biblio-fileapi">[FILEAPI]</a> <a data-link-type="biblio" href="#biblio-media-source">[MEDIA-SOURCE]</a> <a data-link-type="biblio" href="#biblio-mediacapture-streams">[MEDIACAPTURE-STREAMS]</a> </p>
   <p class="note no-backref" role="note">At this point this is used primarily to support
"<code>blob</code>" <a data-link-type="dfn" href="#concept-url">URLs</a>, but others can be added going forward, hence
"object". </p>
   <hr>
   <p>A <dfn data-dfn-type="dfn" data-export="" id="special-scheme">special scheme<a class="self-link" href="#special-scheme"></a></dfn> is a <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> listed in the first column of
the following table. A <dfn data-dfn-type="dfn" data-noexport="" id="default-port">default port<a class="self-link" href="#default-port"></a></dfn> is a <a data-link-type="dfn" href="#special-scheme">special scheme</a>’s optional
corresponding <a data-link-type="dfn" href="#concept-url-port">port</a> and is listed in the second column on the same row. </p>
   <table>
    <tbody>
     <tr>
      <th><a data-link-type="dfn" href="#concept-url-scheme">scheme</a> 
      <th><a data-link-type="dfn" href="#concept-url-port">port</a> 
     <tr>
      <td>"<code>ftp</code>"
      <td>21 
     <tr>
      <td>"<code>file</code>"
      <td>
     <tr>
      <td>"<code>gopher</code>"
      <td>70 
     <tr>
      <td>"<code>http</code>"
      <td>80 
     <tr>
      <td>"<code>https</code>"
      <td>443 
     <tr>
      <td>"<code>ws</code>"
      <td>80 
     <tr>
      <td>"<code>wss</code>"
      <td>443 
   </table>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> <dfn data-dfn-type="dfn" data-export="" id="is-special">is special<a class="self-link" href="#is-special"></a></dfn> if its <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is a <a data-link-type="dfn" href="#special-scheme">special scheme</a>. </p>
   <p>A <dfn data-dfn-type="dfn" data-export="" id="local-scheme">local scheme<a class="self-link" href="#local-scheme"></a></dfn> is a <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> that is "<code>about</code>",
"<code>blob</code>", "<code>data</code>", or "<code>filesystem</code>". </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> <dfn data-dfn-type="dfn" data-noexport="" id="is-local">is local<a class="self-link" href="#is-local"></a></dfn> if its <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is a <a data-link-type="dfn" href="#local-scheme">local scheme</a>. </p>
   <p class="note" role="note">This definition is used externally. E.g., by the Fetch Standard and
Referrer Policy. <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> <a data-link-type="biblio" href="#biblio-referrer-policy">[REFERRER-POLICY]</a> </p>
   <p>An <dfn data-dfn-type="dfn" data-export="" id="http-scheme">HTTP(S) scheme<a class="self-link" href="#http-scheme"></a></dfn> is a <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> that is
"<code>http</code>" or "<code>https</code>". </p>
   <p>A <dfn data-dfn-type="dfn" data-export="" id="network-scheme">network scheme<a class="self-link" href="#network-scheme"></a></dfn> is a <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> that is "<code>ftp</code>" or an <span>HTTP(S) scheme</span>. </p>
   <p>A <dfn data-dfn-type="dfn" data-export="" id="fetch-scheme">fetch scheme<a class="self-link" href="#fetch-scheme"></a></dfn> is a <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> that is "<code>about</code>",
"<code>blob</code>", "<code>data</code>", "<code>file</code>", "<code>filesystem</code>", or a <span>network scheme</span>. </p>
   <p class="note no-backref" role="note"><a data-link-type="dfn" href="#http-scheme">HTTP(S) scheme</a>, <a data-link-type="dfn" href="#network-scheme">network scheme</a>, and <span>fetch scheme</span> are used by HTML. <a data-link-type="biblio" href="#biblio-html">[HTML]</a> </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> <dfn data-dfn-type="dfn" data-lt="include credentials" data-noexport="" id="include-credentials">includes credentials<a class="self-link" href="#include-credentials"></a></dfn> if either
its <a data-link-type="dfn" href="#concept-url-username">username</a> is not the empty string or its <a data-link-type="dfn" href="#concept-url-password">password</a> is
non-null. </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> can be designated as <dfn data-dfn-type="dfn" data-noexport="" id="concept-base-url">base URL<a class="self-link" href="#concept-base-url"></a></dfn>. </p>
   <p class="note no-backref" role="note">A <a data-link-type="dfn" href="#concept-base-url">base URL</a> is useful for the <a data-link-type="dfn" href="#concept-url-parser">URL parser</a> when the
input might be a <a data-link-type="dfn" href="#syntax-url-relative">relative URL</a>. </p>
   <hr>
   <p>To <dfn data-dfn-type="dfn" data-local-lt="pop" data-noexport="" id="pop-a-urls-path">pop a <var>url</var>’s path<a class="self-link" href="#pop-a-urls-path"></a></dfn>, if <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is not "<code>file</code>" or <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> does not contain a single string that is a <a data-link-type="dfn" href="#normalized-windows-drive-letter">normalized Windows drive letter</a>, remove <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>’s
last string, if any. </p>
   <h3 class="heading settled" data-level="4.1" id="url-syntax"><span class="secno">4.1. </span><span class="content">URL syntax</span><a class="self-link" href="#url-syntax"></a></h3>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" data-lt="URL|URL string" id="syntax-url">URL<a class="self-link" href="#syntax-url"></a></dfn> must be either
a <a data-link-type="dfn" href="#syntax-url-relative-with-fragment">relative URL with fragment</a> or an <a data-link-type="dfn" href="#syntax-url-absolute-with-fragment">absolute URL with fragment</a>. To
disambiguate from a <a data-link-type="dfn" href="#concept-url">URL record</a> it can also be referred to as a <a data-link-type="dfn" href="#syntax-url">URL string</a>. </p>
   <p>An <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-absolute-with-fragment">absolute URL with fragment<a class="self-link" href="#syntax-url-absolute-with-fragment"></a></dfn> must be an <a data-link-type="dfn" href="#syntax-url-absolute">absolute URL</a>, optionally followed by "<code>#</code>" and a <a data-link-type="dfn" href="#syntax-url-fragment">fragment</a>. </p>
   <p>An <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-absolute">absolute URL<a class="self-link" href="#syntax-url-absolute"></a></dfn> must be one of
the following </p>
   <ul class="brief">
    <li>
     <p>a <a data-link-type="dfn" href="#syntax-url-scheme">scheme</a> that is an <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for a <a data-link-type="dfn" href="#special-scheme">special scheme</a> and not an <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match
 for "<code>file</code>", followed by "<code>:</code>" and a <a data-link-type="dfn" href="#syntax-url-scheme-relative">scheme-relative URL</a> </p>
    <li>
     <p>a <a data-link-type="dfn" href="#syntax-url-scheme">scheme</a> that is <em>not</em> an <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for a <a data-link-type="dfn" href="#special-scheme">special scheme</a>, followed by
 "<code>:</code>" and a <a data-link-type="dfn" href="#syntax-url-relative">relative URL</a> </p>
    <li>
     <p>a <a data-link-type="dfn" href="#syntax-url-scheme">scheme</a> that is an <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for "<code>file</code>", followed by "<code>:</code>" and a <a data-link-type="dfn" href="#syntax-url-file-scheme-relative">scheme-relative file URL</a> </p>
   </ul>
   <p>any optionally followed by "<code>?</code>" and a <a data-link-type="dfn" href="#syntax-url-query">query</a>. </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-scheme">scheme<a class="self-link" href="#syntax-url-scheme"></a></dfn> must be one <a data-link-type="dfn" href="#ascii-alpha">ASCII alpha</a>, followed by zero or more of <a data-link-type="dfn" href="#ascii-alphanumeric">ASCII alphanumeric</a>,
"<code>+</code>", "<code>-</code>", and "<code>.</code>". <a data-link-type="dfn" href="#syntax-url-scheme">Schemes</a> should be registered in the <cite>IANA URI [sic] Schemes</cite> registry. <a data-link-type="biblio" href="#biblio-iana-uri-schemes">[IANA-URI-SCHEMES]</a> <a data-link-type="biblio" href="#biblio-rfc7595">[RFC7595]</a> </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-relative-with-fragment">relative URL with fragment<a class="self-link" href="#syntax-url-relative-with-fragment"></a></dfn> must be a <a data-link-type="dfn" href="#syntax-url-relative">relative URL</a>, optionally followed by "<code>#</code>" and a <a data-link-type="dfn" href="#syntax-url-fragment">fragment</a>. </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-relative">relative URL<a class="self-link" href="#syntax-url-relative"></a></dfn> must be one of
the following, switching on <a data-link-type="dfn" href="#concept-base-url">base URL</a>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>: </p>
   <dl class="switch">
    <dt>Not "<code>file</code>" 
    <dd>
     <p>a <a data-link-type="dfn" href="#syntax-url-scheme-relative">scheme-relative URL</a> </p>
    <dd>
     <p>a <a data-link-type="dfn" href="#syntax-url-path-absolute">path-absolute URL</a> </p>
    <dd>
     <p>a <a data-link-type="dfn" href="#syntax-url-path-relative-scheme-less">path-relative scheme-less URL</a> </p>
    <dt>"<code>file</code>" 
    <dd>
     <p>a <a data-link-type="dfn" href="#syntax-url-file-scheme-relative">scheme-relative file URL</a> </p>
    <dd>
     <p>a <a data-link-type="dfn" href="#syntax-url-path-absolute">path-absolute URL</a> if <a data-link-type="dfn" href="#concept-base-url">base URL</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a> is null </p>
    <dd>
     <p>a <a data-link-type="dfn" href="#syntax-url-file-path-absolute">path-absolute non-Windows-file URL</a> if <a data-link-type="dfn" href="#concept-base-url">base URL</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a> is non-null </p>
    <dd>
     <p>a <a data-link-type="dfn" href="#syntax-url-path-relative-scheme-less">path-relative scheme-less URL</a> </p>
   </dl>
   <p>any optionally followed by "<code>?</code>" and a <a data-link-type="dfn" href="#syntax-url-query">query</a>. </p>
   <p class="note no-backref" role="note">A non-null <a data-link-type="dfn" href="#concept-base-url">base URL</a> is necessary when <a data-link-type="dfn" href="#concept-url-parser">parsing</a> a <a data-link-type="dfn" href="#syntax-url-relative">relative URL</a>. </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-scheme-relative">scheme-relative URL<a class="self-link" href="#syntax-url-scheme-relative"></a></dfn> must be "<code>//</code>", followed by a <a data-link-type="dfn" href="#syntax-host">host</a>, optionally followed
by "<code>:</code>" and a <a data-link-type="dfn" href="#syntax-url-port">port</a>, optionally followed by a <a data-link-type="dfn" href="#syntax-url-path-absolute">path-absolute URL</a>. </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-port">port<a class="self-link" href="#syntax-url-port"></a></dfn> must be zero or more <a data-link-type="dfn" href="#ascii-digits">ASCII digits</a>. </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-file-scheme-relative">scheme-relative file URL<a class="self-link" href="#syntax-url-file-scheme-relative"></a></dfn> must be "<code>//</code>", followed by one of the following </p>
   <ul class="brief">
    <li>
     <p>a <a data-link-type="dfn" href="#syntax-host">host</a>, optionally followed by a <a data-link-type="dfn" href="#syntax-url-file-path-absolute">path-absolute non-Windows-file URL</a> </p>
    <li>
     <p>a <a data-link-type="dfn" href="#syntax-url-path-absolute">path-absolute URL</a>. </p>
   </ul>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-path-absolute">path-absolute URL<a class="self-link" href="#syntax-url-path-absolute"></a></dfn> must be
"<code>/</code>" followed by a <a data-link-type="dfn" href="#syntax-url-path-relative">path-relative URL</a>. </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-file-path-absolute">path-absolute non-Windows-file URL<a class="self-link" href="#syntax-url-file-path-absolute"></a></dfn> must be a <a data-link-type="dfn" href="#syntax-url-path-absolute">path-absolute URL</a> that does not start with "<code>/</code>", followed by
a <a data-link-type="dfn" href="#windows-drive-letter">Windows drive letter</a>, followed by "<code>/</code>". </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-path-relative">path-relative URL<a class="self-link" href="#syntax-url-path-relative"></a></dfn> must be
zero or more <a data-link-type="dfn" href="#syntax-url-path-segment">path segments</a>, separated from each other by "<code>/</code>", and not
start with "<code>/</code>". </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-path-relative-scheme-less">path-relative scheme-less URL<a class="self-link" href="#syntax-url-path-relative-scheme-less"></a></dfn> must be a <a data-link-type="dfn" href="#syntax-url-path-relative">path-relative URL</a> that does not start with a <a data-link-type="dfn" href="#syntax-url-scheme">scheme</a> and "<code>:</code>". </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-path-segment">path segment<a class="self-link" href="#syntax-url-path-segment"></a></dfn> must be one
of the following </p>
   <ul class="brief">
    <li>
     <p>zero or more <a data-link-type="dfn" href="#url-units">URL units</a>, excluding "<code>/</code>" and "<code>?</code>",
 that together are not a <a data-link-type="dfn" href="#syntax-url-path-segment-dot">single-dot path segment</a> or a <a data-link-type="dfn" href="#syntax-url-path-segment-dotdot">double-dot path segment</a>. </p>
    <li>
     <p>a <a data-link-type="dfn" href="#syntax-url-path-segment-dot">single-dot path segment</a> </p>
    <li>
     <p>a <a data-link-type="dfn" href="#syntax-url-path-segment-dotdot">double-dot path segment</a>. </p>
   </ul>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-path-segment-dot">single-dot path segment<a class="self-link" href="#syntax-url-path-segment-dot"></a></dfn> must be "<code>.</code>" or an <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for
"<code>%2e</code>". </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-path-segment-dotdot">double-dot path segment<a class="self-link" href="#syntax-url-path-segment-dotdot"></a></dfn> must be "<code>..</code>" or an <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for
"<code>.%2e</code>", "<code>%2e.</code>", or "<code>%2e%2e</code>". </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-query">query<a class="self-link" href="#syntax-url-query"></a></dfn> must be zero or more <a data-link-type="dfn" href="#url-units">URL units</a>. </p>
   <p>A <dfn data-dfn-for="urlsyntax" data-dfn-type="dfn" data-export="" id="syntax-url-fragment">fragment<a class="self-link" href="#syntax-url-fragment"></a></dfn> must be zero or more <a data-link-type="dfn" href="#url-units">URL units</a>. </p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="url-code-points">URL code points<a class="self-link" href="#url-code-points"></a></dfn> are <a data-link-type="dfn" href="#ascii-alphanumeric">ASCII alphanumeric</a>,
"<code>!</code>",
"<code>$</code>",
"<code>&amp;</code>",
"<code>'</code>",
"<code>(</code>",
"<code>)</code>",
"<code>*</code>",
"<code>+</code>",
"<code>,</code>",
"<code>-</code>",
"<code>.</code>",
"<code>/</code>",
"<code>:</code>",
"<code>;</code>",
"<code>=</code>",
"<code>?</code>",
"<code>@</code>",
"<code>_</code>",
"<code>~</code>",
and code points in the ranges
U+00A0 to U+D7FF,
U+E000 to 
U+FDCF,
U+FDF0 to U+FFFD,
U+10000 to U+1FFFD,
U+20000 to U+2FFFD,
U+30000 to U+3FFFD,
U+40000 to U+4FFFD,
U+50000 to U+5FFFD,
U+60000 to U+6FFFD,
U+70000 to U+7FFFD,
U+80000 to U+8FFFD,
U+90000 to U+9FFFD,
U+A0000 to U+AFFFD,
U+B0000 to U+BFFFD,
U+C0000 to U+CFFFD,
U+D0000 to U+DFFFD,
U+E0000 to U+EFFFD,
U+F0000 to U+FFFFD,
U+100000 to U+10FFFD. </p>
   <p class="note" role="note">Code points higher than U+009F will be converted to <a data-link-type="dfn" href="#percent-encoded-byte">percent-encoded bytes</a> by the <a data-link-type="dfn" href="#concept-url-parser">URL parser</a>, except for code points appearing in <a data-link-type="dfn" href="#concept-url-fragment">fragments</a>. </p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="url-units">URL units<a class="self-link" href="#url-units"></a></dfn> are <a data-link-type="dfn" href="#url-code-points">URL code points</a> and <a data-link-type="dfn" href="#percent-encoded-byte">percent-encoded bytes</a>. </p>
   <p class="note" role="note"><a data-link-type="dfn" href="#percent-encoded-byte">Percent-encoded bytes</a> can be used to encode code points that are not <a data-link-type="dfn" href="#url-code-points">URL code points</a> or are excluded from a syntax production. </p>
   <hr>
   <p class="note no-backref" role="note">There is no conforming way to express a <a data-link-type="dfn" href="#concept-url-username">username</a> or <a data-link-type="dfn" href="#concept-url-password">password</a> of a <a data-link-type="dfn" href="#concept-url">URL record</a> within a <a data-link-type="dfn" href="#syntax-url">URL string</a>. </p>
   <h3 class="heading settled" data-level="4.2" id="url-parsing"><span class="secno">4.2. </span><span class="content">URL parsing</span><a class="self-link" href="#url-parsing"></a></h3>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-url-parser">URL parser<a class="self-link" href="#concept-url-parser"></a></dfn> takes a string <var>input</var>, with an optional <a data-link-type="dfn" href="#concept-base-url">base URL</a> <var>base</var> and an optional <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encoding">encoding</a> <var>encoding override</var>, and then runs these steps: </p>
   <p class="note no-backref" role="note">Non-web-browser implementations only need to implement the <a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parser</a>. </p>
   <ol>
    <li>
     <p>Let <var>url</var> be the result of running the <a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parser</a> on <var>input</var> with <var>base</var>, and <var>encoding override</var> as provided. </p>
    <li>
     <p>If <var>url</var> is failure, return failure. </p>
    <li>
     <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is not
 "<code>blob</code>", return <var>url</var>. </p>
    <li>
     <p>If the first string in <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> is not in the <a data-link-type="dfn" href="https://w3c.github.io/FileAPI/#BlobURLStore">blob URL store</a>, return <var>url</var>. <a data-link-type="biblio" href="#biblio-fileapi">[FILEAPI]</a> </p>
    <li>
     <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-object">object</a> to a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#structured-clone">StructuredClone</a> of the
 entry in the <a data-link-type="dfn" href="https://w3c.github.io/FileAPI/#BlobURLStore">blob URL store</a> corresponding to the first string in <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>. <a data-link-type="biblio" href="#biblio-html">[HTML]</a> </p>
    <li>
     <p>Return <var>url</var>. </p>
   </ol>
   <hr>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-basic-url-parser">basic URL parser<a class="self-link" href="#concept-basic-url-parser"></a></dfn> takes a string <var>input</var>, optionally with a <a data-link-type="dfn" href="#concept-base-url">base URL</a> <var>base</var>,
optionally with an <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encoding">encoding</a> <var>encoding override</var>, optionally with an <a data-link-type="dfn" href="#concept-url">URL</a> <var>url</var> and a state override <var>state override</var>, and then runs these steps: </p>
   <div class="note no-backref" role="note">
    <p>The <var>encoding override</var> argument is a legacy concept only relevant for
 HTML. The <var>url</var> and <var>state override</var> arguments are only for use by various APIs. <a data-link-type="biblio" href="#biblio-html">[HTML]</a> </p>
    <p>When the <var>url</var> and <var>state override</var> arguments are not passed, the <a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parser</a> returns either a new <a data-link-type="dfn" href="#concept-url">URL</a> or failure. If they are
 passed, the algorithm simply modifies the passed <var>url</var> and can terminate without
 returning anything. </p>
   </div>
   <ol>
    <li>
     <p>If <var>url</var> is not given: </p>
     <ol>
      <li>
       <p>Set <var>url</var> to a new <a data-link-type="dfn" href="#concept-url">URL</a>. </p>
      <li>
       <p>If <var>input</var> contains any leading or trailing <a data-link-type="dfn" href="#c0-controls-and-space">C0 controls and space</a>, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
      <li>
       <p>Remove any leading and trailing <a data-link-type="dfn" href="#c0-controls-and-space">C0 controls and space</a> from <var>input</var>. </p>
     </ol>
    <li>
     <p>If <var>input</var> contains any <a data-link-type="dfn" href="#tab-and-newline">tab and newline</a>, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
    <li>
     <p>Remove all <a data-link-type="dfn" href="#tab-and-newline">tab and newline</a> from <var>input</var>. </p>
    <li>
     <p>Let <var>state</var> be <var>state override</var> if given, or <a data-link-type="dfn" href="#scheme-start-state">scheme start state</a> otherwise. </p>
    <li>
     <p>If <var>base</var> is not given, set it to null. </p>
    <li>
     <p>Let <var>encoding</var> be <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">UTF-8</a>. </p>
    <li>
     <p>If <var>encoding override</var> is given, set <var>encoding</var> to the result of <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#get-an-output-encoding">getting an output encoding</a> from <var>encoding override</var>. </p>
    <li>
     <p>Let <var>buffer</var> be the empty string. </p>
    <li>
     <p>Let the <var>@ flag</var> and the <var>[] flag</var> be
 unset. </p>
    <li>
     <p>Let <var>pointer</var> be a pointer to first code point in <var>input</var>. </p>
    <li>
     <p>Keep running the following state machine by switching on <var>state</var>. If after a run <var>pointer</var> points to <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, go to the next step. Otherwise, increase <var>pointer</var> by one and continue with the state machine. </p>
     <dl class="switch">
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="scheme-start-state">scheme start state<a class="self-link" href="#scheme-start-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is an <a data-link-type="dfn" href="#ascii-alpha">ASCII alpha</a>,
     append <a data-link-type="dfn" href="#c">c</a>, <a data-link-type="dfn" href="#ascii-lowercase">lowercased</a>, to <var>buffer</var>, and
     set <var>state</var> to <a data-link-type="dfn" href="#scheme-state">scheme state</a>. </p>
        <li>
         <p>Otherwise, if <var>state override</var> is not given, set <var>state</var> to <a data-link-type="dfn" href="#no-scheme-state">no scheme state</a>, and decrease <var>pointer</var> by one. </p>
        <li>
         <p>Otherwise, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, terminate this algorithm. </p>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="scheme-state">scheme state<a class="self-link" href="#scheme-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is an <a data-link-type="dfn" href="#ascii-alphanumeric">ASCII alphanumeric</a>, "<code>+</code>",
     "<code>-</code>", or "<code>.</code>", append <a data-link-type="dfn" href="#c">c</a>, <a data-link-type="dfn" href="#ascii-lowercase">lowercased</a>, to <var>buffer</var>. </p>
        <li>
         <p>Otherwise, if <a data-link-type="dfn" href="#c">c</a> is "<code>:</code>", run these substeps: </p>
         <ol>
          <li>
           <p>If <var>state override</var> is given, run these subsubsteps: </p>
           <ol>
            <li>
             <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is a <a data-link-type="dfn" href="#special-scheme">special scheme</a> and <var>buffer</var> is not, terminate this algorithm. </p>
            <li>
             <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is not a <a data-link-type="dfn" href="#special-scheme">special scheme</a> and <var>buffer</var> is, terminate this algorithm. </p>
           </ol>
          <li>
           <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> to <var>buffer</var>. </p>
          <li>
           <p>Set <var>buffer</var> to the empty string. </p>
          <li>
           <p>If <var>state override</var> is given, terminate this algorithm. </p>
          <li>
           <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is "<code>file</code>", run these
        subsubsteps: </p>
           <ol>
            <li>
             <p>If <a data-link-type="dfn" href="#remaining">remaining</a> does not start with "<code>//</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
            <li>
             <p>Set <var>state</var> to <a data-link-type="dfn" href="#file-state">file state</a>. </p>
           </ol>
          <li>
           <p>Otherwise, if <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a>, <var>base</var> is non-null, and <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is equal to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>,
        set <var>state</var> to <a data-link-type="dfn" href="#special-relative-or-authority-state">special relative or authority state</a>. </p>
           <p class="note no-backref" role="note">This means that <var>base</var>’s <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a> is unset. </p>
          <li>
           <p>Otherwise, if <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a>, set <var>state</var> to <a data-link-type="dfn" href="#special-authority-slashes-state">special authority slashes state</a>. </p>
          <li>
           <p>Otherwise, if <a data-link-type="dfn" href="#remaining">remaining</a> starts with an "<code>/</code>", set <var>state</var> to <a data-link-type="dfn" href="#path-or-authority-state">path or authority state</a>, and increase <var>pointer</var> by one. </p>
          <li>
           <p>Otherwise, set <var>url</var>’s <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a>, append an empty
       string to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, and set <var>state</var> to <a data-link-type="dfn" href="#cannot-be-a-base-url-path-state">cannot-be-a-base-URL path state</a>. </p>
         </ol>
        <li>
         <p>Otherwise, if <var>state override</var> is not given, set <var>buffer</var> to the empty string, <var>state</var> to <a data-link-type="dfn" href="#no-scheme-state">no scheme state</a>, and start over (from the first code point
     in <var>input</var>). </p>
        <li>
         <p>Otherwise, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, terminate this algorithm. </p>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="no-scheme-state">no scheme state<a class="self-link" href="#no-scheme-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If <var>base</var> is null, or <var>base</var>’s <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a> is
     set and <a data-link-type="dfn" href="#c">c</a> is not "<code>#</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
        <li>
         <p>Otherwise, if <var>base</var>’s <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a> is set and <a data-link-type="dfn" href="#c">c</a> is "<code>#</code>", set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty string, set <var>url</var>’s <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a>, and set <var>state</var> to <a data-link-type="dfn" href="#fragment-state">fragment state</a>. </p>
        <li>
         <p>Otherwise, if <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is not
     "<code>file</code>", set <var>state</var> to <a data-link-type="dfn" href="#relative-state">relative state</a> and decrease <var>pointer</var> by one. </p>
        <li>
         <p>Otherwise, set <var>state</var> to <a data-link-type="dfn" href="#file-state">file state</a> and decrease <var>pointer</var> by one. </p>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="special-relative-or-authority-state">special relative or authority state<a class="self-link" href="#special-relative-or-authority-state"></a></dfn> 
      <dd>
       <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>/</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> starts with "<code>/</code>", set <var>state</var> to <a data-link-type="dfn" href="#special-authority-ignore-slashes-state">special authority ignore slashes state</a> and increase <var>pointer</var> by one. </p>
       <p>Otherwise, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, set <var>state</var> to <a data-link-type="dfn" href="#relative-state">relative state</a> and decrease <var>pointer</var> by one. </p>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="path-or-authority-state">path or authority state<a class="self-link" href="#path-or-authority-state"></a></dfn> 
      <dd>
       <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>/</code>", set <var>state</var> to <a data-link-type="dfn" href="#authority-state">authority state</a>. </p>
       <p>Otherwise, set <var>state</var> to <a data-link-type="dfn" href="#path-state">path state</a>, and decrease <var>pointer</var> by one. </p>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="relative-state">relative state<a class="self-link" href="#relative-state"></a></dfn> 
      <dd>
       <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>, and then, switching on <a data-link-type="dfn" href="#c">c</a>: </p>
       <dl class="switch">
        <dt><a data-link-type="dfn" href="#eof-code-point">EOF code point</a> 
        <dd>
         <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, and <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>. </p>
        <dt>"<code>/</code>" 
        <dd>
         <p>Set <var>state</var> to <a data-link-type="dfn" href="#relative-slash-state">relative slash state</a>. </p>
        <dt>"<code>?</code>" 
        <dd>
         <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to the empty string,
     and <var>state</var> to <a data-link-type="dfn" href="#query-state">query state</a>. </p>
        <dt>"<code>#</code>" 
        <dd>
         <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty string,
     and <var>state</var> to <a data-link-type="dfn" href="#fragment-state">fragment state</a>. </p>
        <dt>Otherwise 
        <dd>
         <p>If <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, set <var>state</var> to <a data-link-type="dfn" href="#relative-slash-state">relative slash state</a>. </p>
         <p>Otherwise, run these steps: </p>
         <ol>
          <li>
           <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, and then remove <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>’s last entry, if any. </p>
          <li>
           <p>Set <var>state</var> to <a data-link-type="dfn" href="#path-state">path state</a>,
       and decrease <var>pointer</var> by one. </p>
         </ol>
       </dl>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="relative-slash-state">relative slash state<a class="self-link" href="#relative-slash-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If either <a data-link-type="dfn" href="#c">c</a> is "<code>/</code>", or <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", run these substeps: </p>
         <ol>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>Set <var>state</var> to <a data-link-type="dfn" href="#special-authority-ignore-slashes-state">special authority ignore slashes state</a>. </p>
         </ol>
        <li>
         <p>Otherwise, set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a>, <var>state</var> to <a data-link-type="dfn" href="#path-state">path state</a>, and then, decrease <var>pointer</var> by one. </p>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="special-authority-slashes-state">special authority slashes state<a class="self-link" href="#special-authority-slashes-state"></a></dfn> 
      <dd>
       <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>/</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> starts with "<code>/</code>",
    set <var>state</var> to <a data-link-type="dfn" href="#special-authority-ignore-slashes-state">special authority ignore slashes state</a>, and increase <var>pointer</var> by one. </p>
       <p>Otherwise, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, set <var>state</var> to <a data-link-type="dfn" href="#special-authority-ignore-slashes-state">special authority ignore slashes state</a>, and decrease <var>pointer</var> by one. </p>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="special-authority-ignore-slashes-state">special authority ignore slashes state<a class="self-link" href="#special-authority-ignore-slashes-state"></a></dfn> 
      <dd>
       <p>If <a data-link-type="dfn" href="#c">c</a> is neither "<code>/</code>" nor "<code>\</code>", set <var>state</var> to <a data-link-type="dfn" href="#authority-state">authority state</a>, and decrease <var>pointer</var> by one. </p>
       <p>Otherwise, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="authority-state">authority state<a class="self-link" href="#authority-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>@</code>", run these substeps: </p>
         <ol>
          <li>
           <p><a data-link-type="dfn" href="#syntax-violation">Syntax violation</a>. </p>
          <li>
           <p>If the <var>@ flag</var> is set, prepend "<code>%40</code>" to <var>buffer</var>. </p>
          <li>
           <p>Set the <var>@ flag</var>. </p>
          <li>
           <p>For each <var>codePoint</var> in <var>buffer</var>, run these substeps: </p>
           <ol>
            <li>
             <p>If <var>codePoint</var> is "<code>:</code>" and <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> is null, set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to the empty string and run these substeps for the next code point. </p>
            <li>
             <p>Let <var>encodedCodePoints</var> be the result of running <a data-link-type="dfn" href="#utf-8-percent-encode">UTF-8 percent encode</a> <var>codePoint</var> using the <a data-link-type="dfn" href="#userinfo-encode-set">userinfo encode set</a>. </p>
            <li>
             <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> is non-null, append <var>encodedCodePoints</var> to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>. </p>
            <li>
             <p>Otherwise, append <var>encodedCodePoints</var> to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a>. </p>
           </ol>
          <li>
           <p>Set <var>buffer</var> to the empty string. </p>
         </ol>
        <li>
         <p>Otherwise, if one of the following is true </p>
         <ul class="brief">
          <li>
           <p><a data-link-type="dfn" href="#c">c</a> is <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, "<code>/</code>", "<code>?</code>", or
       "<code>#</code>" </p>
          <li>
           <p><var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>" </p>
         </ul>
         <p>then decrease <var>pointer</var> by the number of code points in <var>buffer</var> plus
      one, set <var>buffer</var> to the empty string, and set <var>state</var> to <a data-link-type="dfn" href="#host-state">host state</a>. </p>
        <li>
         <p>Otherwise, append <a data-link-type="dfn" href="#c">c</a> to <var>buffer</var>. </p>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="host-state">host state<a class="self-link" href="#host-state"></a></dfn> 
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="hostname-state">hostname state<a class="self-link" href="#hostname-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>:</code>" and the <var>[] flag</var> is unset, run these substeps: </p>
         <ol>
          <li>
           <p>If <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <var>buffer</var> is the empty
       string, return failure. </p>
          <li>
           <p>Let <var>host</var> be the result of <a data-link-type="dfn" href="#concept-host-parser">host parsing</a> <var>buffer</var>. </p>
          <li>
           <p>If <var>host</var> is failure, return failure. </p>
          <li>
           <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to <var>host</var>, <var>buffer</var> to the empty string,
       and <var>state</var> to <a data-link-type="dfn" href="#port-state">port state</a>. </p>
          <li>
           <p>If <var>state override</var> is <a data-link-type="dfn" href="#hostname-state">hostname state</a>,
       terminate this algorithm. </p>
         </ol>
        <li>
         <p>Otherwise, if one of the following is true </p>
         <ul class="brief">
          <li>
           <p><a data-link-type="dfn" href="#c">c</a> is <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, "<code>/</code>", "<code>?</code>", or
       "<code>#</code>" </p>
          <li>
           <p><var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>" </p>
         </ul>
         <p>then decrease <var>pointer</var> by one, and run these substeps: </p>
         <ol>
          <li>
           <p>If <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <var>buffer</var> is the empty
       string, return failure. </p>
          <li>
           <p>Let <var>host</var> be the result of <a data-link-type="dfn" href="#concept-host-parser">host parsing</a> <var>buffer</var>. </p>
          <li>
           <p>If <var>host</var> is failure, return failure. </p>
          <li>
           <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to <var>host</var>, <var>buffer</var> to the empty string,
       and <var>state</var> to <a data-link-type="dfn" href="#path-start-state">path start state</a>. </p>
          <li>
           <p>If <var>state override</var> is given, terminate this
       algorithm. </p>
         </ol>
        <li>
         <p>Otherwise, run these substeps: </p>
         <ol>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>[</code>", set the <var>[] flag</var>. </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>]</code>", unset the <var>[] flag</var>. </p>
          <li>
           <p>Append <a data-link-type="dfn" href="#c">c</a> to <var>buffer</var>. </p>
         </ol>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="port-state">port state<a class="self-link" href="#port-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is an <a data-link-type="dfn" href="#ascii-digits">ASCII digit</a>, append <a data-link-type="dfn" href="#c">c</a> to <var>buffer</var>. </p>
        <li>
         <p>Otherwise, if one of the following is true </p>
         <ul class="brief">
          <li>
           <p><a data-link-type="dfn" href="#c">c</a> is <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, "<code>/</code>", "<code>?</code>", or
       "<code>#</code>" </p>
          <li>
           <p><var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>" </p>
          <li>
           <p><var>state override</var> is given </p>
         </ul>
         <p>run these substeps: </p>
         <ol>
          <li>
           <p>If <var>buffer</var> is not the empty string, run these subsubsteps: </p>
           <ol>
            <li>
             <p>Let <var>port</var> be the mathematical integer value that is represented
         by <var>buffer</var> in radix-10 using <a data-link-type="dfn" href="#ascii-digits">ASCII digits</a> for digits with values
         0 through 9. </p>
            <li>
             <p>If <var>port</var> is greater than 2<sup>16</sup> − 1, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
            <li>
             <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> to null, if <var>port</var> is <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>’s <a data-link-type="dfn" href="#default-port">default port</a>, and to <var>port</var> otherwise. </p>
            <li>
             <p>Set <var>buffer</var> to the empty string. </p>
           </ol>
          <li>
           <p>If <var>state override</var> is given, terminate this algorithm. </p>
          <li>
           <p>Set <var>state</var> to <a data-link-type="dfn" href="#path-start-state">path start state</a>, and decrease <var>pointer</var> by one. </p>
         </ol>
        <li>
         <p>Otherwise, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>, return failure. </p>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="file-state">file state<a class="self-link" href="#file-state"></a></dfn> 
      <dd>
       <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> to "<code>file</code>",
    and then, switching on <a data-link-type="dfn" href="#c">c</a>: </p>
       <dl class="switch">
        <dt><a data-link-type="dfn" href="#eof-code-point">EOF code point</a> 
        <dd>
         <p>If <var>base</var> is non-null and <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is "<code>file</code>", set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, and <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>. </p>
        <dt>"<code>/</code>" 
        <dt>"<code>\</code>" 
        <dd>
         <ol>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>Set <var>state</var> to <a data-link-type="dfn" href="#file-slash-state">file slash state</a>. </p>
         </ol>
        <dt>"<code>?</code>" 
        <dd>
         <p>If <var>base</var> is non-null and <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is "<code>file</code>", set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to the empty string,
     and <var>state</var> to <a data-link-type="dfn" href="#query-state">query state</a>. </p>
        <dt>"<code>#</code>" 
        <dd>
         <p>If <var>base</var> is non-null and <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is "<code>file</code>", set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty string,
     and <var>state</var> to <a data-link-type="dfn" href="#fragment-state">fragment state</a>. </p>
        <dt>Otherwise 
        <dd>
         <ol>
          <li>
           <p>If <var>base</var> is non-null, <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is "<code>file</code>", and at least one of the following is true </p>
           <ul class="brief">
            <li>
             <p><a data-link-type="dfn" href="#c">c</a> and the first code point of <a data-link-type="dfn" href="#remaining">remaining</a> are not a <a data-link-type="dfn" href="#windows-drive-letter">Windows drive letter</a> </p>
            <li>
             <p><a data-link-type="dfn" href="#remaining">remaining</a> consists of one code point </p>
            <li><a data-link-type="dfn" href="#remaining">remaining</a>’s second code point is <em>not</em> "<code>/</code>",
         "<code>\</code>", "<code>?</code>", or "<code>#</code>" 
           </ul>
           <p>then set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, and then <a data-link-type="dfn" href="#pop-a-urls-path">pop</a> <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>. </p>
           <p class="note" role="note">This is a (platform-independent) Windows drive letter quirk. </p>
          <li>
           <p>Otherwise, if <var>base</var> is non-null and <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is "<code>file</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>Set <var>state</var> to <a data-link-type="dfn" href="#path-state">path state</a>, and decrease <var>pointer</var> by one. </p>
         </ol>
       </dl>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="file-slash-state">file slash state<a class="self-link" href="#file-slash-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>/</code>" or "<code>\</code>", run these substeps: </p>
         <ol>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>Set <var>state</var> to <a data-link-type="dfn" href="#file-host-state">file host state</a>. </p>
         </ol>
        <li>
         <p>Otherwise, run these substeps: </p>
         <ol>
          <li>
           <p>If <var>base</var> is non-null, <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is "<code>file</code>", and <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> first string is a <a data-link-type="dfn" href="#normalized-windows-drive-letter">normalized Windows drive letter</a>,
        append <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> first string to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>. </p>
           <p class="note" role="note">This is a (platform-independent) Windows drive letter quirk. Both <var>url</var>’s and <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> are null under
        these conditions and therefore not copied. </p>
          <li>
           <p>Set <var>state</var> to <a data-link-type="dfn" href="#path-state">path state</a>, and decrease <var>pointer</var> by one. </p>
         </ol>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="file-host-state">file host state<a class="self-link" href="#file-host-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, "<code>/</code>", "<code>\</code>", "<code>?</code>",
      or "<code>#</code>", decrease <var>pointer</var> by one, and run these substeps: </p>
         <ol>
          <li>
           <p>If <var>buffer</var> is a <a data-link-type="dfn" href="#windows-drive-letter">Windows drive letter</a>, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>,
        set <var>state</var> to <a data-link-type="dfn" href="#path-state">path state</a>. </p>
           <p class="note" role="note">This is a (platform-independent) Windows drive letter quirk. <var>buffer</var> is not reset here and instead used in the <a data-link-type="dfn" href="#path-state">path state</a>. </p>
          <li>
           <p>Otherwise, if <var>buffer</var> is the empty string, set <var>state</var> to <a data-link-type="dfn" href="#path-start-state">path start state</a>. </p>
          <li>
           <p>Otherwise, run these steps: </p>
           <ol>
            <li>
             <p>Let <var>host</var> be the result of <a data-link-type="dfn" href="#concept-host-parser">host parsing</a> <var>buffer</var>. </p>
            <li>
             <p>If <var>host</var> is failure, return failure. </p>
            <li>
             <p>If <var>host</var> is not "<code title="">localhost</code>", set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to <var>host</var>. </p>
            <li>
             <p>Set <var>buffer</var> to the empty string and <var>state</var> to <a data-link-type="dfn" href="#path-start-state">path start state</a>. </p>
           </ol>
         </ol>
        <li>
         <p>Otherwise, append <a data-link-type="dfn" href="#c">c</a> to <var>buffer</var>. </p>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="path-start-state">path start state<a class="self-link" href="#path-start-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
        <li>
         <p>Set <var>state</var> to <a data-link-type="dfn" href="#path-state">path state</a>, and if neither <a data-link-type="dfn" href="#c">c</a> is
     "<code>/</code>", nor <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is
     "<code>\</code>", decrease <var>pointer</var> by one. </p>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="path-state">path state<a class="self-link" href="#path-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If one of the following is true </p>
         <ul class="brief">
          <li>
           <p><a data-link-type="dfn" href="#c">c</a> is <a data-link-type="dfn" href="#eof-code-point">EOF code point</a> or "<code>/</code>" </p>
          <li>
           <p><var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>" </p>
          <li>
           <p><var>state override</var> is not given and <a data-link-type="dfn" href="#c">c</a> is "<code>?</code>" or
       "<code>#</code>" </p>
         </ul>
         <p>then run these substeps: </p>
         <ol>
          <li>
           <p>If <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>If <var>buffer</var> is a <a data-link-type="dfn" href="#syntax-url-path-segment-dotdot">double-dot path segment</a>, <a data-link-type="dfn" href="#pop-a-urls-path">pop</a> <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, and then if neither <a data-link-type="dfn" href="#c">c</a> is
       "<code>/</code>", nor <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is
       "<code>\</code>", append the empty string to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>. </p>
          <li>
           <p>Otherwise, if <var>buffer</var> is a <a data-link-type="dfn" href="#syntax-url-path-segment-dot">single-dot path segment</a> and if
       neither <a data-link-type="dfn" href="#c">c</a> is "<code>/</code>", nor <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", append the empty string to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>. </p>
          <li>
           <p>Otherwise, if <var>buffer</var> is not a <a data-link-type="dfn" href="#syntax-url-path-segment-dot">single-dot path segment</a>, run
        these subsubsteps: </p>
           <ol>
            <li>
             <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is
          "<code>file</code>", <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> is empty, and <var>buffer</var> is a <a data-link-type="dfn" href="#windows-drive-letter">Windows drive letter</a>, run these
          subsubsubsteps: </p>
             <ol>
              <li>
               <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> is non-null, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
              <li>
               <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to null and replace the second
           code point in <var>buffer</var> with "<code>:</code>". </p>
             </ol>
             <p class="note" role="note">This is a (platform-independent) Windows drive letter quirk. </p>
            <li>
             <p>Append <var>buffer</var> to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>. </p>
           </ol>
          <li>
           <p>Set <var>buffer</var> to the empty string. </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>?</code>", set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to the empty string,
       and <var>state</var> to <a data-link-type="dfn" href="#query-state">query state</a>. </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>#</code>", set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty string,
       and <var>state</var> to <a data-link-type="dfn" href="#fragment-state">fragment state</a>. </p>
         </ol>
        <li>
         <p>Otherwise, run these steps: </p>
         <ol>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is not a <a data-link-type="dfn" href="#url-code-points">URL code point</a> and not "<code>%</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>%</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> does
       not start with two <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digits</a>, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>%</code>" and <a data-link-type="dfn" href="#remaining">remaining</a>, <a data-link-type="dfn" href="#ascii-lowercase">ASCII lowercased</a> starts
       with "<code>2e</code>", append "<code>.</code>" to <var>buffer</var> and increase <var>pointer</var> by two. </p>
          <li>
           <p>Otherwise, <a data-link-type="dfn" href="#utf-8-percent-encode">UTF-8 percent encode</a> <a data-link-type="dfn" href="#c">c</a> using the <a data-link-type="dfn" href="#default-encode-set">default encode set</a>,
       and append the result to <var>buffer</var>. </p>
         </ol>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="cannot-be-a-base-url-path-state">cannot-be-a-base-URL path state<a class="self-link" href="#cannot-be-a-base-url-path-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>?</code>", set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to the empty string and <var>state</var> to <a data-link-type="dfn" href="#query-state">query state</a>. </p>
        <li>
         <p>Otherwise, if <a data-link-type="dfn" href="#c">c</a> is "<code>#</code>", set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty string and <var>state</var> to <a data-link-type="dfn" href="#fragment-state">fragment state</a>. </p>
        <li>
         <p>Otherwise, run these substeps: </p>
         <ol>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is not <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, not a <a data-link-type="dfn" href="#url-code-points">URL code point</a>, and not "<code>%</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>%</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> does
       not start with two <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digits</a>, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is not <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, <a data-link-type="dfn" href="#utf-8-percent-encode">UTF-8 percent encode</a> <a data-link-type="dfn" href="#c">c</a> using the <a data-link-type="dfn" href="#simple-encode-set">simple encode set</a>, and append the result to the first string in <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>. </p>
         </ol>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="query-state">query state<a class="self-link" href="#query-state"></a></dfn> 
      <dd>
       <ol>
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, or <var>state override</var> is not given and <a data-link-type="dfn" href="#c">c</a> is "<code>#</code>", run these substeps: </p>
         <ol>
          <li>
           <p>If <var>url</var> <a data-link-type="dfn" href="#is-special">is <em>not</em> special</a> or <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is either "<code>ws</code>" or "<code>wss</code>", set <var>encoding</var> to <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">UTF-8</a>. </p>
          <li>
           <p>Set <var>buffer</var> to the result of <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encode">encoding</a> <var>buffer</var> using <var>encoding</var>. </p>
          <li>
           <p>For each <var>byte</var> in <var>buffer</var> run
        these subsubsteps: </p>
           <ol>
            <li>
             <p>If <var>byte</var> is less than 0x21, greater than 0x7E, or is 0x22, 0x23, 0x3C, or
         0x3E, append <var>byte</var>, <a data-link-type="dfn" href="#percent-encode">percent encoded</a>, to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>. </p>
            <li>
             <p>Otherwise, append a code point whose value is <var>byte</var> to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>. </p>
           </ol>
          <li>
           <p>Set <var>buffer</var> to the empty string. </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>#</code>", set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty string,
       and state to <a data-link-type="dfn" href="#fragment-state">fragment state</a>. </p>
         </ol>
        <li>
         <p>Otherwise, run these substeps: </p>
         <ol>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is not a <a data-link-type="dfn" href="#url-code-points">URL code point</a> and not "<code>%</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>%</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> does
       not start with two <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digits</a>, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>Append <a data-link-type="dfn" href="#c">c</a> to <var>buffer</var>. </p>
         </ol>
       </ol>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="fragment-state">fragment state<a class="self-link" href="#fragment-state"></a></dfn> 
      <dd>
       <p>Switching on <a data-link-type="dfn" href="#c">c</a>: </p>
       <dl class="switch">
        <dt><a data-link-type="dfn" href="#eof-code-point">EOF code point</a> 
        <dd>
         <p>Do nothing. </p>
        <dt>U+0000 
        <dd>
         <p><a data-link-type="dfn" href="#syntax-violation">Syntax violation</a>. </p>
        <dt>Otherwise 
        <dd>
         <ol>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is not a <a data-link-type="dfn" href="#url-code-points">URL code point</a> and not
       "<code>%</code>", <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>%</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> does
       not start with two <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digits</a>, <a data-link-type="dfn" href="#syntax-violation">syntax violation</a>. </p>
          <li>
           <p>Append <a data-link-type="dfn" href="#c">c</a> to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a>. </p>
           <p class="note no-backref" role="note">Unfortunately not using <a data-link-type="dfn" href="#percent-encode">percent-encoding</a> is intentional as implementations with
        majority market share exhibit this behavior. </p>
         </ol>
       </dl>
     </dl>
    <li>
     <p>Return <var>url</var>. </p>
   </ol>
   <hr>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="set-the-username">set the username<a class="self-link" href="#set-the-username"></a></dfn> given a <var>url</var> and <var>username</var>, run
these steps: </p>
   <ol>
    <li>
     <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to the empty string. </p>
    <li>
     <p>For each code point in <var>username</var>, <a data-link-type="dfn" href="#utf-8-percent-encode">UTF-8 percent encode</a> it using the <a data-link-type="dfn" href="#userinfo-encode-set">userinfo encode set</a>, and append the
 result to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a>. </p>
   </ol>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="set-the-password">set the password<a class="self-link" href="#set-the-password"></a></dfn> given a <var>url</var> and <var>password</var>, run
these steps: </p>
   <ol>
    <li>
     <p>If <var>password</var> is the empty string, set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to null. </p>
    <li>
     <p>Otherwise, run these substeps: </p>
     <ol>
      <li>
       <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to the empty string. </p>
      <li>
       <p>For each code point in <var>password</var>, <a data-link-type="dfn" href="#utf-8-percent-encode">UTF-8 percent encode</a> it using the <a data-link-type="dfn" href="#userinfo-encode-set">userinfo encode set</a>, and
   append the result to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>. </p>
     </ol>
   </ol>
   <h3 class="heading settled" data-level="4.3" id="url-serializing"><span class="secno">4.3. </span><span class="content">URL serializing</span><a class="self-link" href="#url-serializing"></a></h3>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-url-serializer">URL serializer<a class="self-link" href="#concept-url-serializer"></a></dfn> takes a <a data-link-type="dfn" href="#concept-url">URL</a> <var>url</var>, an optional <i title="">exclude fragment flag</i>, and
then runs these steps: </p>
   <ol>
    <li>
     <p>Let <var>output</var> be <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> and
 "<code>:</code>" concatenated. </p>
    <li>
     <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> is non-null: </p>
     <ol>
      <li>
       <p>Append "<code>//</code>" to <var>output</var>. </p>
      <li>
       <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> is not the empty string
    or <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> is non-null, run these substeps: </p>
       <ol>
        <li>
         <p>Append <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to <var>output</var>. </p>
        <li>
         <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> is non-null, append
     "<code>:</code>", followed by <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>, to <var>output</var>. </p>
        <li>
         <p>Append "<code>@</code>" to <var>output</var>. </p>
       </ol>
      <li>
       <p>Append <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <a data-link-type="dfn" href="#concept-host-serializer">serialized</a>, to <var>output</var>. </p>
      <li>
       <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> is non-null, append "<code>:</code>"
   followed by <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a>, <a data-link-type="dfn" href="#serialize-an-integer">serialized</a>, to <var>output</var>. </p>
     </ol>
    <li>
     <p>Otherwise, if <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> is null and <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is "<code>file</code>", append
 "<code>//</code>" to <var>output</var>. </p>
    <li>
     <p>If <var>url</var>’s <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a> is set, append the first string in <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to <var>output</var>. </p>
    <li>
     <p>Otherwise, append "<code>/</code>", followed by the strings in <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> (including empty strings), separated from each other by
 "<code>/</code>", to <var>output</var>. </p>
    <li>
     <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> is non-null, append
 "<code>?</code>", followed by <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>, to <var>output</var>. </p>
    <li>
     <p>If the <i title="">exclude fragment flag</i> is unset and <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> is non-null, append "<code>#</code>", followed by <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a>, to <var>output</var>. </p>
    <li>
     <p>Return <var>output</var>. </p>
   </ol>
   <h3 class="heading settled" data-level="4.4" id="url-equivalence"><span class="secno">4.4. </span><span class="content">URL equivalence</span><a class="self-link" href="#url-equivalence"></a></h3>
   <p>To determine whether a <a data-link-type="dfn" href="#concept-url">URL</a> <var>A</var> <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" id="concept-url-equals">equals<a class="self-link" href="#concept-url-equals"></a></dfn> <var>B</var>, optionally with an <i>exclude fragments flag</i>, run these steps: </p>
   <ol>
    <li>
     <p>Let <var>serializedA</var> be the result of <a data-link-type="dfn" href="#concept-url-serializer">serializing</a> <var>A</var>, with the <i>exclude fragment flag</i> set if the <i>exclude fragments flag</i> is set. </p>
    <li>
     <p>Let <var>serializedB</var> be the result of <a data-link-type="dfn" href="#concept-url-serializer">serializing</a> <var>B</var>, with the <i>exclude fragment flag</i> set if the <i>exclude fragments flag</i> is set. </p>
    <li>
     <p>Return true if <var>serializedA</var> is <var>serializedB</var>, and false
 otherwise. </p>
   </ol>
   <h3 class="heading settled" data-level="4.5" id="origin"><span class="secno">4.5. </span><span class="content">Origin</span><a class="self-link" href="#origin"></a></h3>
   <p class="note" role="note">See <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>’s definition in HTML for the necessary
background information. <a data-link-type="biblio" href="#biblio-html">[HTML]</a> </p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-for="url" data-dfn-type="dfn" data-export="" id="concept-url-origin">origin<a class="self-link" href="#concept-url-origin"></a></dfn> is the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> returned by running these steps, switching on <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>: </p>
   <dl class="switch">
    <dt>"<code>blob</code>" 
    <dd>
     <p>Let <var>url</var> be the result of <a data-link-type="dfn" href="#concept-basic-url-parser">parsing</a> the first
  string in <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-path">path</a>. </p>
     <p>Return a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque">opaque origin</a>, if <var>url</var> is failure, and <var>url</var>’s <a data-link-type="dfn" href="#concept-url-origin">origin</a> otherwise. </p>
     <p class="example no-backref" id="example-43b5cea5"><a class="self-link" href="#example-43b5cea5"></a>The <a data-link-type="dfn" href="#concept-url-origin">origin</a> of <code>blob:https://whatwg.org/d0360e2f-caee-469f-9a2f-87d5b0456f6f</code> is the tuple
  (<code>https</code>, <code>whatwg.org</code>, <code>443</code>, null). </p>
    <dt>"<code>ftp</code>" 
    <dt>"<code>gopher</code>" 
    <dt>"<code>http</code>" 
    <dt>"<code>https</code>" 
    <dt>"<code>ws</code>" 
    <dt>"<code>wss</code>" 
    <dd>
     <p>Return a tuple consisting of <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>, <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-port">port</a>, and null. </p>
    <dt>"<code>file</code>" 
    <dd>
     <p>Unfortunate as it is, this is left as an exercise to the reader. When in doubt,
 return a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque">opaque origin</a>. </p>
    <dt>Otherwise 
    <dd>
     <p>Return a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque">opaque origin</a>. </p>
     <p class="note no-backref" role="note">This does indeed mean that these <a data-link-type="dfn" href="#concept-url">URLs</a> cannot
  be <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin">same-origin</a> with themselves. </p>
   </dl>
   <h3 class="heading settled" data-level="4.6" id="url-rendering"><span class="secno">4.6. </span><span class="content">URL rendering</span><a class="self-link" href="#url-rendering"></a></h3>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> should be rendered in its <a data-link-type="dfn" href="#concept-url-serializer">serialized</a> form, with these modifications: </p>
   <ul class="brief">
    <li>
     <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-username">username</a> and <a data-link-type="dfn" href="#concept-url-password">password</a> should
 not be rendered as they can be mistaken for a <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a>.
 E.g., consider <code>https://examplecorp.com@attacker.example/</code>. </p>
    <li>
     <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a> should be rendered using <a data-link-type="dfn" href="#concept-domain-to-unicode">domain to Unicode</a>. </p>
    <li>
     <p>Other parts of the <a data-link-type="dfn" href="#syntax-url">URL</a> should have their sequences of <a data-link-type="dfn" href="#percent-encoded-byte">percent-encoded bytes</a> replaced with code points resulting from <a data-link-type="dfn" href="#percent-decode">percent decoding</a> those sequences converted to bytes, unless that renders those
 sequences invisible. </p>
   </ul>
   <p>For the purposes of bidirectional text it should be rendered as if it were in a
left-to-right embedding. <a data-link-type="biblio" href="#biblio-bidi">[BIDI]</a> </p>
   <p class="note no-backref" role="note">Unfortunately, as rendered <a data-link-type="dfn" href="#concept-url">URLs</a> are simply
strings and can appear anywhere, a specific bidirectional algorithm for rendered <a data-link-type="dfn" href="#concept-url">URLs</a> would not see wide adoption. Bidirectional text interacts with the
parts of a <a data-link-type="dfn" href="#concept-url">URL</a> in ways that can cause the rendering to be different from
the model. Users of bidirectional languages are thus cautioned that this is to be
expected, particularly in plain text environments. </p>
   <p>Due to the confusion that can arise between a <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a> and <a data-link-type="dfn" href="#concept-url-path">path</a> with bidirectional text, browsers are encouraged to only render a <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a> in places where it is important for users to
distinguish between the two. E.g., users are expected to make trust decisions based on a <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a> rendered in the address bar. </p>
   <h2 class="heading settled" data-level="5" id="application/x-www-form-urlencoded"><span class="secno">5. </span><span class="content"><code>application/x-www-form-urlencoded</code></span><a class="self-link" href="#application/x-www-form-urlencoded"></a></h2>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-urlencoded"><code>application/x-www-form-urlencoded</code><a class="self-link" href="#concept-urlencoded"></a></dfn> format is a
simple way to encode name-value pairs in a byte sequence where all bytes are <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#ascii-byte">ASCII bytes</a>. </p>
   <p class="note no-backref" role="note">The <code>application/x-www-form-urlencoded</code> format is in many ways
an aberrant monstrosity, the result of many years of implementation accidents and compromises
leading to a set of requirements necessary for interoperability, but in no way representing good
design practices. In particular, readers are cautioned to pay close attention to the twisted details
involving repeated (and in some cases nested) conversions between character encodings and byte
sequences. Unfortunately the format is in widespread use due to the prevalence of HTML forms.<a data-link-type="biblio" href="#biblio-html">[HTML]</a> </p>
   <h3 class="heading settled" data-level="5.1" id="urlencoded-parsing"><span class="secno">5.1. </span><span class="content"><code>application/x-www-form-urlencoded</code> parsing</span><a class="self-link" href="#urlencoded-parsing"></a></h3>
   <p class="note no-backref" role="note">The features provided by the <a data-link-type="dfn" href="#concept-urlencoded-parser"><code>application/x-www-form-urlencoded</code> parser</a> are mainly
relevant for server-oriented implementations. A browser-based implementation only needs what the <a data-link-type="dfn" href="#concept-urlencoded-string-parser"><code>application/x-www-form-urlencoded</code> string parser</a> requires. </p>
   <p>The <dfn data-dfn-type="dfn" data-lt="urlencoded parser" data-noexport="" id="concept-urlencoded-parser"><code>application/x-www-form-urlencoded</code> parser<a class="self-link" href="#concept-urlencoded-parser"></a></dfn> takes a byte sequence <var>input</var>, optionally with an <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encoding">encoding</a> <var>encoding override</var>, and optionally with a <i>use _charset_ flag</i>, and then runs these
steps: </p>
   <ol>
    <li>
     <p>Let <var>encoding</var> be <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">UTF-8</a>. </p>
    <li>
     <p>If <var>encoding override</var> is given, set <var>encoding</var> to <var>encoding override</var>. </p>
    <li>
     <p>If <var>encoding</var> is not <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">UTF-8</a> and <var>input</var> contains bytes that are not <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#ascii-byte">ASCII bytes</a>, return failure. </p>
     <p class="note no-backref" role="note">This can only happen if <var>input</var> was not generated through the <a data-link-type="dfn" href="#concept-urlencoded-serializer">serializer</a> or <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code>. </p>
    <li>
     <p>Let <var>sequences</var> be the result of splitting <var>input</var> on
 `<code>&amp;</code>`. </p>
    <li>
     <p>Let <var>tuples</var> be an empty list of name-value tuples where both name and value hold a
 byte sequence. </p>
    <li>
     <p>For each byte sequence <var>bytes</var> in <var>sequences</var>,
  run these substeps: </p>
     <ol>
      <li>
       <p>If <var>bytes</var> is the empty byte sequence, run these substeps for the
   next byte sequence. </p>
      <li>
       <p>If <var>bytes</var> contains a `<code>=</code>`, then let <var>name</var> be the bytes from the start of <var>bytes</var> up to but
   excluding its first `<code>=</code>`, and let <var>value</var> be the
   bytes, if any, after the first `<code>=</code>` up to the end of <var>bytes</var>. If `<code>=</code>` is the first byte, then <var>name</var> will be the empty byte sequence. If it is the last, then <var>value</var> will be the empty byte sequence. </p>
      <li>
       <p>Otherwise, let <var>name</var> have the value of <var>bytes</var> and let <var>value</var> be the empty byte sequence. </p>
      <li>
       <p>Replace any `<code>+</code>` in <var>name</var> and <var>value</var> with 0x20. </p>
      <li>
       <p>If <i>use _charset_ flag</i> is set and <var>name</var> is `<code>_charset_</code>`, run
    these substeps: </p>
       <ol>
        <li>
         <p>Let <var>result</var> be the result of <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#concept-encoding-get">getting an encoding</a> for <var>value</var>, <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decode-without-bom">decoded</a>. </p>
        <li>
         <p>If <var>result</var> is not failure, unset <i>use _charset_ flag</i> and set <var>encoding</var> to <var>result</var>. </p>
       </ol>
      <li>
       <p>Add a tuple consisting of <var>name</var> and <var>value</var> to <var>tuples</var>. </p>
     </ol>
    <li>
     <p>Let <var>output</var> be an empty list of name-value tuples where both name and value hold a
 string. </p>
    <li>
     <p>For each name-value tuple in <var>tuples</var>, append a name-value tuple to <var>output</var> where the new name and value appended to <var>output</var> are the result of
 running <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#decode">decode</a> on the <a data-link-type="dfn" href="#percent-decode">percent decoding</a> of the name and value from <var>tuples</var>, respectively, using <var>encoding</var>. </p>
    <li>
     <p>Return <var>output</var>. </p>
   </ol>
   <h3 class="heading settled" data-level="5.2" id="urlencoded-serializing"><span class="secno">5.2. </span><span class="content"><code>application/x-www-form-urlencoded</code> serializing</span><a class="self-link" href="#urlencoded-serializing"></a></h3>
   <p>The <dfn data-dfn-type="dfn" data-lt="urlencoded byte serializer" data-noexport="" id="concept-urlencoded-byte-serializer"><code>application/x-www-form-urlencoded</code> byte serializer<a class="self-link" href="#concept-urlencoded-byte-serializer"></a></dfn> takes a byte sequence <var>input</var> and then runs these steps: </p>
   <ol>
    <li>
     <p>Let <var>output</var> be the empty string. </p>
    <li>
     <p>For each byte in <var>input</var>, depending on <var>byte</var>: </p>
     <dl>
      <dt>0x20 
      <dd>
       <p>Append U+002B to <var>output</var>. </p>
      <dt>0x2A 
      <dt>0x2D 
      <dt>0x2E 
      <dt>0x30 to 0x39 
      <dt>0x41 to 0x5A 
      <dt>0x5F 
      <dt>0x61 to 0x7A 
      <dd>
       <p>Append a code point whose value is <var>byte</var> to <var>output</var>. </p>
      <dt>Otherwise 
      <dd>
       <p>Append <var>byte</var>, <a data-link-type="dfn" href="#percent-encode">percent encoded</a>, to <var>output</var>. </p>
     </dl>
    <li>
     <p>Return <var>output</var>. </p>
   </ol>
   <p>The <dfn data-dfn-type="dfn" data-lt="urlencoded serializer" data-noexport="" id="concept-urlencoded-serializer"><code>application/x-www-form-urlencoded</code> serializer<a class="self-link" href="#concept-urlencoded-serializer"></a></dfn> takes a list of name-value or name-value-type tuples <var>tuples</var>, optionally with an <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encoding">encoding</a> <var>encoding override</var>, and then runs these steps: </p>
   <ol>
    <li>
     <p>Let <var>encoding</var> be <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">UTF-8</a>. </p>
    <li>
     <p>If <var>encoding override</var> is given, set <var>encoding</var> to the result of <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#get-an-output-encoding">getting an output encoding</a> from <var>encoding override</var>. </p>
    <li>
     <p>Let <var>output</var> be the empty string. </p>
    <li>
     <p>For each <var>tuple</var> in <var>tuples</var>, run these substeps: </p>
     <ol>
      <li>
       <p>Let <var>outputPair</var> be a new name-value pair. </p>
      <li>
       <p>Set <var>outputPair</var>’s name to the result of <a data-link-type="dfn" href="#concept-urlencoded-byte-serializer">serializing</a> the result of <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encode">encoding</a> <var>tuple</var>’s name, using <var>encoding</var>. </p>
      <li>
       <p>If <var>tuple</var> has a type, <var>tuple</var>’s type is "<code>hidden</code>", and <var>outputPair</var>’s name is "<code>_charset_</code>", set <var>outputPair</var>’s value to <var>encoding</var>’s <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#name">name</a>. </p>
      <li>
       <p>Otherwise, if <var>tuple</var> has a type, and <var>tuple</var>’s type is
   "<code>file</code>", set <var>outputPair</var>’s value to <var>tuple</var>’s value’s filename. </p>
      <li>
       <p>Otherwise, set <var>outputPair</var>’s value to the result of <a data-link-type="dfn" href="#concept-urlencoded-byte-serializer">serializing</a> the result of <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encode">encoding</a> <var>tuple</var>’s value, using <var>encoding</var>. </p>
      <li>
       <p>If <var>tuple</var> is not the first pair in <var>tuples</var>, then append
   "<code>&amp;</code>" to <var>output</var>. </p>
      <li>Append <var>outputPair</var>’s name, followed by "<code>=</code>", followed by <var>outputPair</var>’s value, to <var>output</var>. 
     </ol>
    <li>Return <var>output</var>. 
   </ol>
   <p class="note no-backref" role="note">The <cite>HTML standard</cite> invokes this algorithm with
name-value-type tuples. <a data-link-type="biblio" href="#biblio-html">[HTML]</a> </p>
   <h3 class="heading settled" data-level="5.3" id="urlencoded-hooks"><span class="secno">5.3. </span><span class="content">Hooks</span><a class="self-link" href="#urlencoded-hooks"></a></h3>
   <p>The <dfn data-dfn-type="dfn" data-lt="urlencoded string parser" data-noexport="" id="concept-urlencoded-string-parser"><code>application/x-www-form-urlencoded</code> string parser<a class="self-link" href="#concept-urlencoded-string-parser"></a></dfn> takes a string <var>input</var>, <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-encode">UTF-8 encodes</a> it, and then returns the
result of <a data-link-type="dfn" href="#concept-urlencoded-parser"><code>application/x-www-form-urlencoded</code> parsing</a> it. </p>
   <h2 class="heading settled" data-level="6" id="api"><span class="secno">6. </span><span class="content">API</span><a class="self-link" href="#api"></a></h2>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="constructor" href="#dom-url-url">Constructor</a>(<span class="kt">USVString</span> <dfn class="nv idl-code" data-dfn-for="URL/URL(url, base)" data-dfn-type="argument" data-export="" id="dom-url-url-url-base-url">url<a class="self-link" href="#dom-url-url-url-base-url"></a></dfn>, <span class="kt">optional</span> <span class="kt">USVString</span> <dfn class="nv idl-code" data-dfn-for="URL/URL(url, base)" data-dfn-type="argument" data-export="" id="dom-url-url-url-base-base">base<a class="self-link" href="#dom-url-url-url-base-base"></a></dfn>),
 <a class="nv idl-code" data-link-type="extended-attribute">Exposed</a>=(<span class="n">Window</span>,<span class="n">Worker</span>)]
<span class="kt">interface</span> <dfn class="nv idl-code" data-dfn-type="interface" data-export="" id="url">URL<a class="self-link" href="#url"></a></dfn> {
  <span class="kt">static</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="method" href="#dom-url-domaintoascii">domainToASCII</a>(<span class="kt">USVString</span> <dfn class="nv idl-code" data-dfn-for="URL/domainToASCII(domain)" data-dfn-type="argument" data-export="" id="dom-url-domaintoascii-domain-domain">domain<a class="self-link" href="#dom-url-domaintoascii-domain-domain"></a></dfn>);
  <span class="kt">static</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="method" href="#dom-url-domaintounicode">domainToUnicode</a>(<span class="kt">USVString</span> <dfn class="nv idl-code" data-dfn-for="URL/domainToUnicode(domain)" data-dfn-type="argument" data-export="" id="dom-url-domaintounicode-domain-domain">domain<a class="self-link" href="#dom-url-domaintounicode-domain-domain"></a></dfn>);

  <dfn class="kt" data-dfn-for="URL" data-dfn-type="dfn" data-lt="stringification behavior" data-noexport="" id="URL-stringification-behavior">stringifier<a class="self-link" href="#URL-stringification-behavior"></a></dfn> <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-href">href</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="USVString" href="#dom-url-origin">origin</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-protocol">protocol</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-username">username</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-password">password</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-host">host</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-hostname">hostname</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-port">port</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-pathname">pathname</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-search">search</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#urlsearchparams">URLSearchParams</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="URLSearchParams" href="#dom-url-searchparams">searchParams</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-hash">hash</a>;
};
</pre>
   <p>A <code class="idl"><a data-link-type="idl" href="#url">URL</a></code> object has an associated <dfn data-dfn-for="URL" data-dfn-type="dfn" data-noexport="" id="concept-url-url">url<a class="self-link" href="#concept-url-url"></a></dfn> (a <a data-link-type="dfn" href="#concept-url">URL</a>) and <dfn data-dfn-for="URL" data-dfn-type="dfn" data-noexport="" id="concept-url-query-object">query object<a class="self-link" href="#concept-url-query-object"></a></dfn> (a <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object). </p>
   <h3 class="heading settled" data-level="6.1" id="constructors"><span class="secno">6.1. </span><span class="content">Constructors</span><a class="self-link" href="#constructors"></a></h3>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="constructor" data-export="" id="dom-url-url"><code>URL(<var>url</var>, <var>base</var>)</code><a class="self-link" href="#dom-url-url"></a></dfn> constructor,
when invoked, must run these steps: </p>
   <ol>
    <li>
     <p>Let <var>parsedBase</var> be null. </p>
    <li>
     <p>If <var>base</var> is given, run these substeps: </p>
     <ol>
      <li>
       <p>Let <var>parsedBase</var> be the result of running the <a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parser</a> on <var>base</var>. </p>
      <li>
       <p>If <var>parsedBase</var> is failure, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> a <code>TypeError</code> exception. </p>
     </ol>
    <li>
     <p>Let <var>parsedURL</var> be the result of running the <a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parser</a> on <var>url</var> with <var>parsedBase</var>. </p>
    <li>
     <p>If <var>parsedURL</var> is failure, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> a <code>TypeError</code> exception. </p>
    <li>
     <p>Let <var>query</var> be <var>parsedURL</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>, if that is non-null,
 and the empty string otherwise. </p>
    <li>
     <p>Let <var>result</var> be a new <code class="idl"><a data-link-type="idl" href="#url">URL</a></code> object. </p>
    <li>
     <p>Set <var>result</var>’s <a data-link-type="dfn" href="#concept-url-url">url</a> to <var>parsedURL</var>. </p>
    <li>
     <p>Set <var>result</var>’s <a data-link-type="dfn" href="#concept-url-query-object">query object</a> to a <a data-link-type="dfn" href="#concept-urlsearchparams-new">new</a> <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object using <var>query</var>, and then set that <a data-link-type="dfn" href="#concept-url-query-object">query object</a>’s <a data-link-type="dfn" href="#concept-urlsearchparams-url-object">url object</a> to <var>result</var>. </p>
    <li>
     <p>Return <var>result</var>. </p>
   </ol>
   <div class="example no-backref" id="example-5434421b">
    <a class="self-link" href="#example-5434421b"></a> 
    <p>To <a data-link-type="dfn" href="#concept-basic-url-parser">parse</a> a string into a <a data-link-type="dfn" href="#concept-url">URL</a> without using a <a data-link-type="dfn" href="#concept-base-url">base URL</a>, invoke the <code class="idl"><a data-link-type="idl" href="#url">URL</a></code> constructor with a single argument: </p>
<pre>var input = "https://example.org/💩",    url = new URL(input)
url.pathname // "/%F0%9F%92%A9"</pre>
    <p>This throws an exception if the input is not an <a data-link-type="dfn" href="#syntax-url-absolute">absolute URL</a>: </p>
<pre>try {  var url = new URL("/🍣🍺")
} catch(e) {
  // that happened
}</pre>
    <p>A <a data-link-type="dfn" href="#concept-base-url">base URL</a> is necessary if the input is a <a data-link-type="dfn" href="#syntax-url-relative">relative URL</a>: </p>
<pre>var input = "/🍣🍺",    url = new URL(input, document.baseURI)
url.href // "https://url.spec.whatwg.org/%F0%9F%8D%A3%F0%9F%8D%BA"</pre>
   </div>
   <h3 class="heading settled" data-level="6.2" id="url-statics"><span class="secno">6.2. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#url">URL</a></code> statics</span><a class="self-link" href="#url-statics"></a></h3>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="method" data-export="" id="dom-url-domaintoascii"><code>domainToASCII(<var>domain</var>)</code><a class="self-link" href="#dom-url-domaintoascii"></a></dfn> static
method, when invoked, must run these steps: </p>
   <ol>
    <li>
     <p>Let <var>asciiDomain</var> be the result of <a data-link-type="dfn" href="#concept-host-parser">host parsing</a> <var>domain</var>. </p>
    <li>
     <p>Return the empty string if <var>asciiDomain</var> is not a <a data-link-type="dfn" href="#concept-domain">domain</a>,
 and <var>asciiDomain</var> otherwise. </p>
   </ol>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="method" data-export="" id="dom-url-domaintounicode"><code>domainToUnicode(<var>domain</var>)</code><a class="self-link" href="#dom-url-domaintounicode"></a></dfn> static
method, when invoked, must run these steps: </p>
   <ol>
    <li>
     <p>Let <var>unicodeDomain</var> be the result of <a data-link-type="dfn" href="#concept-host-parser">host parsing</a> <var>domain</var> with the <var>Unicode flag</var> set. </p>
    <li>
     <p>Return the empty string if <var>unicodeDomain</var> is not a <a data-link-type="dfn" href="#concept-domain">domain</a>, and <var>unicodeDomain</var> otherwise. </p>
   </ol>
   <h3 class="heading settled" data-level="6.3" id="urlutils-members"><span class="secno">6.3. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#url">URL</a></code> members</span><a class="self-link" href="#urlutils-members"></a></h3>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="attribute" data-export="" id="dom-url-href"><code>href</code><a class="self-link" href="#dom-url-href"></a></dfn> attribute’s getter must return the <a data-link-type="dfn" href="#concept-url-serializer">serialization</a> of <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>. </p>
   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-url-href">href</a></code> attribute’s setter must run these steps: </p>
   <ol>
    <li>
     <p>Let <var>parsedURL</var> be the result of running the <a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parser</a> on the given
 value. </p>
    <li>
     <p>If <var>parsedURL</var> is failure, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> a <code>TypeError</code> exception. </p>
    <li>
     <p>Set <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a> to <var>parsedURL</var>. </p>
   </ol>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="attribute" data-export="" id="dom-url-origin"><code>origin</code><a class="self-link" href="#dom-url-origin"></a></dfn> attribute’s getter must return the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#unicode-serialisation-of-an-origin">Unicode serialization</a> of <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-origin">origin</a>. <a data-link-type="biblio" href="#biblio-html">[HTML]</a> </p>
   <p class="note no-backref" role="note">It returns the Unicode rather than the ASCII serialization for
compatibility with HTML’s <code>MessageEvent</code> feature. <a data-link-type="biblio" href="#biblio-html">[HTML]</a> </p>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="attribute" data-export="" id="dom-url-protocol"><code>protocol</code><a class="self-link" href="#dom-url-protocol"></a></dfn> attribute’s getter must return <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a> <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>, followed by "<code>:</code>". </p>
   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-url-protocol">protocol</a></code> attribute’s setter must <a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parse</a> the given value, followed by "<code>:</code>", with <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a> as <var>url</var> and <a data-link-type="dfn" href="#scheme-start-state">scheme start state</a> as <var>state override</var>. </p>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="attribute" data-export="" id="dom-url-username"><code>username</code><a class="self-link" href="#dom-url-username"></a></dfn> attribute’s getter must return <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-username">username</a>. </p>
   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-url-username">username</a></code> attribute’s setter must run these steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a> is null, or its <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a> is set, terminate these steps. </p>
    <li>
     <p><a data-link-type="dfn" href="#set-the-username">Set the username</a> given <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a> and the given
 value. </p>
   </ol>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="attribute" data-export="" id="dom-url-password"><code>password</code><a class="self-link" href="#dom-url-password"></a></dfn> attribute’s getter must run these steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-password">password</a> is null, return the
 empty string. </p>
    <li>
     <p>Return <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-password">password</a>. </p>
   </ol>
   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-url-password">password</a></code> attribute’s setter must run these steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a> is null, or its <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a> is set, terminate these steps. </p>
    <li>
     <p><a data-link-type="dfn" href="#set-the-password">Set the password</a> given <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a> and the given
 value. </p>
   </ol>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="attribute" data-export="" id="dom-url-host"><code>host</code><a class="self-link" href="#dom-url-host"></a></dfn> attribute’s getter must run these steps: </p>
   <ol>
    <li>
     <p>Let <var>url</var> be <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>. </p>
    <li>
     <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> is null, return the empty string. </p>
    <li>
     <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> is null, return <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <a data-link-type="dfn" href="#concept-host-serializer">serialized</a>. </p>
    <li>
     <p>Return <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <a data-link-type="dfn" href="#concept-host-serializer">serialized</a>,
 followed by "<code>:</code>" and <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a>, <a data-link-type="dfn" href="#serialize-an-integer">serialized</a>. </p>
   </ol>
   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-url-host">host</a></code> attribute’s setter must run these steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a> is set,
 terminate these steps. </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> the given value with <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a> as <var>url</var> and <a data-link-type="dfn" href="#host-state">host state</a> as <var>state override</var>. </p>
   </ol>
   <p class="note no-backref" role="note">If the given value for the <code><a class="idl-code" data-link-type="attribute" href="#dom-url-host">host</a></code> attribute’s setter lacks a <a data-link-type="dfn" href="#syntax-url-port">port</a>, <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-port">port</a> will not change. This can be unexpected as <code>host</code> attribute’s getter
does return a <a data-link-type="dfn" href="#syntax-url-port">port</a> so one might have assumed the setter to always "reset" both. </p>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="attribute" data-export="" id="dom-url-hostname"><code>hostname</code><a class="self-link" href="#dom-url-hostname"></a></dfn> attribute’s getter must run these steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a> is null, return the
 empty string. </p>
    <li>
     <p>Return <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, <a data-link-type="dfn" href="#concept-host-serializer">serialized</a>. </p>
   </ol>
   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-url-hostname">hostname</a></code> attribute’s setter must run these steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a> is set,
 terminate these steps. </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> the given value with <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a> as <var>url</var> and <a data-link-type="dfn" href="#hostname-state">hostname state</a> as <var>state override</var>. </p>
   </ol>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="attribute" data-export="" id="dom-url-port"><code>port</code><a class="self-link" href="#dom-url-port"></a></dfn> attribute’s getter must run these steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-port">port</a> is null, return the
 empty string. </p>
    <li>
     <p>Return <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-port">port</a>, <a data-link-type="dfn" href="#serialize-an-integer">serialized</a>. </p>
   </ol>
   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-url-port">port</a></code> attribute’s setter must run these steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-host">host</a> is null, its <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a> is set, or its <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is "<code>file</code>",
 terminate these steps. </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> the given value with <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a> as <var>url</var> and <a data-link-type="dfn" href="#port-state">port state</a> as <var>state override</var>. </p>
   </ol>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="attribute" data-export="" id="dom-url-pathname"><code>pathname</code><a class="self-link" href="#dom-url-pathname"></a></dfn> attribute’s getter must run these steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a> is set,
 return the first string in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-path">path</a>. </p>
    <li>
     <p>Return "<code>/</code>", followed by the strings in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-path">path</a> (including empty strings), separated from each other by
 "<code>/</code>". </p>
   </ol>
   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-url-pathname">pathname</a></code> attribute’s setter must
run these steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a> is set,
 terminate these steps. </p>
    <li>
     <p>Empty <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-path">path</a>. </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> the given value with <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a> as <var>url</var> and <a data-link-type="dfn" href="#path-start-state">path start state</a> as <var>state override</var>. </p>
   </ol>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="attribute" data-export="" id="dom-url-search"><code>search</code><a class="self-link" href="#dom-url-search"></a></dfn> attribute’s getter must run these steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-query">query</a> is either null or the
 empty string, return the empty string. </p>
    <li>
     <p>Return "<code>?</code>", followed by <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-query">query</a>. </p>
   </ol>
   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-url-search">search</a></code> attribute’s setter must run these
steps: </p>
   <ol>
    <li>
     <p>Let <var>url</var> be <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>. </p>
    <li>
     <p>If the given value is the empty string, set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to null,
 empty <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query-object">query object</a>’s <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>,
 and terminate these steps. </p>
    <li>
     <p>Let <var>input</var> be the given value with a single leading "<code>?</code>" removed, if
 any. </p>
    <li>
     <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to the empty string. </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> <var>input</var> with <var>url</var> as <var>url</var> and <a data-link-type="dfn" href="#query-state">query state</a> as <var>state override</var>. </p>
    <li>
     <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query-object">query object</a>’s <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a> to the
 result of <a data-link-type="dfn" href="#concept-urlencoded-string-parser">parsing</a> <var>input</var>. </p>
   </ol>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="attribute" data-export="" id="dom-url-searchparams"><code>searchParams</code><a class="self-link" href="#dom-url-searchparams"></a></dfn> attribute’s getter must return <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-query-object">query object</a>. </p>
   <p>The <dfn class="idl-code" data-dfn-for="URL" data-dfn-type="attribute" data-export="" id="dom-url-hash"><code>hash</code><a class="self-link" href="#dom-url-hash"></a></dfn> attribute’s
getter must run these steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> is either null or
 the empty string, return the empty string. </p>
    <li>
     <p>Return "<code>#</code>", followed by <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a>. </p>
   </ol>
   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-url-hash">hash</a></code> attribute’s setter must run these
steps: </p>
   <ol>
    <li>
     <p>If <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is
 "<code>javascript</code>", terminate these steps. </p>
    <li>
     <p>If the given value is the empty string, set <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to null and terminate these steps. </p>
    <li>
     <p>Let <var>input</var> be the given value with a single leading "<code>#</code>" removed, if
 any. </p>
    <li>
     <p>Set <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty
 string. </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> <var>input</var> with <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a> as <var>url</var> and <a data-link-type="dfn" href="#fragment-state">fragment state</a> as <var>state override</var>. </p>
   </ol>
   <h3 class="heading settled" data-level="6.4" id="interface-urlsearchparams"><span class="secno">6.4. </span><span class="content">Interface <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code></span><a class="self-link" href="#interface-urlsearchparams"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="constructor" href="#dom-urlsearchparams-urlsearchparams">Constructor</a>(<span class="kt">optional</span> (<span class="kt">USVString</span> <span class="kt">or</span> <a class="n" data-link-type="idl-name" href="#urlsearchparams">URLSearchParams</a>) <dfn class="nv idl-code" data-dfn-for="URLSearchParams/URLSearchParams(init)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-urlsearchparams-init-init">init<a class="self-link" href="#dom-urlsearchparams-urlsearchparams-init-init"></a></dfn> = ""),
 <a class="nv idl-code" data-link-type="extended-attribute">Exposed</a>=(<span class="n">Window</span>,<span class="n">Worker</span>)]
<span class="kt">interface</span> <dfn class="nv idl-code" data-dfn-type="interface" data-export="" id="urlsearchparams">URLSearchParams<a class="self-link" href="#urlsearchparams"></a></dfn> {
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-urlsearchparams-append">append</a>(<span class="kt">USVString</span> <dfn class="nv idl-code" data-dfn-for="URLSearchParams/append(name, value)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-append-name-value-name">name<a class="self-link" href="#dom-urlsearchparams-append-name-value-name"></a></dfn>, <span class="kt">USVString</span> <dfn class="nv idl-code" data-dfn-for="URLSearchParams/append(name, value)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-append-name-value-value">value<a class="self-link" href="#dom-urlsearchparams-append-name-value-value"></a></dfn>);
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-urlsearchparams-delete">delete</a>(<span class="kt">USVString</span> <dfn class="nv idl-code" data-dfn-for="URLSearchParams/delete(name)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-delete-name-name">name<a class="self-link" href="#dom-urlsearchparams-delete-name-name"></a></dfn>);
  <span class="kt">USVString</span>? <a class="nv idl-code" data-link-type="method" href="#dom-urlsearchparams-get">get</a>(<span class="kt">USVString</span> <dfn class="nv idl-code" data-dfn-for="URLSearchParams/get(name)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-get-name-name">name<a class="self-link" href="#dom-urlsearchparams-get-name-name"></a></dfn>);
  <span class="kt">sequence</span>&lt;<span class="kt">USVString</span>> <a class="nv idl-code" data-link-type="method" href="#dom-urlsearchparams-getall">getAll</a>(<span class="kt">USVString</span> <dfn class="nv idl-code" data-dfn-for="URLSearchParams/getAll(name)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-getall-name-name">name<a class="self-link" href="#dom-urlsearchparams-getall-name-name"></a></dfn>);
  <span class="kt">boolean</span> <a class="nv idl-code" data-link-type="method" href="#dom-urlsearchparams-has">has</a>(<span class="kt">USVString</span> <dfn class="nv idl-code" data-dfn-for="URLSearchParams/has(name)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-has-name-name">name<a class="self-link" href="#dom-urlsearchparams-has-name-name"></a></dfn>);
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-urlsearchparams-set">set</a>(<span class="kt">USVString</span> <dfn class="nv idl-code" data-dfn-for="URLSearchParams/set(name, value)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-set-name-value-name">name<a class="self-link" href="#dom-urlsearchparams-set-name-value-name"></a></dfn>, <span class="kt">USVString</span> <dfn class="nv idl-code" data-dfn-for="URLSearchParams/set(name, value)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-set-name-value-value">value<a class="self-link" href="#dom-urlsearchparams-set-name-value-value"></a></dfn>);
  <span class="kt">iterable</span>&lt;<span class="kt">USVString</span>, <span class="kt">USVString</span>>;
  <a class="kt" data-link-type="dfn" href="#urlsearchparams-stringification-behavior">stringifier</a>;
};
</pre>
   <p>A <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object has an associated <dfn data-dfn-for="URLSearchParams" data-dfn-type="dfn" data-noexport="" id="concept-urlsearchparams-list">list<a class="self-link" href="#concept-urlsearchparams-list"></a></dfn> of name-value pairs,
which is initially empty. </p>
   <p>A <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object has an associated <dfn data-dfn-for="URLSearchParams" data-dfn-type="dfn" data-noexport="" id="concept-urlsearchparams-url-object">url object<a class="self-link" href="#concept-urlsearchparams-url-object"></a></dfn>, which is
initially null. </p>
   <p>To create a <dfn data-dfn-for="URLSearchParams" data-dfn-type="dfn" data-noexport="" id="concept-urlsearchparams-new">new<a class="self-link" href="#concept-urlsearchparams-new"></a></dfn> <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object, optionally using <var>init</var>, run these steps: </p>
   <ol>
    <li>
     <p>Let <var>query</var> be a new <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object. </p>
    <li>
     <p>If <var>init</var> is a string, set <var>query</var>’s <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a> to the result of <a data-link-type="dfn" href="#concept-urlencoded-string-parser">parsing</a> <var>init</var>. </p>
    <li>
     <p>If <var>init</var> is a <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object, set <var>query</var>’s <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a> to a copy of <var>init</var>’s <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>. </p>
    <li>
     <p>Return <var>query</var>. </p>
   </ol>
   <p>A <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object’s <dfn data-dfn-for="URLSearchParams" data-dfn-type="dfn" data-noexport="" id="concept-urlsearchparams-update">update steps<a class="self-link" href="#concept-urlsearchparams-update"></a></dfn> are to set <a data-link-type="dfn" href="#concept-urlsearchparams-url-object">url object</a>’s <a data-link-type="dfn" href="#concept-url-url">url</a>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to the <a data-link-type="dfn" href="#concept-urlencoded-serializer">serialization</a> of <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object’s <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>. </p>
   <p>The <dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="constructor" data-export="" id="dom-urlsearchparams-urlsearchparams"><code>URLSearchParams(<var>init</var>)</code><a class="self-link" href="#dom-urlsearchparams-urlsearchparams"></a></dfn> constructor, when invoked, must run these steps:</p>
   <ol>
    <li>
     <p>If <var>init</var> is given, is a string, and starts with "<code>?</code>", remove the first
 code point from <var>init</var>. </p>
    <li>
     <p>Return a <a data-link-type="dfn" href="#concept-urlsearchparams-new">new</a> <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object, using <var>init</var> if
 given. </p>
   </ol>
   <p>The <dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="method" data-export="" id="dom-urlsearchparams-append"><code>append(<var>name</var>, <var>value</var>)</code><a class="self-link" href="#dom-urlsearchparams-append"></a></dfn> method, when invoked, must run these steps: </p>
   <ol>
    <li>
     <p>Append a new name-value pair whose name is <var>name</var> and
 value is <var>value</var>, to <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>. </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#concept-urlsearchparams-update">update steps</a>. </p>
   </ol>
   <p>The <dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="method" data-export="" id="dom-urlsearchparams-delete"><code>delete(<var>name</var>)</code><a class="self-link" href="#dom-urlsearchparams-delete"></a></dfn> method, when
invoked, must run these steps: </p>
   <ol>
    <li>
     <p>Remove all name-value pairs whose name is <var>name</var> from <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>. </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#concept-urlsearchparams-update">update steps</a>. </p>
   </ol>
   <p>The <dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="method" data-export="" id="dom-urlsearchparams-get"><code>get(<var>name</var>)</code><a class="self-link" href="#dom-urlsearchparams-get"></a></dfn> method, when invoked, must return the value of the first name-value pair whose name is <var>name</var> in <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>, if there is such a pair, and null otherwise. </p>
   <p>The <dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="method" data-export="" id="dom-urlsearchparams-getall"><code>getAll(<var>name</var>)</code><a class="self-link" href="#dom-urlsearchparams-getall"></a></dfn> method, when invoked, must return the values of all name-value pairs whose name is <var>name</var>,
in <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>, in list order, and the empty sequence otherwise. </p>
   <p>The <dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="method" data-export="" id="dom-urlsearchparams-set"><code>set(<var>name</var>, <var>value</var>)</code><a class="self-link" href="#dom-urlsearchparams-set"></a></dfn> method, when invoked, must run these steps: </p>
   <ol>
    <li>
     <p>If there are any name-value pairs whose name is <var>name</var>, in <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>, set the value of the first such name-value pair to <var>value</var> and remove the others. </p>
    <li>
     <p>Otherwise, append a new name-value pair whose name is <var>name</var> and value is <var>value</var>, to <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>. </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#concept-urlsearchparams-update">update steps</a>. </p>
   </ol>
   <p>The <dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="method" data-export="" id="dom-urlsearchparams-has"><code>has(<var>name</var>)</code><a class="self-link" href="#dom-urlsearchparams-has"></a></dfn> method, when invoked, must return true if there is a name-value pair whose name is <var>name</var> in <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>, and false otherwise. </p>
   <p>The <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-value-pairs-to-iterate-over">value pairs to iterate over</a> are the <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a> name-value pairs with the key being
the name and the value being the value. </p>
   <p>The <dfn data-dfn-for="URLSearchParams" data-dfn-type="dfn" data-noexport="" id="urlsearchparams-stringification-behavior">stringification behavior<a class="self-link" href="#urlsearchparams-stringification-behavior"></a></dfn> must return the <a data-link-type="dfn" href="#concept-urlencoded-serializer">serialization</a> of the <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object’s <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>. </p>
   <h3 class="heading settled" data-level="6.5" id="url-apis-elsewhere"><span class="secno">6.5. </span><span class="content">URL APIs elsewhere</span><a class="self-link" href="#url-apis-elsewhere"></a></h3>
   <p>A standard that exposes <a data-link-type="dfn" href="#concept-url">URLs</a>, should expose the <a data-link-type="dfn" href="#concept-url">URL</a> as a
string  (by <a data-link-type="dfn" href="#concept-url-serializer">serializing</a> an internal <a data-link-type="dfn" href="#concept-url">URL</a>). A
standard should not expose a <a data-link-type="dfn" href="#concept-url">URL</a> using a <code class="idl"><a data-link-type="idl" href="#url">URL</a></code> object. <code class="idl"><a data-link-type="idl" href="#url">URL</a></code> objects
are meant for <a data-link-type="dfn" href="#concept-url">URL</a> manipulation. In IDL the USVString type should be used. </p>
   <p class="note" role="note">The higher-level notion here is that values are to be exposed as immutable
data structures. </p>
   <p>If a standard decides to use a variant of the name "URL" for a feature it defines, it
should name such a feature "url" (i.e., lowercase and with an "l" at the end). Names such
as "URL", "URI", and "IRI" should not be used. However, if the name is a compound, "URL"
(i.e., uppercase) is preferred, e.g., "newURL" and "oldURL". </p>
   <p class="note" role="note">The <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#eventsource">EventSource</a></code> and <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/browsers.html#hashchangeevent">HashChangeEvent</a></code> interfaces in HTML are examples of
proper naming. <a data-link-type="biblio" href="#biblio-html">[HTML]</a> </p>
   <h2 class="no-num heading settled" id="acknowledgments"><span class="content">Acknowledgments</span><a class="self-link" href="#acknowledgments"></a></h2>
   <p>There have been a lot of people that have helped make <a class="no-backref" data-link-type="dfn" href="#concept-url">URLs</a> more interoperable over the years and thereby furthered the goals of this standard. Likewise many
people have helped making this standard what it is today. </p>
   <p>With that, many thanks to
100の人,
Adam Barth,
Addison Phillips,
Albert Wiersch,
Alexandre Morgaut,
Andrew Sullivan,
Arkadiusz Michalski,
Behnam Esfahbod,
Bobby Holley,
Boris Zbarsky,
Brad Hill,
Brandon Ross,
Chris Rebert,
Dan Appelquist,
Daniel Bratell,
David Burns,
David Håsäther,
David Sheets,
David Singer,
David Walp,
Domenic Denicola,
Erik Arvidsson,
Gavin Carothers,
Geoff Richards,
Glenn Maynard,
Henri Sivonen,
Ian Hickson,
Jakub Gieryluk,
James Graham,
James Manger,
James Ross,
Joshua Bell,
Jxck,
Kevin Grandon,
Larry Masinter,
Leif Halvard Silli,
Mark Davis,
Marcos Cáceres,
Martin Dürst,
Mathias Bynens,
Michael Peick,
Michael™ Smith,
Michel Suignard,
Peter Occil,
Philip Jägenstedt,
Prayag Verma,
Rodney Rehm,
Roy Fielding,
Ryan Sleevi,
Sam Ruby,
Santiago M. Mola,
Sebastian Mayr,
Simon Pieters,
Simon Sapin,
Stuart Cook,
Sven Uhlig,
Tab Atkins,
吉野剛史 (Takeshi Yoshino),
Tantek Çelik,
Tim Berners-Lee,
Titi_Alone,
Tomek Wytrębowicz,
Valentin Gosu,
Vyacheslav Matva,
山岸和利 (Yamagishi Kazutoshi), and
成瀬ゆい (Yui Naruse)
for being awesome! </p>
   <p>This standard is written by <a href="https://annevankesteren.nl/" lang="nl">Anne van Kesteren</a> (<a href="https://www.mozilla.org/">Mozilla</a>, <a href="mailto:annevk@annevk.nl">annevk@annevk.nl</a>). </p>
   <p>Per <a href="//creativecommons.org/publicdomain/zero/1.0/" rel="license">CC0</a>, to
the extent possible under law, the editors have waived all copyright and related or
neighboring rights to this work. </p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-num no-ref heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p>All diagrams, examples, and notes in this specification are non-normative, as are all sections explicitly marked non-normative. Everything else in this specification is normative. </p>
   <p>The key words “MUST”, “MUST NOT”, “REQUIRED”,  “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this specification are to be interpreted as described in RFC2119. For readability, these words do not appear in all uppercase letters in this specification. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
   <p>Conformance requirements phrased as algorithms or specific steps may be implemented in any manner, so long as the end result is equivalent. (In particular, the algorithms defined in this specification are intended to be easy to follow, and not intended to be performant.) </p>
  </div>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#syntax-url-absolute">absolute URL</a><span>, in §4.1</span>
   <li><a href="#syntax-url-absolute-with-fragment">absolute URL with fragment</a><span>, in §4.1</span>
   <li><a href="#dom-urlsearchparams-append">append(name, value)</a><span>, in §6.4</span>
   <li><a href="#concept-urlencoded">application/x-www-form-urlencoded</a><span>, in §5</span>
   <li><a href="#ascii-alpha">ASCII alpha</a><span>, in §1</span>
   <li><a href="#ascii-alphanumeric">ASCII alphanumeric</a><span>, in §1</span>
   <li><a href="#ascii-digits">ASCII digits</a><span>, in §1</span>
   <li><a href="#ascii-hex-digits">ASCII hex digits</a><span>, in §1</span>
   <li><a href="#ascii-lowercase">ASCII lowercase</a><span>, in §1</span>
   <li><a href="#ascii-string">ASCII string</a><span>, in §1</span>
   <li><a href="#authority-state">authority state</a><span>, in §4.2</span>
   <li><a href="#concept-base-url">base URL</a><span>, in §4</span>
   <li><a href="#concept-basic-url-parser">basic URL parser</a><span>, in §4.2</span>
   <li><a href="#c">c</a><span>, in §1.1</span>
   <li><a href="#c0-controls">C0 controls</a><span>, in §1</span>
   <li><a href="#c0-controls-and-space">C0 controls and space</a><span>, in §1</span>
   <li><a href="#url-cannot-be-a-base-url-flag">cannot-be-a-base-URL flag</a><span>, in §4</span>
   <li><a href="#cannot-be-a-base-url-path-state">cannot-be-a-base-URL path state</a><span>, in §4.2</span>
   <li><a href="#default-encode-set">default encode set</a><span>, in §1.2</span>
   <li><a href="#default-port">default port</a><span>, in §4</span>
   <li><a href="#dom-urlsearchparams-delete">delete(name)</a><span>, in §6.4</span>
   <li>
    domain
    <ul>
     <li><a href="#concept-domain">dfn for host</a><span>, in §3</span>
     <li><a href="#syntax-host-domain">dfn for hostsyntax</a><span>, in §3.2</span>
    </ul>
   <li><a href="#concept-domain-to-ascii">domain to ASCII</a><span>, in §3.1</span>
   <li><a href="#dom-url-domaintoascii">domainToASCII(domain)</a><span>, in §6.2</span>
   <li><a href="#concept-domain-to-unicode">domain to Unicode</a><span>, in §3.1</span>
   <li><a href="#dom-url-domaintounicode">domainToUnicode(domain)</a><span>, in §6.2</span>
   <li><a href="#syntax-url-path-segment-dotdot">double-dot path segment</a><span>, in §4.1</span>
   <li><a href="#eof-code-point">EOF code point</a><span>, in §1.1</span>
   <li>
    equals
    <ul>
     <li><a href="#concept-host-equals">dfn for host</a><span>, in §3.5</span>
     <li><a href="#concept-url-equals">dfn for url</a><span>, in §4.4</span>
    </ul>
   <li><a href="#fetch-scheme">fetch scheme</a><span>, in §4</span>
   <li><a href="#file-host-state">file host state</a><span>, in §4.2</span>
   <li><a href="#file-slash-state">file slash state</a><span>, in §4.2</span>
   <li><a href="#file-state">file state</a><span>, in §4.2</span>
   <li>
    fragment
    <ul>
     <li><a href="#concept-url-fragment">dfn for url</a><span>, in §4</span>
     <li><a href="#syntax-url-fragment">dfn for urlsyntax</a><span>, in §4.1</span>
    </ul>
   <li><a href="#fragment-state">fragment state</a><span>, in §4.2</span>
   <li><a href="#dom-urlsearchparams-getall">getAll(name)</a><span>, in §6.4</span>
   <li><a href="#dom-urlsearchparams-get">get(name)</a><span>, in §6.4</span>
   <li><a href="#dom-url-hash">hash</a><span>, in §6.3</span>
   <li><a href="#dom-urlsearchparams-has">has(name)</a><span>, in §6.4</span>
   <li>
    host
    <ul>
     <li><a href="#concept-host">dfn for host</a><span>, in §3</span>
     <li><a href="#syntax-host">dfn for hostsyntax</a><span>, in §3.2</span>
     <li><a href="#concept-url-host">dfn for url</a><span>, in §4</span>
     <li><a href="#dom-url-host">attribute for URL</a><span>, in §6.3</span>
    </ul>
   <li><a href="#dom-url-hostname">hostname</a><span>, in §6.3</span>
   <li><a href="#hostname-state">hostname state</a><span>, in §4.2</span>
   <li><a href="#concept-host-parser">host parser</a><span>, in §3.3</span>
   <li><a href="#concept-host-serializer">host serializer</a><span>, in §3.4</span>
   <li><a href="#host-state">host state</a><span>, in §4.2</span>
   <li><a href="#dom-url-href">href</a><span>, in §6.3</span>
   <li><a href="#http-scheme">HTTP(S) scheme</a><span>, in §4</span>
   <li><a href="#include-credentials">include credentials</a><span>, in §4</span>
   <li>
    IPv4 address
    <ul>
     <li><a href="#concept-ipv4">dfn for host</a><span>, in §3</span>
     <li><a href="#syntax-host-ipv4">dfn for hostsyntax</a><span>, in §3.2</span>
    </ul>
   <li><a href="#ipv4-number-parser">IPv4 number parser</a><span>, in §3.3</span>
   <li><a href="#concept-ipv4-parser">IPv4 parser</a><span>, in §3.3</span>
   <li><a href="#concept-ipv4-serializer">IPv4 serializer</a><span>, in §3.4</span>
   <li>
    IPv6 address
    <ul>
     <li><a href="#concept-ipv6">dfn for host</a><span>, in §3</span>
     <li><a href="#syntax-host-ipv6">dfn for hostsyntax</a><span>, in §3.2</span>
    </ul>
   <li><a href="#concept-ipv6-parser">IPv6 parser</a><span>, in §3.3</span>
   <li><a href="#concept-ipv6-parser-finale">IPv6 parser Finale</a><span>, in §3.3</span>
   <li><a href="#concept-ipv6-parser-ipv4">IPv6 parser IPv4</a><span>, in §3.3</span>
   <li><a href="#concept-ipv6-parser-main">IPv6 parser Main</a><span>, in §3.3</span>
   <li><a href="#concept-ipv6-piece">IPv6 piece</a><span>, in §3</span>
   <li><a href="#concept-ipv6-serializer">IPv6 serializer</a><span>, in §3.4</span>
   <li><a href="#is-local">is local</a><span>, in §4</span>
   <li><a href="#is-special">is special</a><span>, in §4</span>
   <li><a href="#concept-urlsearchparams-list">list</a><span>, in §6.4</span>
   <li><a href="#local-scheme">local scheme</a><span>, in §4</span>
   <li><a href="#network-scheme">network scheme</a><span>, in §4</span>
   <li><a href="#concept-urlsearchparams-new">new</a><span>, in §6.4</span>
   <li><a href="#normalized-windows-drive-letter">normalized Windows drive letter</a><span>, in §1</span>
   <li><a href="#no-scheme-state">no scheme state</a><span>, in §4.2</span>
   <li><a href="#concept-url-object">object</a><span>, in §4</span>
   <li>
    origin
    <ul>
     <li><a href="#concept-url-origin">dfn for url</a><span>, in §4.5</span>
     <li><a href="#dom-url-origin">attribute for URL</a><span>, in §6.3</span>
    </ul>
   <li>
    password
    <ul>
     <li><a href="#concept-url-password">dfn for url</a><span>, in §4</span>
     <li><a href="#dom-url-password">attribute for URL</a><span>, in §6.3</span>
    </ul>
   <li><a href="#concept-url-path">path</a><span>, in §4</span>
   <li><a href="#syntax-url-file-path-absolute">path-absolute non-Windows-file URL</a><span>, in §4.1</span>
   <li><a href="#syntax-url-path-absolute">path-absolute URL</a><span>, in §4.1</span>
   <li><a href="#dom-url-pathname">pathname</a><span>, in §6.3</span>
   <li><a href="#path-or-authority-state">path or authority state</a><span>, in §4.2</span>
   <li><a href="#syntax-url-path-relative-scheme-less">path-relative scheme-less URL</a><span>, in §4.1</span>
   <li><a href="#syntax-url-path-relative">path-relative URL</a><span>, in §4.1</span>
   <li><a href="#syntax-url-path-segment">path segment</a><span>, in §4.1</span>
   <li><a href="#path-start-state">path start state</a><span>, in §4.2</span>
   <li><a href="#path-state">path state</a><span>, in §4.2</span>
   <li><a href="#percent-decode">percent decode</a><span>, in §1.2</span>
   <li><a href="#percent-encode">percent encode</a><span>, in §1.2</span>
   <li><a href="#percent-encoded-byte">percent-encoded byte</a><span>, in §1.2</span>
   <li><a href="#pop-a-urls-path">pop</a><span>, in §4</span>
   <li><a href="#pop-a-urls-path">pop a url’s path</a><span>, in §4</span>
   <li>
    port
    <ul>
     <li><a href="#concept-url-port">dfn for url</a><span>, in §4</span>
     <li><a href="#syntax-url-port">dfn for urlsyntax</a><span>, in §4.1</span>
     <li><a href="#dom-url-port">attribute for URL</a><span>, in §6.3</span>
    </ul>
   <li><a href="#port-state">port state</a><span>, in §4.2</span>
   <li><a href="#dom-url-protocol">protocol</a><span>, in §6.3</span>
   <li>
    query
    <ul>
     <li><a href="#concept-url-query">dfn for url</a><span>, in §4</span>
     <li><a href="#syntax-url-query">dfn for urlsyntax</a><span>, in §4.1</span>
    </ul>
   <li><a href="#concept-url-query-object">query object</a><span>, in §6</span>
   <li><a href="#query-state">query state</a><span>, in §4.2</span>
   <li><a href="#relative-slash-state">relative slash state</a><span>, in §4.2</span>
   <li><a href="#relative-state">relative state</a><span>, in §4.2</span>
   <li><a href="#syntax-url-relative">relative URL</a><span>, in §4.1</span>
   <li><a href="#syntax-url-relative-with-fragment">relative URL with fragment</a><span>, in §4.1</span>
   <li><a href="#remaining">remaining</a><span>, in §1.1</span>
   <li>
    scheme
    <ul>
     <li><a href="#concept-url-scheme">dfn for url</a><span>, in §4</span>
     <li><a href="#syntax-url-scheme">dfn for urlsyntax</a><span>, in §4.1</span>
    </ul>
   <li><a href="#syntax-url-file-scheme-relative">scheme-relative file URL</a><span>, in §4.1</span>
   <li><a href="#syntax-url-scheme-relative">scheme-relative URL</a><span>, in §4.1</span>
   <li><a href="#scheme-start-state">scheme start state</a><span>, in §4.2</span>
   <li><a href="#scheme-state">scheme state</a><span>, in §4.2</span>
   <li><a href="#dom-url-search">search</a><span>, in §6.3</span>
   <li><a href="#dom-url-searchparams">searchParams</a><span>, in §6.3</span>
   <li><a href="#serialize-an-integer">serialize an integer</a><span>, in §1</span>
   <li><a href="#dom-urlsearchparams-set">set(name, value)</a><span>, in §6.4</span>
   <li><a href="#set-the-password">set the password</a><span>, in §4.2</span>
   <li><a href="#set-the-username">set the username</a><span>, in §4.2</span>
   <li><a href="#simple-encode-set">simple encode set</a><span>, in §1.2</span>
   <li><a href="#syntax-url-path-segment-dot">single-dot path segment</a><span>, in §4.1</span>
   <li><a href="#special-authority-ignore-slashes-state">special authority ignore slashes state</a><span>, in §4.2</span>
   <li><a href="#special-authority-slashes-state">special authority slashes state</a><span>, in §4.2</span>
   <li><a href="#special-relative-or-authority-state">special relative or authority state</a><span>, in §4.2</span>
   <li><a href="#special-scheme">special scheme</a><span>, in §4</span>
   <li>
    stringification behavior
    <ul>
     <li><a href="#URL-stringification-behavior">dfn for URL</a><span>, in §6</span>
     <li><a href="#urlsearchparams-stringification-behavior">dfn for URLSearchParams</a><span>, in §6.4</span>
    </ul>
   <li><a href="#syntax-violation">syntax violation</a><span>, in §1.1</span>
   <li><a href="#tab-and-newline">tab and newline</a><span>, in §1</span>
   <li><a href="#concept-urlsearchparams-update">update steps</a><span>, in §6.4</span>
   <li>
    URL
    <ul>
     <li><a href="#concept-url">dfn for url</a><span>, in §4</span>
     <li><a href="#syntax-url">dfn for urlsyntax</a><span>, in §4.1</span>
     <li><a href="#url">(interface)</a><span>, in §6</span>
    </ul>
   <li><a href="#concept-url-url">url</a><span>, in §6</span>
   <li><a href="#url-code-points">URL code points</a><span>, in §4.1</span>
   <li><a href="#concept-urlencoded-byte-serializer">urlencoded byte serializer</a><span>, in §5.2</span>
   <li><a href="#concept-urlencoded-parser">urlencoded parser</a><span>, in §5.1</span>
   <li><a href="#concept-urlencoded-serializer">urlencoded serializer</a><span>, in §5.2</span>
   <li><a href="#concept-urlencoded-string-parser">urlencoded string parser</a><span>, in §5.3</span>
   <li><a href="#concept-urlsearchparams-url-object">url object</a><span>, in §6.4</span>
   <li><a href="#concept-url-parser">URL parser</a><span>, in §4.2</span>
   <li><a href="#concept-url">URL record</a><span>, in §4</span>
   <li><a href="#urlsearchparams">URLSearchParams</a><span>, in §6.4</span>
   <li><a href="#dom-urlsearchparams-urlsearchparams">URLSearchParams(init)</a><span>, in §6.4</span>
   <li><a href="#concept-url-serializer">URL serializer</a><span>, in §4.3</span>
   <li><a href="#syntax-url">URL string</a><span>, in §4.1</span>
   <li><a href="#url-units">URL units</a><span>, in §4.1</span>
   <li><a href="#dom-url-url">URL(url, base)</a><span>, in §6.1</span>
   <li><a href="#userinfo-encode-set">userinfo encode set</a><span>, in §1.2</span>
   <li>
    username
    <ul>
     <li><a href="#concept-url-username">dfn for url</a><span>, in §4</span>
     <li><a href="#dom-url-username">attribute for URL</a><span>, in §6.3</span>
    </ul>
   <li><a href="#utf-8-percent-encode">UTF-8 percent encode</a><span>, in §1.2</span>
   <li><a href="#valid-domain">valid domain</a><span>, in §3.2</span>
   <li><a href="#windows-drive-letter">Windows drive letter</a><span>, in §1</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><a href="https://dom.spec.whatwg.org/#ascii-case-insensitive">ascii case-insensitive</a>
     <li><a href="https://dom.spec.whatwg.org/#context-object">context object</a>
    </ul>
   <li>
    <a data-link-type="biblio">[FILEAPI]</a> defines the following terms:
    <ul>
     <li><a href="https://w3c.github.io/FileAPI/#dfn-Blob">Blob</a>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/comms.html#eventsource">EventSource</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#hashchangeevent">HashChangeEvent</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque">opaque origin</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin">same origin</a>
     <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#structured-clone">structuredclone</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#unicode-serialisation-of-an-origin">unicode serialization of an origin</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-bidi">[BIDI]
   <dd>Mark Davis; Aharon Lanin; Andrew Glass. <a href="http://www.unicode.org/reports/tr9/">Unicode Bidirectional Algorithm</a>. 5 June 2014. Unicode Standard Annex #9. URL: <a href="http://www.unicode.org/reports/tr9/">http://www.unicode.org/reports/tr9/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-encoding">[ENCODING]
   <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/">Encoding Standard</a>. Living Standard. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
   <dt id="biblio-fileapi">[FILEAPI]
   <dd>Arun Ranganathan; Jonas Sicking. <a href="https://w3c.github.io/FileAPI/">File API</a>. 21 April 2015. WD. URL: <a href="https://w3c.github.io/FileAPI/">https://w3c.github.io/FileAPI/</a>
   <dt id="biblio-html">[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-iana-uri-schemes">[IANA-URI-SCHEMES]
   <dd><a href="http://www.iana.org/assignments/uri-schemes/uri-schemes.xhtml">Uniform Resource Identifier (URI) Schemes</a>. URL: <a href="http://www.iana.org/assignments/uri-schemes/uri-schemes.xhtml">http://www.iana.org/assignments/uri-schemes/uri-schemes.xhtml</a>
   <dt id="biblio-idna">[IDNA]
   <dd>Mark Davis; Michel Suignard. <a href="http://www.unicode.org/reports/tr46/">Unicode IDNA Compatibility Processing</a>. URL: <a href="http://www.unicode.org/reports/tr46/">http://www.unicode.org/reports/tr46/</a>
   <dt id="biblio-media-source">[MEDIA-SOURCE]
   <dd>Matthew Wolenetz; et al. <a href="https://w3c.github.io/media-source/">Media Source Extensions</a>. 5 July 2016. CR. URL: <a href="https://w3c.github.io/media-source/">https://w3c.github.io/media-source/</a>
   <dt id="biblio-mediacapture-streams">[MEDIACAPTURE-STREAMS]
   <dd>Daniel Burnett; et al. <a href="https://w3c.github.io/mediacapture-main/">Media Capture and Streams</a>. 19 May 2016. CR. URL: <a href="https://w3c.github.io/mediacapture-main/">https://w3c.github.io/mediacapture-main/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc4291">[RFC4291]
   <dd>R. Hinden; S. Deering. <a href="https://tools.ietf.org/html/rfc4291">IP Version 6 Addressing Architecture</a>. February 2006. Draft Standard. URL: <a href="https://tools.ietf.org/html/rfc4291">https://tools.ietf.org/html/rfc4291</a>
   <dt id="biblio-uts36">[UTS36]
   <dd>Mark Davis; Michel Suignard. <a href="http://unicode.org/reports/tr36/">Unicode Security Considerations</a>. URL: <a href="http://unicode.org/reports/tr36/">http://unicode.org/reports/tr36/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Cameron McCormack; Boris Zbarsky. <a href="https://heycam.github.io/webidl/">WebIDL Level 1</a>. 8 March 2016. CR. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-referrer-policy">[REFERRER-POLICY]
   <dd>Jochen Eisinger; Mike West. <a href="https://w3c.github.io/webappsec/specs/referrer-policy/">Referrer Policy</a>. 1 June 2016. WD. URL: <a href="https://w3c.github.io/webappsec/specs/referrer-policy/">https://w3c.github.io/webappsec/specs/referrer-policy/</a>
   <dt id="biblio-rfc1034">[RFC1034]
   <dd>P.V. Mockapetris. <a href="https://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>. November 1987. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc1034">https://tools.ietf.org/html/rfc1034</a>
   <dt id="biblio-rfc3986">[RFC3986]
   <dd>T. Berners-Lee; R. Fielding; L. Masinter. <a href="https://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>. January 2005. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc3986">https://tools.ietf.org/html/rfc3986</a>
   <dt id="biblio-rfc3987">[RFC3987]
   <dd>M. Duerst; M. Suignard. <a href="https://tools.ietf.org/html/rfc3987">Internationalized Resource Identifiers (IRIs)</a>. January 2005. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc3987">https://tools.ietf.org/html/rfc3987</a>
   <dt id="biblio-rfc5952">[RFC5952]
   <dd>S. Kawamura; M. Kawashima. <a href="https://tools.ietf.org/html/rfc5952">A Recommendation for IPv6 Address Text Representation</a>. August 2010. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc5952">https://tools.ietf.org/html/rfc5952</a>
   <dt id="biblio-rfc6454">[RFC6454]
   <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
   <dt id="biblio-rfc7595">[RFC7595]
   <dd>D. Thaler, Ed.; T. Hansen; T. Hardie. <a href="https://tools.ietf.org/html/rfc7595">Guidelines and Registration Procedures for URI Schemes</a>. June 2015. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc7595">https://tools.ietf.org/html/rfc7595</a>
   <dt id="biblio-rfc791">[RFC791]
   <dd>J. Postel. <a href="https://tools.ietf.org/html/rfc791">Internet Protocol</a>. September 1981. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc791">https://tools.ietf.org/html/rfc791</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl def">[<a class="nv idl-code" data-link-type="constructor" href="#dom-url-url">Constructor</a>(<span class="kt">USVString</span> <a class="nv" href="#dom-url-url-url-base-url">url</a>, <span class="kt">optional</span> <span class="kt">USVString</span> <a class="nv" href="#dom-url-url-url-base-base">base</a>),
 <a class="nv idl-code" data-link-type="extended-attribute">Exposed</a>=(<span class="n">Window</span>,<span class="n">Worker</span>)]
<span class="kt">interface</span> <a class="nv" href="#url">URL</a> {
  <span class="kt">static</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="method" href="#dom-url-domaintoascii">domainToASCII</a>(<span class="kt">USVString</span> <a class="nv" href="#dom-url-domaintoascii-domain-domain">domain</a>);
  <span class="kt">static</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="method" href="#dom-url-domaintounicode">domainToUnicode</a>(<span class="kt">USVString</span> <a class="nv" href="#dom-url-domaintounicode-domain-domain">domain</a>);

  <a class="kt" href="#URL-stringification-behavior">stringifier</a> <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-href">href</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="USVString" href="#dom-url-origin">origin</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-protocol">protocol</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-username">username</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-password">password</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-host">host</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-hostname">hostname</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-port">port</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-pathname">pathname</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-search">search</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#urlsearchparams">URLSearchParams</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="URLSearchParams" href="#dom-url-searchparams">searchParams</a>;
           <span class="kt">attribute</span> <span class="kt">USVString</span> <a class="nv idl-code" data-link-type="attribute" data-type="USVString" href="#dom-url-hash">hash</a>;
};

[<a class="nv idl-code" data-link-type="constructor" href="#dom-urlsearchparams-urlsearchparams">Constructor</a>(<span class="kt">optional</span> (<span class="kt">USVString</span> <span class="kt">or</span> <a class="n" data-link-type="idl-name" href="#urlsearchparams">URLSearchParams</a>) <a class="nv" href="#dom-urlsearchparams-urlsearchparams-init-init">init</a> = ""),
 <a class="nv idl-code" data-link-type="extended-attribute">Exposed</a>=(<span class="n">Window</span>,<span class="n">Worker</span>)]
<span class="kt">interface</span> <a class="nv" href="#urlsearchparams">URLSearchParams</a> {
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-urlsearchparams-append">append</a>(<span class="kt">USVString</span> <a class="nv" href="#dom-urlsearchparams-append-name-value-name">name</a>, <span class="kt">USVString</span> <a class="nv" href="#dom-urlsearchparams-append-name-value-value">value</a>);
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-urlsearchparams-delete">delete</a>(<span class="kt">USVString</span> <a class="nv" href="#dom-urlsearchparams-delete-name-name">name</a>);
  <span class="kt">USVString</span>? <a class="nv idl-code" data-link-type="method" href="#dom-urlsearchparams-get">get</a>(<span class="kt">USVString</span> <a class="nv" href="#dom-urlsearchparams-get-name-name">name</a>);
  <span class="kt">sequence</span>&lt;<span class="kt">USVString</span>> <a class="nv idl-code" data-link-type="method" href="#dom-urlsearchparams-getall">getAll</a>(<span class="kt">USVString</span> <a class="nv" href="#dom-urlsearchparams-getall-name-name">name</a>);
  <span class="kt">boolean</span> <a class="nv idl-code" data-link-type="method" href="#dom-urlsearchparams-has">has</a>(<span class="kt">USVString</span> <a class="nv" href="#dom-urlsearchparams-has-name-name">name</a>);
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-urlsearchparams-set">set</a>(<span class="kt">USVString</span> <a class="nv" href="#dom-urlsearchparams-set-name-value-name">name</a>, <span class="kt">USVString</span> <a class="nv" href="#dom-urlsearchparams-set-name-value-value">value</a>);
  <span class="kt">iterable</span>&lt;<span class="kt">USVString</span>, <span class="kt">USVString</span>>;
  <a class="kt" data-link-type="dfn" href="#urlsearchparams-stringification-behavior">stringifier</a>;
};

</pre>
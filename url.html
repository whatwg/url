<!doctype html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  
  
  <title>URL Standard</title>
  
  
  <link href="https://www.whatwg.org/style/specification" rel="stylesheet">
  
  
  <link href="https://resources.whatwg.org/bikeshed.css" rel="stylesheet">
  
  
  <link href="https://resources.whatwg.org/logo-url.svg" rel="icon">
  

  <meta content="Bikeshed 1.0.0" name="generator">
 </head>
 <body class="h-entry status-LS">

  <div class="head">
  
   <p data-fill-with="logo"><a class="logo" href="https://whatwg.org/">
    <img alt="WHATWG" height="100" src="https://resources.whatwg.org/logo-url.svg">
</a>
</p>
  
   <h1 class="p-name no-ref allcaps" id="title">URL</h1>
  
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Living Standard — Last Updated
    <time class="dt-updated" datetime="2015-07-11">11 July 2015</time></span></h2>
  
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>Participate:
     <dd><span><a href="https://github.com/whatwg/url">GitHub whatwg/url</a> (<a href="https://github.com/whatwg/url/issues/new">new issue</a>, <a href="https://github.com/whatwg/url/issues">open issues</a>, <a href="https://www.w3.org/Bugs/Public/buglist.cgi?product=WHATWG&amp;component=URL&amp;resolution=---">legacy open bugs</a>)</span>
     <dd><span><a href="https://wiki.whatwg.org/wiki/IRC">IRC: #whatwg on Freenode</a></span>
     <dt>Commits:
     <dd><span><a href="https://github.com/whatwg/url/commits">https://github.com/whatwg/url/commits</a></span>
     <dd><span><a href="https://twitter.com/urlstandard">@urlstandard</a></span>
    </dl>
   </div>
  
   <div data-fill-with="warning"></div>
</div>
  


  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  

  <div class="p-summary" data-fill-with="abstract">
   <p>The URL Standard defines URLs, domains, IP addresses, the <code title="">application/x-www-form-urlencoded</code> format, and their API.</p>

</div>
  

  <div data-fill-with="at-risk"></div>
  


  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>
  

  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li><a href="#goals"><span class="secno"></span> <span class="content">Goals</span></a>
    <li><a href="#terminology"><span class="secno">1</span> <span class="content">Terminology</span></a>
     <ul class="toc">
      <li><a href="#parsers"><span class="secno">1.1</span> <span class="content">Parsers</span></a>
     </ul>
    <li><a href="#percent-encoded-bytes"><span class="secno">2</span> <span class="content">Percent-encoded bytes</span></a>
    <li><a href="#hosts-(domains-and-ip-addresses)"><span class="secno">3</span> <span class="content">Hosts (domains and IP addresses)</span></a>
     <ul class="toc">
      <li><a href="#idna"><span class="secno">3.1</span> <span class="content">IDNA</span></a>
      <li><a href="#host-writing"><span class="secno">3.2</span> <span class="content">Host writing</span></a>
      <li><a href="#host-parsing"><span class="secno">3.3</span> <span class="content">Host parsing</span></a>
      <li><a href="#host-serializing"><span class="secno">3.4</span> <span class="content">Host serializing</span></a>
     </ul>
    <li><a href="#urls"><span class="secno">4</span> <span class="content">URLs</span></a>
     <ul class="toc">
      <li><a href="#url-writing"><span class="secno">4.1</span> <span class="content">URL writing</span></a>
      <li><a href="#url-parsing"><span class="secno">4.2</span> <span class="content">URL parsing</span></a>
      <li><a href="#url-serializing"><span class="secno">4.3</span> <span class="content">URL serializing</span></a>
      <li><a href="#origin"><span class="secno">4.4</span> <span class="content">Origin</span></a>
     </ul>
    <li><a href="#application/x-www-form-urlencoded"><span class="secno">5</span> <span class="content"><code data-lt="application-x-www-form-urlencoded-0"><span>application/x-www-form-urlencoded</span></code></span></a>
     <ul class="toc">
      <li><a href="#urlencoded-parsing"><span class="secno">5.1</span> <span class="content"><code data-lt="application-x-www-form-urlencoded-0">application/x-www-form-urlencoded</code> parsing</span></a>
      <li><a href="#urlencoded-serializing"><span class="secno">5.2</span> <span class="content"><code data-lt="application-x-www-form-urlencoded-0">application/x-www-form-urlencoded</code> serializing</span></a>
      <li><a href="#urlencoded-hooks"><span class="secno">5.3</span> <span class="content">Hooks</span></a>
     </ul>
    <li><a href="#api"><span class="secno">6</span> <span class="content">API</span></a>
     <ul class="toc">
      <li><a href="#constructors"><span class="secno">6.1</span> <span class="content">Constructors</span></a>
      <li><a href="#url-statics"><span class="secno">6.2</span> <span class="content"><code class="idl"><span>URL</span></code> statics</span></a>
      <li><a href="#urlutils-and-urlutilsreadonly-members"><span class="secno">6.3</span> <span class="content"><code class="idl"><span>URLUtils</span></code>/<code class="idl"><span>URLUtilsSearchParams</span></code> and <code class="idl"><span>URLUtilsReadOnly</span></code> members</span></a>
      <li><a href="#interface-urlsearchparams"><span class="secno">6.4</span> <span class="content">Interface <code><span>URLSearchParams</span></code></span></a>
      <li><a href="#url-apis-elsewhere"><span class="secno">6.5</span> <span class="content">URL APIs elsewhere</span></a>
     </ul>
    <li><a href="#acknowledgments"><span class="secno"></span> <span class="content">Acknowledgments</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
    <li><a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ul class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ul>
    <li><a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ul>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ul></div>
  

  <main>



   <script async="" src="https://resources.whatwg.org/file-issue.js"></script>

   <script defer="" id="head" src="https://resources.whatwg.org/dfn.js"></script>



   <h2 class="no-num heading settled" id="goals"><span class="content">Goals</span></h2>


   <p>The URL standard takes the following approach towards making URLs fully interoperable:

</p>
   <ul>
 
    <li>
     <p>Align RFC 3986 and RFC 3987 with contemporary implementations and
 obsolete them in the process. (E.g. spaces, other "illegal" code points,
 query encoding, equality, canonicalization, are all concepts not entirely
 shared, or defined.) URL parsing needs to become as solid as HTML parsing.
 <a data-link-type="biblio" href="#biblio-rfc3986">[RFC3986]</a>
 <a data-link-type="biblio" href="#biblio-rfc3987">[RFC3987]</a>

 </p>
    <li>
     <p>Standardize on the term URL. URI and IRI are just confusing. In
 practice a single algorithm is used for both so keeping them distinct is
 not helping anyone. URL also easily wins the
 <a href="http://www.googlefight.com/index.php?word1=url&amp;word2=uri">search result popularity contest</a>.

 </p>
    <li>
     <p>Supplanting <a href="https://tools.ietf.org/html/rfc6454#section-4">Origin of a URI [sic]</a>.
 <a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a>

 </p>
    <li>
     <p>Define URL’s existing JavaScript API in full detail and add
 enhancements to make it easier to work with. Add a new <code><a class="idl-code" data-link-type="interface" href="#url">URL</a></code>
 object as well for URL manipulation without usage of HTML elements. (Useful
 for JavaScript worker environments.)
</p></ul>


   <p class="note" role="note">As the editors learn more about the subject matter the goals
might increase in scope somewhat.



</p>
   <h2 class="heading settled" data-level="1" id="terminology"><span class="secno">1. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h2>


   <p>Some terms used in this specification are defined in the
DOM, Encoding, IDNA, and Web IDL Standards.
<a data-link-type="biblio" href="#biblio-dom">[DOM]</a>
<a data-link-type="biblio" href="#biblio-encoding">[ENCODING]</a>
<a data-link-type="biblio" href="#biblio-idna">[IDNA]</a>
<a data-link-type="biblio" href="#biblio-webidl">[WEBIDL]</a>

</p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="c0-controls">C0 controls<a class="self-link" href="#c0-controls"></a></dfn> are code points in the range U+0000 to U+001F, inclusive.

</p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="c0-controls-and-space">C0 controls and space<a class="self-link" href="#c0-controls-and-space"></a></dfn> are <a data-link-type="dfn" href="#c0-controls">C0 controls</a> and code point U+0020.

</p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="ascii-digits">ASCII digits<a class="self-link" href="#ascii-digits"></a></dfn> are code points in the range U+0030 to U+0039, inclusive.


</p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="ascii-hex-digits">ASCII hex digits<a class="self-link" href="#ascii-hex-digits"></a></dfn> are <a data-link-type="dfn" href="#ascii-digits">ASCII digits</a>, code points in the range
U+0041 to U+0046, inclusive, and code points in the range U+0061 to U+0066, inclusive.

</p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="ascii-alpha">ASCII alpha<a class="self-link" href="#ascii-alpha"></a></dfn> are code points in the range U+0041 to U+005A, inclusive,
and in the range U+0061 to U+007A, inclusive.

</p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="ascii-alphanumeric">ASCII alphanumeric<a class="self-link" href="#ascii-alphanumeric"></a></dfn> are <a data-link-type="dfn" href="#ascii-digits">ASCII digits</a> and <a data-link-type="dfn" href="#ascii-alpha">ASCII alpha</a>.

</p>
   <p>An <dfn data-dfn-type="dfn" data-noexport="" id="ascii-string">ASCII string<a class="self-link" href="#ascii-string"></a></dfn> is a <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#string">string</a> in the range U+0000 to U+007F, inclusive.


</p>
   <h3 class="heading settled" data-level="1.1" id="parsers"><span class="secno">1.1. </span><span class="content">Parsers</span><a class="self-link" href="#parsers"></a></h3>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="eof-code-point">EOF code point<a class="self-link" href="#eof-code-point"></a></dfn> is a conceptual code point that signifies the end of a
string or code point stream.

</p>
   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="parse-error">parse error<a class="self-link" href="#parse-error"></a></dfn> indicates a non-fatal mismatch between input and requirements.
User agents are encouraged to expose <a data-link-type="dfn" href="#parse-error">parse errors</a>
somehow.

</p>
   <p>Within a parser algorithm that uses a <var>pointer</var> variable, <dfn data-dfn-type="dfn" data-noexport="" id="c">c<a class="self-link" href="#c"></a></dfn>
references the code point the <var>pointer</var> variable points to.

</p>
   <p>Within a string-based parser algorithm that uses a <var>pointer</var> variable,
<dfn data-dfn-type="dfn" data-noexport="" id="remaining">remaining<a class="self-link" href="#remaining"></a></dfn> references the substring after <var>pointer</var> in the string
being processed.

</p>
   <p class="example" id="example-12672b6a"><a class="self-link" href="#example-12672b6a"></a>If "<code>mailto:username@example</code>" is a string being
processed and <var>pointer</var> points to "<code>@</code>",
<a data-link-type="dfn" href="#c">c</a> is "<code>@</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> is
"<code>example</code>".



</p>
   <h2 class="heading settled" data-level="2" id="percent-encoded-bytes"><span class="secno">2. </span><span class="content">Percent-encoded bytes</span><a class="self-link" href="#percent-encoded-bytes"></a></h2>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="percent_encoded-byte">percent-encoded byte<a class="self-link" href="#percent_encoded-byte"></a></dfn> is "<code>%</code>", followed by
two <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digits</a>. Sequences of
<a data-link-type="dfn" href="#percent_encoded-byte">percent-encoded bytes</a>, after
conversion to bytes, should not cause a
<a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decoder">utf-8 decoder</a> to run into any
<a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#error">errors</a>.

</p>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="percent-encode">percent encode<a class="self-link" href="#percent-encode"></a></dfn> a <var>byte</var> into a
<a data-link-type="dfn" href="#percent_encoded-byte">percent-encoded byte</a>, return a string consisting of
"<code>%</code>", followed by a double-digit, uppercase, hexadecimal
representation of <var>byte</var>.

</p>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="percent-decode">percent decode<a class="self-link" href="#percent-decode"></a></dfn> a byte sequence <var>input</var>, run these steps:

</p>
   <p class="warning">Using anything but a <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decoder">utf-8 decoder</a>
when the <var>input</var> contains bytes outside the range 0x00 to 0x7F might be
insecure and is not recommended.

</p>
   <ol>
 
    <li>
     <p>Let <var>output</var> be an empty byte sequence.

 </p>
    <li>
  
     <p>For each byte <var>byte</var> in <var>input</var>, run these steps:

  </p>
     <ol>
   
      <li>
       <p>If <var>byte</var> is not `<code>%</code>`, append
   <var>byte</var> to <var>output</var>.

   </p>
      <li>
       <p>Otherwise, if <var>byte</var> is `<code>%</code>` and the next two
   bytes after <var>byte</var> in <var>input</var> are not in the ranges
   0x30 to 0x39, 0x41 to 0x46, and 0x61 to 0x66, append <var>byte</var> to
   <var>output</var>.

   </p>
      <li>
    
       <p>Otherwise, run these substeps:

    </p>
       <ol>
     
        <li>
         <p>Let <var>bytePoint</var> be the two bytes after <var>byte</var> in
     <var>input</var>,
     <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decode-without-bom">decoded</a>, and
     then interpreted as hexadecimal number.
     

     </p>
        <li>
         <p>Append a byte whose value is <var>bytePoint</var> to
     <var>output</var>.

     </p>
        <li>
         <p>Skip the next two bytes in <var>input</var>.
    </p>
       </ol>
       
  
     </ol>
     

 
    <li>
     <p>Return <var>output</var>.
</p></ol>


   <p></p>

   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="simple-encode-set">simple encode set<a class="self-link" href="#simple-encode-set"></a></dfn> are <a data-link-type="dfn" href="#c0-controls">C0 controls</a> and all code points greater
than U+007E.

</p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="default-encode-set">default encode set<a class="self-link" href="#default-encode-set"></a></dfn> is the
<a data-link-type="dfn" href="#simple-encode-set">simple encode set</a> and code points U+0020,
'<code>"</code>', 
"<code>#</code>", 
"<code>&lt;</code>", 
"<code>></code>", 
"<code>?</code>", 
"<code>`</code>", 
"<code>{</code>", 
and
"<code>}</code>". 

</p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="password-encode-set">password encode set<a class="self-link" href="#password-encode-set"></a></dfn> is the
<a data-link-type="dfn" href="#default-encode-set">default encode set</a> and code points
"<code>/</code>", 
"<code>@</code>", 
and
"<code>\</code>". 

</p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="username-encode-set">username encode set<a class="self-link" href="#username-encode-set"></a></dfn> is the
<a data-link-type="dfn" href="#password-encode-set">password encode set</a> and code point
"<code>:</code>". 

</p>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="utf_8-percent-encode">utf-8 percent encode<a class="self-link" href="#utf_8-percent-encode"></a></dfn> a <var>code point</var>, using
an <var>encode set</var>, run these steps:

</p>
   <ol>
 
    <li>
     <p>If <var>code point</var> is not in
 <var>encode set</var>, return <var>code point</var>.

 </p>
    <li>
     <p>Let <var>bytes</var> be the result of running
 <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-encode">utf-8 encode</a> on
 <var>code point</var>.

 </p>
    <li>
     <p><a data-link-type="dfn" href="#percent-encode">Percent encode</a> each byte in <var>bytes</var>, and
 then return them concatenated, in the same order.
</p></ol>




   <h2 class="heading settled" data-level="3" id="hosts-(domains-and-ip-addresses)"><span class="secno">3. </span><span class="content">Hosts (domains and IP addresses)</span><a class="self-link" href="#hosts-%28domains-and-ip-addresses%29"></a></h2>




   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="concept-host">host<a class="self-link" href="#concept-host"></a></dfn> is a network address in the form of a
<a data-link-type="dfn" href="#concept-domain">domain</a>, an <a data-link-type="dfn" href="#concept-ipv4">IPv4 address</a>, or an <a data-link-type="dfn" href="#concept-ipv6">IPv6 address</a>.

</p>
   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="concept-domain">domain<a class="self-link" href="#concept-domain"></a></dfn> identifies a realm within a network.

</p>
   <p>An <dfn data-dfn-type="dfn" data-noexport="" id="concept-ipv4">IPV4 address<a class="self-link" href="#concept-ipv4"></a></dfn> is a 32-bit identifier.

</p>
   <p>An <dfn data-dfn-type="dfn" data-noexport="" id="concept-ipv6">IPv6 address<a class="self-link" href="#concept-ipv6"></a></dfn> is a 128-bit identifier and
for the purposes of this specification represented as an ordered list of
eight <dfn data-dfn-type="dfn" data-lt="IPv6 piece" data-noexport="" id="concept-ipv6-piece">16-bit pieces<a class="self-link" href="#concept-ipv6-piece"></a></dfn>.
<a data-link-type="biblio" href="#biblio-rfc4291">[RFC4291]</a>


</p>
   <h3 class="heading settled" data-level="3.1" id="idna"><span class="secno">3.1. </span><span class="content">IDNA</span><a class="self-link" href="#idna"></a></h3>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-domain-to-ascii">domain to ASCII<a class="self-link" href="#concept-domain-to-ascii"></a></dfn> given a
<a data-link-type="dfn" href="#concept-domain">domain</a> <var>domain</var>, runs these steps:

</p>
   <ol>
 
    <li>
     <p>Let <var>result</var> be the result of running
 <a data-link-type="dfn" href="http://www.unicode.org/reports/tr46/#ToASCII">Unicode ToASCII</a> with
 <i>domain_name</i> set to <var>domain</var>,
 <i>UseSTD3ASCIIRules</i> set to false, <i>processing_option</i> set to
 <i>Transitional_Processing</i>, and <i>VerifyDnsLength</i> set to false.

 </p>
    <li>
     <p>If <var>result</var> is a failure value, return failure.

 </p>
    <li>
     <p>Return <var>result</var>.
</p></ol>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-domain-to-unicode">domain to Unicode<a class="self-link" href="#concept-domain-to-unicode"></a></dfn> given a
<a data-link-type="dfn" href="#concept-domain">domain</a> <var>domain</var>, runs these steps:

</p>
   <ol>
 
    <li>
     <p>Let <var>result</var> be the result of running
 <a data-link-type="dfn" href="http://www.unicode.org/reports/tr46/#ToUnicode">Unicode ToUnicode</a> with
 <i>domain_name</i> set to <var>domain</var>,
 <i>UseSTD3ASCIIRules</i> set to false.

 </p>
    <li>
  
     <p>Return <var>result</var>, ignoring any returned errors.

  </p>
     <p class="note" role="note">User agents are encouraged to report errors through a developer console.
</p></ol>



   <h3 class="heading settled" data-level="3.2" id="host-writing"><span class="secno">3.2. </span><span class="content">Host writing</span><a class="self-link" href="#host-writing"></a></h3>


   <p>A <a data-link-type="dfn" href="#concept-host">host</a> must be a <a data-link-type="dfn" href="#concept-domain">domain</a>, an <a data-link-type="dfn" href="#concept-ipv4">IPv4 address</a>, or
"<code>[</code>", followed by an <a data-link-type="dfn" href="#concept-ipv6">IPv6 address</a>, followed by "<code>]</code>".

</p>
   <p>A <var>domain</var> is a <dfn data-dfn-type="dfn" data-noexport="" id="valid-domain">valid domain<a class="self-link" href="#valid-domain"></a></dfn> if these steps return success:

</p>
   <ol>
 
    <li>
     <p>Let <var>result</var> be the result of running
 <a data-link-type="dfn" href="http://www.unicode.org/reports/tr46/#ToASCII">Unicode ToASCII</a> with
 <i>domain_name</i> set to <var>domain</var>,
 <i>UseSTD3ASCIIRules</i> set to true, <i>processing_option</i> set to
 <i>Nontransitional_Processing</i>, and <i>VerifyDnsLength</i> set to true.

 </p>
    <li>
     <p>If <var>result</var> is a failure value, return failure.

 </p>
    <li>
     <p>Set <var>result</var> to the result of running
 <a data-link-type="dfn" href="http://www.unicode.org/reports/tr46/#ToUnicode">Unicode ToUnicode</a> with
 <i>domain_name</i> set to <var>result</var>,
 <i>UseSTD3ASCIIRules</i> set to true.

 </p>
    <li>
     <p>If <var>result</var> contains any errors, return failure.

 </p>
    <li>
     <p>Return success.
</p></ol>


   <p class="XXX">Ideally we define this in terms of a sequence of code points that make up a
<a data-link-type="dfn" href="#valid-domain">valid domain</a> rather than through a whack-a-mole:
<a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=25334">bug 25334</a>.

</p>
   <p>A <a data-link-type="dfn" href="#concept-domain">domain</a> must be a string that is a <a data-link-type="dfn" href="#valid-domain">valid domain</a>.

</p>
   <p>An <a data-link-type="dfn" href="#concept-ipv4">IPv4 address</a> must be four sequences of up to three <span>ASCII digits</span>
per sequence, each representing a number no greater than 255, and separated from each
other by "<code>.</code>".

</p>
   <p>An <a data-link-type="dfn" href="#concept-ipv6">IPv6 address</a> is defined in the
<a href="https://tools.ietf.org/html/rfc4291#section-2.2">"Text Representation of Addresses" chapter of IP Version 6 Addressing Architecture</a>.
<a data-link-type="biblio" href="#biblio-rfc4291">[RFC4291]</a>
</p>



   <h3 class="heading settled" data-level="3.3" id="host-parsing"><span class="secno">3.3. </span><span class="content">Host parsing</span><a class="self-link" href="#host-parsing"></a></h3>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-host-parser">host parser<a class="self-link" href="#concept-host-parser"></a></dfn> takes a string <var>input</var> and
an optional <var>Unicode flag</var> (unset unless stated otherwise), and then runs these
steps:

</p>
   <ol>
 
    <li>
  
     <p>If <var>input</var> starts with "<code>[</code>", run these
  substeps:

  </p>
     <ol>
   
      <li>
       <p>If <var>input</var> does not end with
   "<code>]</code>", <a data-link-type="dfn" href="#parse-error">parse error</a>, return failure.

   </p>
      <li>
       <p>Return the result of
   <a data-link-type="dfn" href="#concept-ipv6-parser">IPv6 parsing</a> <var>input</var>
   with its leading "<code>[</code>" and trailing
   "<code>]</code>" removed.
  </p>
     </ol>
     

 
    <li>
     <p>Let <var>domain</var> be the result of
 <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decode-without-bom">utf-8 decode without BOM</a> on the
 <a data-link-type="dfn" href="#percent-decode">percent decoding</a> of
 <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-encode">utf-8 encode</a> on <var>input</var>.
 

 </p>
    <li>
     <p>Let <var>asciiDomain</var> be the result of running
 <a data-link-type="dfn" href="#concept-domain-to-ascii">domain to ASCII</a> on <var>domain</var>.

 </p>
    <li>
     <p>If <var>asciiDomain</var> is failure, return failure.

 </p>
    <li>
  
     <p>If <var>asciiDomain</var> contains one of
  U+0000,
  U+0009,
  U+000A,
  U+000D,
  U+0020,
  "<code>#</code>",
  "<code>%</code>",
  "<code>/</code>",
  "<code>:</code>",
  "<code>?</code>",
  "<code>@</code>",
  "<code>[</code>",
  "<code>\</code>",
  and
  "<code>]</code>",
  return failure.

 </p>
    <li>
     <p>Let <var>ipv4Host</var> be the result of <a data-link-type="dfn" href="#concept-ipv4-parser">IPv4 parsing</a>
 <var>asciiDomain</var>.

 </p>
    <li>
     <p>If <var>ipv4Host</var> is an <a data-link-type="dfn" href="#concept-ipv4">IPv4 address</a> or failure, return
 <var>ipv4Host</var>.

 </p>
    <li>
     <p>Return <var>asciiDomain</var> if the <var>Unicode flag</var> is unset, and the
 result of running <a data-link-type="dfn" href="#concept-domain-to-unicode">domain to Unicode</a> on <var>asciiDomain</var> otherwise.
</p></ol>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="ipv4-number-parser">IPv4 number parser<a class="self-link" href="#ipv4-number-parser"></a></dfn> takes a string <var>input</var> and then runs these
steps:</p>


   <ol>
 
    <li>
     <p>Let <var>R</var> be 10.

 </p>
    <li>
  
     <p>If <var>input</var> contains at least two code points and the first two code points
  are either "<code>0x</code>" or "<code>0X</code>", run these substeps:

  </p>
     <ol>
   
      <li>
       <p>Remove the first two code points from <var>input</var>.

   </p>
      <li>
       <p>Set <var>R</var> to 16.
  </p>
     </ol>
     

 
    <li>
  
     <p>Otherwise, if <var>input</var> contains at least one code point and the first code
  point is "<code>0</code>", run these substeps:

  </p>
     <ol>
   
      <li>
       <p>Remove the first code point from <var>input</var>.

   </p>
      <li>
       <p>Set <var>R</var> to 8.
  </p>
     </ol>
     

 
    <li>
     <p>If <var>input</var> contains a code point that is not a radix-<var>R</var> digit,
 return failure.
 

 </p>
    <li>
     <p>Return the mathematical integer value that is represented by <var>input</var> in
 radix-<var>R</var> notation, using <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digits</a> for digits with values 0
 through 15.
 
</p></ol>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-ipv4-parser">IPv4 parser<a class="self-link" href="#concept-ipv4-parser"></a></dfn> takes a string <var>input</var> and then
runs these steps:</p>


   <ol>
 
    <li>
     <p>Let <var>parts</var> be <var>input</var> split on "<code>.</code>".

 </p>
    <li>
     <p>If the last item in <var>parts</var> is the empty string, remove it from
 <var>parts</var>.

 </p>
    <li>
     <p>If <var>parts</var> has more than four items, return <var>input</var>.

 </p>
    <li>
     <p>Let <var>numbers</var> be the empty list.

 </p>
    <li>
  
     <p>For each <var>part</var> in <var>parts</var>:

  </p>
     <ol>
   
      <li>
       <p>Let <var>n</var> be the result of <a data-link-type="dfn" href="#ipv4-number-parser">parsing</a>
   <var>part</var>.

   </p>
      <li>
       <p>If <var>n</var> is failure, return <var>input</var>.

   </p>
      <li>
       <p>Append <var>n</var> to <var>numbers</var>.
  </p>
     </ol>
     

 
    <li>
     <p>If any but the last item in <var>numbers</var> is greater than 255, return
 failure.

 </p>
    <li>
     <p>If the last item in <var>numbers</var> is greater than or equal to
 256<sup>(5 − the number of items in <var>numbers</var>)</sup>, return failure.

 </p>
    <li>
     <p>Let <var>ipv4</var> be the last item in <var>numbers</var>.

 </p>
    <li>
     <p>Remove the last item from <var>numbers</var>.

 </p>
    <li>
     <p>Let <var>counter</var> be zero.

 </p>
    <li>
  
     <p>For each <var>n</var> in <var>numbers</var>:

  </p>
     <ol>
   
      <li>
       <p>Increment <var>ipv4</var> by <var>n</var> ×
   256<sup>(3 − <var>counter</var>)</sup>.

   </p>
      <li>
       <p>Increment <var>counter</var> by one.
  </p>
     </ol>
     

 
    <li>
     <p>Return <var>ipv4</var>.
</p></ol>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-ipv6-parser">IPv6 parser<a class="self-link" href="#concept-ipv6-parser"></a></dfn> takes a string <var>input</var> and
then runs these steps:

</p>
   <ol>
 
    <li>
     <p>Let <var>address</var> be a new
 <a data-link-type="dfn" href="#concept-ipv6">IPv6 address</a> with its
 <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit pieces</a> initialized to 0.

 </p>
    <li>
     <p>Let <var>piece pointer</var> be a pointer into
 <var>address</var>’s
 <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit pieces</a>, initially zero
 (pointing to the first <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit piece</a>),
 and let <var>piece</var> be the
 <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit piece</a> it points to.

 </p>
    <li>
     <p>Let <var>compress pointer</var> be another pointer into
 <var>address</var>’s <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit pieces</a>, initially
 null and pointing to nothing.

 </p>
    <li>
     <p>Let <var>pointer</var> be a pointer into
 <var>input</var>, initially zero (pointing to the first code point).

 </p>
    <li>
  
     <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>:</code>", run these substeps:

  </p>
     <ol>
   
      <li>
       <p>If <a data-link-type="dfn" href="#remaining">remaining</a> does not start with
   "<code>:</code>", <a data-link-type="dfn" href="#parse-error">parse error</a>, return failure.

   </p>
      <li>
       <p>Increase <var>pointer</var> by two.

   </p>
      <li>
       <p>Increase <var>piece pointer</var> by one and then set
   <var>compress pointer</var> to <var>piece pointer</var>.
  </p>
     </ol>
     

 
    <li>
  
     <p><dfn data-dfn-type="dfn" data-lt="IPv6 parser Main" data-noexport="" id="concept-ipv6-parser-main">Main<a class="self-link" href="#concept-ipv6-parser-main"></a></dfn>:
  While <a data-link-type="dfn" href="#c">c</a> is not the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, run these
  substeps:

  </p>
     <ol>
   
      <li>
       <p>If <var>piece pointer</var> is eight,
   <a data-link-type="dfn" href="#parse-error">parse error</a>, return failure.

   </p>
      <li>
    
       <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>:</code>", run these inner
    substeps:

    </p>
       <ol>
     
        <li>
         <p>If <var>compress pointer</var> is not null,
     <a data-link-type="dfn" href="#parse-error">parse error</a>, return failure.

     </p>
        <li>Increase <var>pointer</var> and <var>piece pointer</var> by one, set
     <var>compress pointer</var> to <var>piece pointer</var>,
     and then jump to <a data-link-type="dfn" href="#concept-ipv6-parser-main">Main</a>.
    
       </ol>
       

   
      <li>
       <p>Let <var>value</var> and <var>length</var> be 0.

   </p>
      <li>
       <p>While <var>length</var> is less than 4 and
   <a data-link-type="dfn" href="#c">c</a> is an
   <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digit</a>, set
   <var>value</var> to
   <var>value</var> × 0x10 + <a data-link-type="dfn" href="#c">c</a> interpreted as hexadecimal number,
   and increase <var>pointer</var> and <var>length</var> by one.

   </p>
      <li>
    
       <p>Based on <a data-link-type="dfn" href="#c">c</a>:

    </p>
       <dl class="switch">
     
        <dt>"<code>.</code>"
     
        <dd>
      
         <p>If <var>length</var> is 0, <a data-link-type="dfn" href="#parse-error">parse error</a>,
      return failure.
      </p>
         <p>Decrease <var>pointer</var> by <var>length</var>.
      </p>
         <p>Jump to <a data-link-type="dfn" href="#concept-ipv6-parser-ipv4">IPv4</a>.

     </p>
        <dt>"<code>:</code>"
     
        <dd>
      
         <p>Increase <var>pointer</var> by one.
      </p>
         <p>If <a data-link-type="dfn" href="#c">c</a> is the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>,
      <a data-link-type="dfn" href="#parse-error">parse error</a>, return failure.

     </p>
        <dt>Anything but the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>
     
        <dd>
         <p><a data-link-type="dfn" href="#parse-error">Parse error</a>, return failure.
    </p>
       </dl>
       

   
      <li>
       <p>Set <var>piece</var> to <var>value</var>.

   </p>
      <li>
       <p>Increase <var>piece pointer</var> by one.
  </p>
     </ol>
     

 
    <li>
     <p>If <a data-link-type="dfn" href="#c">c</a> is the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, jump to
 <a data-link-type="dfn" href="#concept-ipv6-parser-finale">Finale</a>.

 </p>
    <li>
     <p><dfn data-dfn-type="dfn" data-lt="IPv6 parser IPv4" data-noexport="" id="concept-ipv6-parser-ipv4">IPv4<a class="self-link" href="#concept-ipv6-parser-ipv4"></a></dfn>:
 If <var>piece pointer</var> is greater than six,
 <a data-link-type="dfn" href="#parse-error">parse error</a>, return failure.

 </p>
    <li>
     <p>Let <var>dots seen</var> be 0.

 </p>
    <li>
  
     <p>While <a data-link-type="dfn" href="#c">c</a> is not the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, run
  these substeps:

  </p>
     <ol>
   
      <li>
       <p>Let <var>value</var> be null.

   </p>
      <li>
       <p>If <a data-link-type="dfn" href="#c">c</a> is not an <a data-link-type="dfn" href="#ascii-digits">ASCII digit</a>,
   <a data-link-type="dfn" href="#parse-error">parse error</a>, return failure. 

   </p>
      <li>
    
       <p>While <a data-link-type="dfn" href="#c">c</a> is an
    <a data-link-type="dfn" href="#ascii-digits">ASCII digit</a>, run these subsubsteps:

    </p>
       <ol>
     
        <li>
         <p>Let <var>number</var> be <a data-link-type="dfn" href="#c">c</a> interpreted as decimal number.

     </p>
        <li>
      
         <p>If <var>value</var> is null, set <var>value</var> to <var>number</var>.

      </p>
         <p>Otherwise, if <var>value</var> is 0, <a data-link-type="dfn" href="#parse-error">parse error</a>, return failure.

      </p>
         <p>Otherwise, set <var>value</var> to <var>value</var> × 10 + <var>number</var>.

     </p>
        <li>
         <p>Increase <var>pointer</var> by one.

     </p>
        <li>
         <p>If <var>value</var> is greater than 255, <a data-link-type="dfn" href="#parse-error">parse error</a>,
     return failure.
    </p>
       </ol>
       

   
      <li>
       <p>If <var>dots seen</var> is less than 3 and
   <a data-link-type="dfn" href="#c">c</a> is not a "<code>.</code>",
   <a data-link-type="dfn" href="#parse-error">parse error</a>, return failure.

   </p>
      <li>
       <p>Set <var>piece</var> to
   <var>piece</var> × 0x100 + <var>value</var>.

   </p>
      <li>
       <p>If <var>dots seen</var> is 1 or 3, increase
   <var>piece pointer</var> by one.

   </p>
      <li>
       <p>If <a data-link-type="dfn" href="#c">c</a> is not the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, increase <var>pointer</var> by
   one.

   </p>
      <li>
       <p>If <var>dots seen</var> is 3 and <a data-link-type="dfn" href="#c">c</a> is not
   the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>,
   <a data-link-type="dfn" href="#parse-error">parse error</a>, return failure.

   </p>
      <li>
       <p>Increase <var>dots seen</var> by one.
  </p>
     </ol>
     

 
    <li>
  
     <p><dfn data-dfn-type="dfn" data-lt="IPv6 parser Finale" data-noexport="" id="concept-ipv6-parser-finale">Finale<a class="self-link" href="#concept-ipv6-parser-finale"></a></dfn>:
  If <var>compress pointer</var> is not null, run these substeps:

  </p>
     <ol>
   
      <li>
       <p>Let <var>swaps</var> be
   <var>piece pointer</var> − <var>compress pointer</var>.

   </p>
      <li>
       <p>Set <var>piece pointer</var> to seven.

   </p>
      <li>
       <p>While <var>piece pointer</var> is not zero and <var>swaps</var> is
   greater than zero, swap <var>piece</var> with the
   <a data-link-type="dfn" href="#concept-ipv6-piece">piece</a> at pointer
   <var>compress pointer</var> + <var>swaps</var> − 1, and then
   decrease both <var>piece pointer</var> and <var>swaps</var> by one.
  </p>
     </ol>
     

 
    <li>
     <p>Otherwise, if <var>compress pointer</var> is null and
 <var>piece pointer</var> is not eight, <a data-link-type="dfn" href="#parse-error">parse error</a>,
 return failure.

 </p>
    <li>
     <p>Return <var>address</var>.
</p></ol>



   <h3 class="heading settled" data-level="3.4" id="host-serializing"><span class="secno">3.4. </span><span class="content">Host serializing</span><a class="self-link" href="#host-serializing"></a></h3>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-host-serializer">host serializer<a class="self-link" href="#concept-host-serializer"></a></dfn> takes a
<a data-link-type="dfn" href="#concept-host">host</a> <var>host</var> and then runs these steps:

</p>
   <ol>
 
    <li>
     <p>If <var>host</var> is an <a data-link-type="dfn" href="#concept-ipv4">IPv4 address</a>, return the result of running the
 <a data-link-type="dfn" href="#concept-ipv4-serializer">IPv4 serializer</a> on <var>host</var>.

 </p>
    <li>
     <p>Otherwise, if <var>host</var> is an <a data-link-type="dfn" href="#concept-ipv6">IPv6 address</a>, return
 "<code>[</code>", followed by the result of running the
 <a data-link-type="dfn" href="#concept-ipv6-serializer">IPv6 serializer</a> on <var>host</var>,
 followed by "<code>]</code>".

 </p>
    <li>
     <p>Otherwise, <var>host</var> is a <a data-link-type="dfn" href="#concept-domain">domain</a>,
 return <var>host</var>.
</p></ol>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-ipv4-serializer">IPv4 serializer<a class="self-link" href="#concept-ipv4-serializer"></a></dfn> takes an
<span>IPv4 address</span> <var>address</var> and then runs these steps:</p>


   <ol>
 
    <li>
     <p>Let <var>output</var> be the empty string.

 </p>
    <li>
     <p>Let <var>n</var> be the value of <var>address</var>.

 </p>
    <li>
  
     <p>Repeat four times:

  </p>
     <ol>
   
      <li>
       <p>Prepend <var>n</var> % 256, represented as the shortest possible decimal
   number, to <var>output</var>.

   </p>
      <li>
       <p>Unless this is the fourth time, prepend "<code>.</code>" to <var>output</var>.

   </p>
      <li>
       <p>Set <var>n</var> to <var>n</var> / 256.
  </p>
     </ol>
     

 
    <li>
     <p>Return <var>output</var>.
</p></ol>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-ipv6-serializer">IPv6 serializer<a class="self-link" href="#concept-ipv6-serializer"></a></dfn> takes an <a data-link-type="dfn" href="#concept-ipv6">IPv6 address</a>
<var>address</var> and then runs these steps:

</p>
   <ol>
 
    <li>
     <p>Let <var>output</var> be the empty string.

 </p>
    <li>
  
     <p>Let <var>compress pointer</var> be a pointer to the first
  <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit piece</a> in the first longest
  sequences of <var>address</var>’s
  <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit pieces</a> that are 0.

  </p>
     <p class="example" id="example-e2b3492e"><a class="self-link" href="#example-e2b3492e"></a>In <code>0:f:0:0:f:f:0:0</code> it would point to
  the second 0.

 </p>
    <li>
     <p>If there is no sequence of <var>address</var>’s
 <a data-link-type="dfn" href="#concept-ipv6-piece">16-bit pieces</a> that are 0 longer than
 one, set <var>compress pointer</var> to null.

 </p>
    <li>
  
     <p>For each <var>piece</var> in <var>address</var>’s
  <a data-link-type="dfn" href="#concept-ipv6-piece">pieces</a>, run these substeps:

  </p>
     <ol>
   
      <li>
       <p>If <var>compress pointer</var> points to
   <var>piece</var>, append "<code>::</code>" to
   <var>output</var> if <var>piece</var> is
   <var>address</var>’s first <a data-link-type="dfn" href="#concept-ipv6-piece">piece</a> and append
   "<code>:</code>" otherwise, and then run these substeps again with all
   subsequent <a data-link-type="dfn" href="#concept-ipv6-piece">pieces</a> in
   <var>address</var>’s <a data-link-type="dfn" href="#concept-ipv6-piece">pieces</a>
   that are 0 skipped or go the next step in the overall set of steps if
   that leaves no <a data-link-type="dfn" href="#concept-ipv6-piece">pieces</a>.

   </p>
      <li>
       <p>Append <var>piece</var>, represented as the shortest
   possible lowercase hexadecimal number, to <var>output</var>.

   </p>
      <li>
       <p>If <var>piece</var> is not
   <var>address</var>’s last <a data-link-type="dfn" href="#concept-ipv6-piece">piece</a>,
   append "<code>:</code>" to <var>output</var>.
  </p>
     </ol>
     

 
    <li>
     <p>Return <var>output</var>.
</p></ol>


   <p class="note" role="note">This algorithm requires the recommendation from
A Recommendation for IPv6 Address Text Representation.
<a data-link-type="biblio" href="#biblio-rfc5952">[RFC5952]</a>





</p>
   <h2 class="heading settled" data-level="4" id="urls"><span class="secno">4. </span><span class="content">URLs</span><a class="self-link" href="#urls"></a></h2>




   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="concept-url">URL<a class="self-link" href="#concept-url"></a></dfn> is a universal identifier.

</p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> consists of components, namely a
<a data-link-type="dfn" href="#concept-url-scheme">scheme</a>,
<a data-link-type="dfn" href="#concept-url-username">username</a>,
<a data-link-type="dfn" href="#concept-url-password">password</a>,
<a data-link-type="dfn" href="#concept-url-host">host</a>,
<a data-link-type="dfn" href="#concept-url-port">port</a>,
<a data-link-type="dfn" href="#concept-url-path">path</a>,
<a data-link-type="dfn" href="#concept-url-query">query</a>, and
<a data-link-type="dfn" href="#concept-url-fragment">fragment</a>.

</p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-type="dfn" data-lt="URL scheme" data-noexport="" id="concept-url-scheme">scheme<a class="self-link" href="#concept-url-scheme"></a></dfn> is
an <a data-link-type="dfn" href="#ascii-string">ASCII string</a> that identifies the type of <a data-link-type="dfn" href="#concept-url">URL</a> and can be used to
dispatch a <a data-link-type="dfn" href="#concept-url">URL</a> for further processing after
<a data-link-type="dfn" href="#concept-url-parser">parsing</a>. It is initially the empty string.

</p>
   <p>A  <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-type="dfn" data-lt="URL username" data-noexport="" id="concept-url-username">username<a class="self-link" href="#concept-url-username"></a></dfn>
is an <a data-link-type="dfn" href="#ascii-string">ASCII string</a> identifying a user. It is initially the empty string.

</p>
   <p>A  <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-type="dfn" data-lt="URL password" data-noexport="" id="concept-url-password">password<a class="self-link" href="#concept-url-password"></a></dfn>
is either null or an <a data-link-type="dfn" href="#ascii-string">ASCII string</a> identifying a user’s credentials. It is initially
null.

</p>
   <p>A  <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-type="dfn" data-lt="URL host" data-noexport="" id="concept-url-host">host<a class="self-link" href="#concept-url-host"></a></dfn> is either null or a
<a data-link-type="dfn" href="#concept-host">host</a>. It is initially null.

</p>
   <p>A  <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-type="dfn" data-lt="URL port" data-noexport="" id="concept-url-port">port<a class="self-link" href="#concept-url-port"></a></dfn> is an
<a data-link-type="dfn" href="#ascii-string">ASCII string</a> that identifies a networking port. It is initially the empty string.

</p>
   <p>A  <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-type="dfn" data-lt="URL path" data-noexport="" id="concept-url-path">path<a class="self-link" href="#concept-url-path"></a></dfn> is a list of zero or
more <a data-link-type="dfn" href="#ascii-string">ASCII string</a> holding data, usually identifying a location in hierarchical
form. It is initially the empty list.

</p>
   <p>A  <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-type="dfn" data-lt="URL query" data-noexport="" id="concept-url-query">query<a class="self-link" href="#concept-url-query"></a></dfn> is
either null or an <a data-link-type="dfn" href="#ascii-string">ASCII string</a> holding data. It is initially null.

</p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-type="dfn" data-lt="URL fragment" data-noexport="" id="concept-url-fragment">fragment<a class="self-link" href="#concept-url-fragment"></a></dfn>
is either null or a string holding data that can be used for further processing on the
resource the <a data-link-type="dfn" href="#concept-url">URL</a>’s other components identify. It is initially null.

</p>
   <p class="note no-backref" role="note">This is not an <a data-link-type="dfn" href="#ascii-string">ASCII string</a> on purpose.

</p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> also has an associated <dfn data-dfn-type="dfn" data-noexport="" id="non_relative-flag">non-relative flag<a class="self-link" href="#non_relative-flag"></a></dfn>. It is initially
unset.

</p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> also has an associated
<dfn data-dfn-type="dfn" data-lt="URL object" data-noexport="" id="concept-url-object">object<a class="self-link" href="#concept-url-object"></a></dfn> that is either null or a
<code><a data-link-type="dfn" href="http://dev.w3.org/2006/webapi/FileAPI/#blob">Blob</a></code> object. It is initially null.
<a data-link-type="biblio" href="#biblio-fileapi">[FILEAPI]</a>

</p>
   <p class="note no-backref" role="note">At this point this is used primarily to support
"<code>blob</code>" <a data-link-type="dfn" href="#concept-url">URLs</a>, but others can be added going forward, hence "object".

</p>
   <hr>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="special-scheme">special scheme<a class="self-link" href="#special-scheme"></a></dfn> is a <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> listed in the first
column of the following table. A <dfn data-dfn-type="dfn" data-noexport="" id="default-port">default port<a class="self-link" href="#default-port"></a></dfn> is a <a data-link-type="dfn" href="#special-scheme">special scheme</a>’s
optional corresponding <a data-link-type="dfn" href="#concept-url-port">port</a> and is listed in the second column on the
same row.

</p>
   <table>
 
    <tbody>
     <tr>
      <th><a data-link-type="dfn" href="#concept-url-scheme">scheme</a>
     
      <th><a data-link-type="dfn" href="#concept-url-port">port</a>
 
     <tr>
      <td>"<code>ftp</code>"
      <td>"<code>21</code>"
 
     <tr>
      <td>"<code>file</code>"
      <td>
 
     <tr>
      <td>"<code>gopher</code>"
      <td>"<code>70</code>"
 
     <tr>
      <td>"<code>http</code>"
      <td>"<code>80</code>"
 
     <tr>
      <td>"<code>https</code>"
      <td>"<code>443</code>"
 
     <tr>
      <td>"<code>ws</code>"
      <td>"<code>80</code>"
 
     <tr>
      <td>"<code>wss</code>"
      <td>"<code>443</code>"
</table>


   <p></p>


   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> <dfn data-dfn-type="dfn" data-noexport="" id="is-special">is special<a class="self-link" href="#is-special"></a></dfn> if its <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is a
<a data-link-type="dfn" href="#special-scheme">special scheme</a>.

</p>
   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="local-scheme">local scheme<a class="self-link" href="#local-scheme"></a></dfn> is a <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> that is one of
"<code>about</code>", "<code>blob</code>", "<code>data</code>", and
"<code>filesystem</code>".

</p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> <dfn data-dfn-type="dfn" data-noexport="" id="is-local">is local<a class="self-link" href="#is-local"></a></dfn> if its <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is a
<a data-link-type="dfn" href="#local-scheme">local scheme</a>.

</p>
   <p class="note" role="note">This definition is used externally. E.g., by the Fetch Standard and
Referrer Policy. <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> <a data-link-type="biblio" href="#biblio-referrer-policy">[REFERRER-POLICY]</a>


</p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>
<dfn data-dfn-type="dfn" data-lt="include credentials" data-noexport="" id="include-credentials">includes credentials<a class="self-link" href="#include-credentials"></a></dfn> if either its
<a data-link-type="dfn" href="#concept-url-username">username</a> is not the empty string or its
<a data-link-type="dfn" href="#concept-url-password">password</a> is non-null.


</p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> can be designated as
<dfn data-dfn-type="dfn" data-noexport="" id="concept-base-url">base URL<a class="self-link" href="#concept-base-url"></a></dfn>.

</p>
   <p class="note no-backref" role="note">A <a data-link-type="dfn" href="#concept-base-url">base URL</a> is useful for the <a data-link-type="dfn" href="#concept-url-parser">URL parser</a> when the
input might be a <a data-link-type="dfn" href="#concept-relative-url">relative URL</a>.


</p>
   <h3 class="heading settled" data-level="4.1" id="url-writing"><span class="secno">4.1. </span><span class="content">URL writing</span><a class="self-link" href="#url-writing"></a></h3>




   <p>A <a data-link-type="dfn" href="#concept-url">URL</a> must be written as either a <a data-link-type="dfn" href="#concept-relative-url">relative URL</a> or an <a data-link-type="dfn" href="#concept-absolute-url">absolute URL</a>,
optionally followed by "<code>#</code>" and a <a data-link-type="dfn" href="#concept-url-fragment">fragment</a>.

</p>
   <p>An <dfn data-dfn-type="dfn" data-noexport="" id="concept-absolute-url">absolute URL<a class="self-link" href="#concept-absolute-url"></a></dfn> must be a
<a data-link-type="dfn" href="#concept-url-scheme">scheme</a>, followed by "<code>:</code>", followed by either a
<a data-link-type="dfn" href="#concept-scheme-relative-url">scheme-relative URL</a>, or if <a data-link-type="dfn" href="#concept-url">URL</a>
<a data-link-type="dfn" href="#is-special">is <em>not</em> special</a>, a <a data-link-type="dfn" href="#concept-url-path">path</a>, optionally
followed by "<code>?</code>" and a <a data-link-type="dfn" href="#concept-url-query">query</a>.

</p>
   <p>A <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> must be one <a data-link-type="dfn" href="#ascii-alpha">ASCII alpha</a>, followed by zero or
more of <a data-link-type="dfn" href="#ascii-alphanumeric">ASCII alphanumeric</a>, "<code>+</code>", "<code>-</code>", and
"<code>.</code>". A <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> must be registered
<span class="XXX">...</span>.

</p>
   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="concept-relative-url">relative URL<a class="self-link" href="#concept-relative-url"></a></dfn> must be either a
<a data-link-type="dfn" href="#concept-scheme-relative-url">scheme-relative URL</a>, or a <a data-link-type="dfn" href="#concept-url-path">path</a> that does not start with a
<a data-link-type="dfn" href="#concept-url-scheme">scheme</a> and "<code>:</code>", optionally followed by a
"<code>?</code>" and a <a data-link-type="dfn" href="#concept-url-query">query</a>.

</p>
   <p>When a <a data-link-type="dfn" href="#concept-relative-url">relative URL</a> is <a data-link-type="dfn" href="#concept-url-parser">parsed</a>, a <a data-link-type="dfn" href="#concept-base-url">base URL</a> must be
in scope.

</p>
   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="concept-scheme-relative-url">scheme-relative URL<a class="self-link" href="#concept-scheme-relative-url"></a></dfn> must be
"<code>//</code>", followed by a <a data-link-type="dfn" href="#concept-host">host</a>, optionally followed by "<code>:</code>" and
a <a data-link-type="dfn" href="#concept-url-port">port</a>, optionally followed by a <a data-link-type="dfn" href="#concept-url-path">path</a> that
starts with "<code>/</code>".

</p>
   <p>A <a data-link-type="dfn" href="#concept-url-port">port</a> must be zero or more <a data-link-type="dfn" href="#ascii-digits">ASCII digits</a>.

</p>
   <p>A <a data-link-type="dfn" href="#concept-url-path">path</a> must be zero or more <a data-link-type="dfn" href="#url-units">URL units</a>, excluding
"<code>?</code>".

</p>
   <p>A <a data-link-type="dfn" href="#concept-url-query">query</a> must be zero or more <a data-link-type="dfn" href="#url-units">URL units</a>.

</p>
   <p>A <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> must be zero or more <a data-link-type="dfn" href="#url-units">URL units</a>.

</p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="url-code-points">URL code points<a class="self-link" href="#url-code-points"></a></dfn> are <a data-link-type="dfn" href="#ascii-alphanumeric">ASCII alphanumeric</a>,
"<code>!</code>",
"<code>$</code>",
"<code>&amp;</code>",
"<code>'</code>",
"<code>(</code>",
"<code>)</code>",
"<code>*</code>",
"<code>+</code>",
"<code>,</code>",
"<code>-</code>",
"<code>.</code>",
"<code>/</code>",
"<code>:</code>",
"<code>;</code>",
"<code>=</code>",
"<code>?</code>",
"<code>@</code>",
"<code>_</code>",
"<code>~</code>",
and code points in the ranges
U+00A0 to U+D7FF,
U+E000 to U+FDCF,
U+FDF0 to U+FFFD,
U+10000 to U+1FFFD,
U+20000 to U+2FFFD,
U+30000 to U+3FFFD,
U+40000 to U+4FFFD,
U+50000 to U+5FFFD,
U+60000 to U+6FFFD,
U+70000 to U+7FFFD,
U+80000 to U+8FFFD,
U+90000 to U+9FFFD,
U+A0000 to U+AFFFD,
U+B0000 to U+BFFFD,
U+C0000 to U+CFFFD,
U+D0000 to U+DFFFD,
U+E0000 to U+EFFFD,
U+F0000 to U+FFFFD,
U+100000 to U+10FFFD.

</p>
   <p class="note" role="note">Code points higher than U+009F will be converted to
<a data-link-type="dfn" href="#percent_encoded-byte">percent-encoded bytes</a> by the
<a data-link-type="dfn" href="#concept-url-parser">URL parser</a>, except for code points appearing in
<a data-link-type="dfn" href="#concept-url-fragment">fragments</a>.

</p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="url-units">URL units<a class="self-link" href="#url-units"></a></dfn> are <a data-link-type="dfn" href="#url-code-points">URL code points</a> and
<a data-link-type="dfn" href="#percent_encoded-byte">percent-encoded bytes</a>.

</p>
   <hr>


   <p class="note no-backref" role="note">There is no conforming way to express a
<a data-link-type="dfn" href="#concept-url-username">username</a> or <a data-link-type="dfn" href="#concept-url-password">password</a> within a
<a data-link-type="dfn" href="#concept-url">URL</a>.


</p>
   <h3 class="heading settled" data-level="4.2" id="url-parsing"><span class="secno">4.2. </span><span class="content">URL parsing</span><a class="self-link" href="#url-parsing"></a></h3>


   <p class="XXX">Add the ability to halt on the first conformance error.

</p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-url-parser">URL parser<a class="self-link" href="#concept-url-parser"></a></dfn> takes a string
<var>input</var>, with an optional <a data-link-type="dfn" href="#concept-base-url">base URL</a> <var>base</var> and an optional
<a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encoding">encoding</a> <var>encoding override</var>, and then runs these steps:

</p>
   <p class="note no-backref" role="note">Non-web-browser implementations only need to implement the
<a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parser</a>.

</p>
   <ol>
 
    <li>
     <p>Let <var>url</var> be the result of running the
 <a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parser</a> on <var>input</var>
 with <var>base</var>, and <var>encoding override</var> as provided.

 </p>
    <li>
     <p>If <var>url</var> is failure, return failure.

 </p>
    <li>
     <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is not
 "<code>blob</code>", return <var>url</var>.

 </p>
    <li>
     <p>If the first string in <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> is not in the
 <a data-link-type="dfn" href="http://dev.w3.org/2006/webapi/FileAPI/#BlobURLStore">blob URL store</a>, return <var>url</var>. <a data-link-type="biblio" href="#biblio-fileapi">[FILEAPI]</a>

 </p>
    <li>
     <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-object">object</a> to a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#structured-clone">structured clone</a> of
 the entry in the <a data-link-type="dfn" href="http://dev.w3.org/2006/webapi/FileAPI/#BlobURLStore">blob URL store</a> corresponding to the first string in
 <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>. <a data-link-type="biblio" href="#biblio-html">[HTML]</a>

 </p>
    <li>
     <p>Return <var>url</var>.
</p></ol>


   <hr>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-basic-url-parser">basic URL parser<a class="self-link" href="#concept-basic-url-parser"></a></dfn> takes a string
<var>input</var>, optionally with a
<a data-link-type="dfn" href="#concept-base-url">base URL</a> <var>base</var>,
optionally with an <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encoding">encoding</a>
<var>encoding override</var>, optionally with an
<a data-link-type="dfn" href="#concept-url">URL</a> <var>url</var> and a state override
<var>state override</var>, and then runs these steps:

</p>
   <div class="note no-backref" role="note">
 
    <p>The <var>encoding override</var> argument is a legacy concept only relevant for
 HTML. The <var>url</var> and <var>state override</var> arguments are only for use by
 objects implementing the <code class="idl"><a data-link-type="idl" href="#urlutils">URLUtils</a></code> interface.
 <a data-link-type="biblio" href="#biblio-html">[HTML]</a>

 </p>
    <p>When the <var>url</var> and <var>state override</var> arguments are not passed, the
 <a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parser</a> returns either a new <a data-link-type="dfn" href="#concept-url">URL</a> or failure. If they are passed
 the algorithm simply modifies the passed <var>url</var> and can terminate without
 returning anything.
</p></div>


   <ol>
 
    <li>
  
     <p>If <var>url</var> is not given:

  </p>
     <ol>
   
      <li>
       <p>Set <var>url</var> to a new <a data-link-type="dfn" href="#concept-url">URL</a>.

   </p>
      <li>
       <p>Remove any leading and trailing <a data-link-type="dfn" href="#c0-controls-and-space">C0 controls and space</a> from
   <var>input</var>.
  </p>
     </ol>
     

 
    <li>
     <p>Let <var>state</var> be <var>state override</var>
 if given, or <a data-link-type="dfn" href="#scheme-start-state">scheme start state</a> otherwise.

 </p>
    <li>
     <p>If <var>base</var> is not given, set it to null.

 </p>
    <li>
     <p>If <var>encoding override</var> is not given, set it to
 <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">utf-8</a>.

 </p>
    <li>
     <p>Let <var>buffer</var> be the empty string.

 </p>
    <li>
     <p>Let the <var>@ flag</var> and the <var>[] flag</var> be
 unset.

 </p>
    <li>
     <p>Let <var>pointer</var> be a pointer to first code point in
 <var>input</var>.

 </p>
    <li>
  
     <p>Keep running the following state machine by switching on <var>state</var>. If
  after a run <var>pointer</var> points to the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, go to
  the next step. Otherwise, increase <var>pointer</var> by one and continue with the
  state machine.

  </p>
     <dl class="switch">
   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="scheme-start-state">scheme start state<a class="self-link" href="#scheme-start-state"></a></dfn>
   
      <dd>
    
       <ol>
     
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is an <a data-link-type="dfn" href="#ascii-alpha">ASCII alpha</a>,
     append <a data-link-type="dfn" href="#c">c</a>, lowercased, to <var>buffer</var>, and
     set <var>state</var> to <a data-link-type="dfn" href="#scheme-state">scheme state</a>.

     </p>
        <li>
         <p>Otherwise, if <var>state override</var> is not given, set
     <var>state</var> to <a data-link-type="dfn" href="#no-scheme-state">no scheme state</a>, and decrease
     <var>pointer</var> by one.

     </p>
        <li>
         <p>Otherwise, <a data-link-type="dfn" href="#parse-error">parse error</a>, terminate this algorithm.
    </p>
       </ol>
       

   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="scheme-state">scheme state<a class="self-link" href="#scheme-state"></a></dfn>
   
      <dd>
    
       <ol>
     
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is an <a data-link-type="dfn" href="#ascii-alphanumeric">ASCII alphanumeric</a>, "<code>+</code>",
     "<code>-</code>", or "<code>.</code>", append <a data-link-type="dfn" href="#c">c</a>, lowercased, to
     <var>buffer</var>.

     </p>
        <li>
      
         <p>Otherwise, if <a data-link-type="dfn" href="#c">c</a> is "<code>:</code>", run these substeps:

      </p>
         <ol>
       
          <li>
        
           <p>If <var>state override</var> is given, run these subsubsteps:

        </p>
           <ol>
         
            <li>
             <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is a
         <a data-link-type="dfn" href="#special-scheme">special scheme</a> and <var>buffer</var> is not, terminate this algorithm.

         </p>
            <li>
             <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is not a
         <a data-link-type="dfn" href="#special-scheme">special scheme</a> and <var>buffer</var> is, terminate this algorithm.
        </p>
           </ol>
           

       
          <li>
           <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> to <var>buffer</var>.

       </p>
          <li>
           <p>Set <var>buffer</var> to the empty string.

       </p>
          <li>
           <p>If <var>state override</var> is given, terminate this algorithm.

       </p>
          <li>
           <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is "<code>file</code>",
       set <var>state</var> to <a data-link-type="dfn" href="#relative-state">relative state</a>.

       </p>
          <li>
           <p>Otherwise, if <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a>, <var>base</var> is not null,
       and <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is equal to <var>url</var>’s
       <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>, set <var>state</var> to
       <a data-link-type="dfn" href="#special-relative-or-authority-state">special relative or authority state</a>.

       </p>
          <li>
           <p>Otherwise, if <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a>, set <var>state</var> to
       <a data-link-type="dfn" href="#special-authority-slashes-state">special authority slashes state</a>.

       </p>
          <li>
           <p>Otherwise, if <a data-link-type="dfn" href="#remaining">remaining</a> starts with an "<code>/</code>", set
       <var>state</var> to <a data-link-type="dfn" href="#path-or-authority-state">path or authority state</a>, and increase <var>pointer</var>
       by one.

       </p>
          <li>
           <p>Otherwise, set <var>url</var>’s <a data-link-type="dfn" href="#non_relative-flag">non-relative flag</a>, append an empty
       string to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, and set <var>state</var> to
       <a data-link-type="dfn" href="#non_relative-path-state">non-relative path state</a>.
      </p>
         </ol>
         

     
        <li>
         <p>Otherwise, if <var>state override</var> is not given, set
     <var>buffer</var> to the empty string, <var>state</var> to
     <a data-link-type="dfn" href="#no-scheme-state">no scheme state</a>, and start over (from the first code point
     in <var>input</var>).

     </p>
        <li>
         <p>Otherwise, <a data-link-type="dfn" href="#parse-error">parse error</a>, terminate this algorithm.
    </p>
       </ol>
       

   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="no-scheme-state">no scheme state<a class="self-link" href="#no-scheme-state"></a></dfn>
   
      <dd>
    
       <p>If <var>base</var> is null, or <var>base</var>’s <a data-link-type="dfn" href="#non_relative-flag">non-relative flag</a> is set
    and <a data-link-type="dfn" href="#c">c</a> is not "<code>#</code>", <a data-link-type="dfn" href="#parse-error">parse error</a>, return failure.

    </p>
       <p>Otherwise, if <var>base</var>’s <a data-link-type="dfn" href="#non_relative-flag">non-relative flag</a> is set and <a data-link-type="dfn" href="#c">c</a> is
    "<code>#</code>", set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> to
    <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>,
    <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to
    <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>,
    <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to
    <var>base</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>,
    <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty string, set
    <var>url</var>’s <a data-link-type="dfn" href="#non_relative-flag">non-relative flag</a>, and set <var>state</var> to
    <a data-link-type="dfn" href="#fragment-state">fragment state</a>.

    </p>
       <p>Otherwise, set <var>state</var> to <a data-link-type="dfn" href="#relative-state">relative state</a>,
    and decrease <var>pointer</var> by one.

   </p>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="special-relative-or-authority-state">special relative or authority state<a class="self-link" href="#special-relative-or-authority-state"></a></dfn>
   
      <dd>
    
       <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>/</code>" and
    <a data-link-type="dfn" href="#remaining">remaining</a> starts with "<code>/</code>", set
    <var>state</var> to <a data-link-type="dfn" href="#special-authority-ignore-slashes-state">special authority ignore slashes state</a>
    and increase <var>pointer</var> by one.

    </p>
       <p>Otherwise, <a data-link-type="dfn" href="#parse-error">parse error</a>, set <var>state</var> to
    <a data-link-type="dfn" href="#relative-state">relative state</a> and decrease <var>pointer</var> by
    one.

   </p>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="path-or-authority-state">path or authority state<a class="self-link" href="#path-or-authority-state"></a></dfn>
   
      <dd>
    
       <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>/</code>", set <var>state</var> to <a data-link-type="dfn" href="#authority-state">authority state</a>.

    </p>
       <p>Otherwise, set <var>state</var> to <a data-link-type="dfn" href="#path-state">path state</a>, and decrease
    <var>pointer</var> by one.

   </p>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="relative-state">relative state<a class="self-link" href="#relative-state"></a></dfn>
   
      <dd>
    
       <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> to
    <var>base</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> if
    <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is not
    "<code>file</code>", and then, based on <a data-link-type="dfn" href="#c">c</a>:

    </p>
       <dl class="switch">
     
        <dt><a data-link-type="dfn" href="#eof-code-point">EOF code point</a>
     
        <dd>
         <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, and
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>.

     </p>
        <dt>"<code>/</code>"
     
        <dd>
         <p>Set <var>state</var> to <a data-link-type="dfn" href="#relative-slash-state">relative slash state</a>.

     </p>
        <dt>"<code>?</code>"
     
        <dd>
         <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to the empty string,
     and <var>state</var> to <a data-link-type="dfn" href="#query-state">query state</a>.

     </p>
        <dt>"<code>#</code>"
     
        <dd>
         <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to
     <var>base</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>,
     <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty string,
     and <var>state</var> to <a data-link-type="dfn" href="#fragment-state">fragment state</a>.

     </p>
        <dt>Otherwise
     
        <dd>
      
         <p>If <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>",
      <a data-link-type="dfn" href="#parse-error">parse error</a>, set <var>state</var> to <a data-link-type="dfn" href="#relative-slash-state">relative slash state</a>.

      </p>
         <p>Otherwise, run these steps:

      </p>
         <ol>
       
          <li>
        
           <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is not "<code>file</code>",
        or <var>c</var> is not an <a data-link-type="dfn" href="#ascii-alpha">ASCII alpha</a>, or <a data-link-type="dfn" href="#remaining">remaining</a> does not start
        with either "<code>:</code>" or "<code>|</code>", or <a data-link-type="dfn" href="#remaining">remaining</a> consists of
        one code point, or <a data-link-type="dfn" href="#remaining">remaining</a>’s second code point is not one of
        "<code>/</code>", "<code>\</code>", "<code>?</code>", and "<code>#</code>", then
        set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to
        <var>base</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a>,
        <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to
        <var>base</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>,
        <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to
        <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>,
        <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> to
        <var>base</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a>,
        <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to
        <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>, and then remove
        <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>’s last entry.
        

        </p>
           <p class="note" role="note">This is a (platform-independent) Windows drive letter quirk.
        When found at the start of a <code>file</code> URL it is treated as an
        absolute path rather than one relative to
        <var>base</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>.

       </p>
          <li>
           <p>Set <var>state</var> to <a data-link-type="dfn" href="#path-state">path state</a>,
       and decrease <var>pointer</var> by one.
      </p>
         </ol>
         
    
       </dl>
       

   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="relative-slash-state">relative slash state<a class="self-link" href="#relative-slash-state"></a></dfn>
   
      <dd>
    
       <p>If either <a data-link-type="dfn" href="#c">c</a> is "<code>/</code>", or <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and
    <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", run these steps:

    </p>
       <ol>
     
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", <a data-link-type="dfn" href="#parse-error">parse error</a>.

     </p>
        <li>
         <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is "<code>file</code>", set
     <var>state</var> to <a data-link-type="dfn" href="#file-host-state">file host state</a>.

     </p>
        <li>
         <p>Otherwise, set <var>state</var> to
     <a data-link-type="dfn" href="#special-authority-ignore-slashes-state">special authority ignore slashes state</a>.
    </p>
       </ol>
       

    
       <p>Otherwise, run these steps:

    </p>
       <ol>
     
        <li>
      
         <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is not
      "<code>file</code>", set
      <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to
      <var>base</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a>,
      <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to
      <var>base</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>,
      <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to
      <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>, and
      <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> to
      <var>base</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a>.

      </p>
         <p class="example no-backref" id="example-232b2bfb"><a class="self-link" href="#example-232b2bfb"></a><code>file:/path/</code> will not inherit
      <var>base</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>.

     </p>
        <li>
         <p>Set <var>state</var> to <a data-link-type="dfn" href="#path-state">path state</a>, and decrease <var>pointer</var> by
     one.
    </p>
       </ol>
       

   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="special-authority-slashes-state">special authority slashes state<a class="self-link" href="#special-authority-slashes-state"></a></dfn>
   
      <dd>
    
       <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>/</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> starts with "<code>/</code>",
    set <var>state</var> to <a data-link-type="dfn" href="#special-authority-ignore-slashes-state">special authority ignore slashes state</a>, and increase
    <var>pointer</var> by one.

    </p>
       <p>Otherwise, <a data-link-type="dfn" href="#parse-error">parse error</a>, set <var>state</var> to
    <a data-link-type="dfn" href="#special-authority-ignore-slashes-state">special authority ignore slashes state</a>, and decrease <var>pointer</var> by one.

   </p>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="special-authority-ignore-slashes-state">special authority ignore slashes state<a class="self-link" href="#special-authority-ignore-slashes-state"></a></dfn>
   
      <dd>
    
       <p>If <a data-link-type="dfn" href="#c">c</a> is neither "<code>/</code>" nor "<code>\</code>", set <var>state</var>
    to <a data-link-type="dfn" href="#authority-state">authority state</a>, and decrease <var>pointer</var> by one.

    </p>
       <p>Otherwise, <a data-link-type="dfn" href="#parse-error">parse error</a>.

   </p>
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="authority-state">authority state<a class="self-link" href="#authority-state"></a></dfn>
   
      <dd>
    
       <ol>
     
        <li>
      
         <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>@</code>", run these substeps:

      </p>
         <ol>
       
          <li>
           <p><a data-link-type="dfn" href="#parse-error">Parse error</a>.

       </p>
          <li>
           <p>If the <var>@ flag</var> is set, prepend "<code>%40</code>" to
       <var>buffer</var>.

       </p>
          <li>
           <p>Set the <var>@ flag</var>.

       </p>
          <li>
        
           <p>For each <var>code point</var> in <var>buffer</var>, run these substeps:

        </p>
           <ol>
         
            <li>
             <p>If <var>code point</var> is U+0009, U+000A, or U+000D, continue.

         </p>
            <li>
             <p>If <var>code point</var> is "<code>:</code>" and
         <var>url</var>’s
         <a data-link-type="dfn" href="#concept-url-password">password</a> is null, set
         <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>
         to the empty string and continue.

         </p>
            <li>
             <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> is non-null,
         <a data-link-type="dfn" href="#utf_8-percent-encode">utf-8 percent encode</a> <var>code point</var> using the
         <a data-link-type="dfn" href="#password-encode-set">password encode set</a> and append the result to <var>url</var>’s
         <a data-link-type="dfn" href="#concept-url-password">password</a>.

         </p>
            <li>
             <p>Otherwise, <a data-link-type="dfn" href="#utf_8-percent-encode">utf-8 percent encode</a> <var>code point</var> using the
         <a data-link-type="dfn" href="#username-encode-set">username encode set</a> and append the result to <var>url</var>’s
         <a data-link-type="dfn" href="#concept-url-username">username</a>.
        </p>
           </ol>
           
       
          <li>
           <p>Set <var>buffer</var> to the empty string.
      </p>
         </ol>
         

     
        <li>
         <p>Otherwise, if either <a data-link-type="dfn" href="#c">c</a> is one of <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>,
     "<code>/</code>", "<code>?</code>", and "<code>#</code>", or <var>url</var>
     <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", decrease <var>pointer</var> by
     the number of code points in <var>buffer</var> plus one, set <var>buffer</var> to the
     empty string, and <var>state</var> to <a data-link-type="dfn" href="#host-state">host state</a>.

     </p>
        <li>
         <p>Otherwise, append <a data-link-type="dfn" href="#c">c</a> to <var>buffer</var>.
    </p>
       </ol>
       

   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="host-state">host state<a class="self-link" href="#host-state"></a></dfn>
   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="hostname-state">hostname state<a class="self-link" href="#hostname-state"></a></dfn>
   
      <dd>
    
       <ol>
     
        <li>
      
         <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>:</code>" and the
      <var>[] flag</var> is unset, run these substeps:

      </p>
         <ol>
       
          <li>
           <p>If <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <var>buffer</var> is the empty
       string, return failure.
       </p>
           

       
          <li>
           <p>Let <var>host</var> be the result of
       <a data-link-type="dfn" href="#concept-host-parser">host parsing</a>
       <var>buffer</var>.

       </p>
          <li>
           <p>If <var>host</var> is failure, return failure.

       </p>
          <li>
           <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to
       <var>host</var>, <var>buffer</var> to the empty string,
       and <var>state</var> to <a data-link-type="dfn" href="#port-state">port state</a>.

       </p>
          <li>
           <p>If <var>state override</var> is <a data-link-type="dfn" href="#hostname-state">hostname state</a>,
       terminate this algorithm.
      </p>
         </ol>
         

     
        <li>
      
         <p>Otherwise, if either <a data-link-type="dfn" href="#c">c</a> is one of <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, "<code>/</code>",
      "<code>?</code>", and "<code>#</code>", or <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and
      <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", decrease <var>pointer</var> by one, and run these
      substeps:

      </p>
         <ol>
       
          <li>
           <p>If <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <var>buffer</var> is the empty
       string, return failure.

       </p>
          <li>
           <p>Let <var>host</var> be the result of
       <a data-link-type="dfn" href="#concept-host-parser">host parsing</a>
       <var>buffer</var>.

       </p>
          <li>
           <p>If <var>host</var> is failure, return failure.

       </p>
          <li>
           <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to
       <var>host</var>, <var>buffer</var> to the empty string,
       and <var>state</var> to <a data-link-type="dfn" href="#path-start-state">path start state</a>.

       </p>
          <li>
           <p>If <var>state override</var> is given, terminate this
       algorithm.
      </p>
         </ol>
         

     
        <li>
         <p>Otherwise, if <a data-link-type="dfn" href="#c">c</a> is U+0009, U+000A, or U+000D,
     <a data-link-type="dfn" href="#parse-error">parse error</a>.

     </p>
        <li>
      
         <p>Otherwise, run these substeps:

      </p>
         <ol>
       
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>[</code>", set the
       <var>[] flag</var>.

       </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>]</code>", unset the
       <var>[] flag</var>.

       </p>
          <li>
           <p>Append <a data-link-type="dfn" href="#c">c</a> to <var>buffer</var>.
      </p>
         </ol>
         
    
       </ol>
       

   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="file-host-state">file host state<a class="self-link" href="#file-host-state"></a></dfn>
   
      <dd>
    
       <ol>
     
        <li>
      
         <p>If <a data-link-type="dfn" href="#c">c</a> is one of <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, "<code>/</code>", "<code>\</code>",
      "<code>?</code>", and "<code>#</code>", decrease <var>pointer</var> by one, and run
      these substeps:

      </p>
         <ol>
       
          <li>
        
           <p>If <var>buffer</var> consists of two code points, of
        which the first is an <a data-link-type="dfn" href="#ascii-alpha">ASCII alpha</a> and the second is
        either "<code>:</code>" or "<code>|</code>", set
        <var>state</var> to <a data-link-type="dfn" href="#path-state">path state</a>.

        </p>
           <p class="note" role="note">This is a (platform-independent) Windows drive letter quirk.
        <var>buffer</var> is not reset here and instead used in the
        <a data-link-type="dfn" href="#path-state">path state</a>.

       </p>
          <li>
           <p>Otherwise, if <var>buffer</var> is the empty string, set
       <var>state</var> to <a data-link-type="dfn" href="#path-start-state">path start state</a>.

       </p>
          <li>
        
           <p>Otherwise, run these steps:

        </p>
           <ol>
         
            <li>
             <p>Let <var>host</var> be the result of
         <a data-link-type="dfn" href="#concept-host-parser">host parsing</a>
         <var>buffer</var>.

         </p>
            <li>
             <p>If <var>host</var> is failure, return failure.

         </p>
            <li>
             <p>Set
         <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a> to
         <var>host</var>, <var>buffer</var> to the empty string,
         and <var>state</var> to <a data-link-type="dfn" href="#path-start-state">path start state</a>.
        </p>
           </ol>
           
      
         </ol>
         

     
        <li>
         <p>Otherwise, if <a data-link-type="dfn" href="#c">c</a> is U+0009, U+000A, or U+000D,
     <a data-link-type="dfn" href="#parse-error">parse error</a>.

     </p>
        <li>
         <p>Otherwise, append <a data-link-type="dfn" href="#c">c</a> to <var>buffer</var>.
    </p>
       </ol>
       

   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="port-state">port state<a class="self-link" href="#port-state"></a></dfn>
   
      <dd>
    
       <ol>
     
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is an <a data-link-type="dfn" href="#ascii-digits">ASCII digit</a>,
     append <a data-link-type="dfn" href="#c">c</a> to <var>buffer</var>.

     </p>
        <li>
      
         <p>Otherwise, if <a data-link-type="dfn" href="#c">c</a> is one of <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, "<code>/</code>",
      "<code>?</code>", and "<code>#</code>", or <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and
      <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", or <var>state override</var> is given, run these
      substeps:
      </p>
         <ol>
       
          <li>
        
           <p>Remove leading U+0030 code points from <var>buffer</var>
        until either the leading code point is not U+0030 or
        <var>buffer</var> is one code point.

        </p>
           <div class="example" id="example-a62bfcc9"><a class="self-link" href="#example-a62bfcc9"></a>
        
            <table>
         
             <tbody>
              <tr>
               <th>Input
               <th>Output
         
              <tr>
               <td>"<code>42</code>"
               <td>"<code>42</code>"
         
              <tr>
               <td>"<code>031</code>"
               <td>"<code>31</code>"
         
              <tr>
               <td>"<code>080</code>"
               <td>"<code>80</code>"
         
              <tr>
               <td>"<code>0000</code>"
               <td>"<code>0</code>"
        
            </table>
            
        
           </div>
           

       
          <li>
           <p>If <var>buffer</var> is equal to
       <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>’s
       <a data-link-type="dfn" href="#default-port">default port</a>, set <var>buffer</var> to the empty
       string.

       </p>
          <li>
           <p>Set <var>url</var>’s
       <a data-link-type="dfn" href="#concept-url-port">port</a> to <var>buffer</var>.

       </p>
          <li>
           <p>If <var>state override</var> is given, terminate this
       algorithm.

       </p>
          <li>
           <p>Set <var>buffer</var> to the empty string,
       <var>state</var> to <a data-link-type="dfn" href="#path-start-state">path start state</a>, and
       decrease <var>pointer</var> by one.
      </p>
         </ol>
         

     
        <li>
         <p>Otherwise, if <a data-link-type="dfn" href="#c">c</a> is U+0009, U+000A, or U+000D,
     <a data-link-type="dfn" href="#parse-error">parse error</a>.

     </p>
        <li>
         <p>Otherwise, <a data-link-type="dfn" href="#parse-error">parse error</a>, return failure.
    </p>
       </ol>
       

   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="path-start-state">path start state<a class="self-link" href="#path-start-state"></a></dfn>
   
      <dd>
    
       <ol>
     
        <li>
         <p>If <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>",
     <a data-link-type="dfn" href="#parse-error">parse error</a>.

     </p>
        <li>
         <p>Set <var>state</var> to <a data-link-type="dfn" href="#path-state">path state</a>, and if neither <a data-link-type="dfn" href="#c">c</a> is
     "<code>/</code>", nor <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is
     "<code>\</code>", decrease <var>pointer</var> by one.
    </p>
       </ol>
       

   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="path-state">path state<a class="self-link" href="#path-state"></a></dfn>
   
      <dd>
    
       <ol>
     
        <li>
      
         <p>If <a data-link-type="dfn" href="#c">c</a> is <a data-link-type="dfn" href="#eof-code-point">EOF code point</a> or "<code>/</code>", or <var>url</var>
      <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>", or <var>state override</var> is
      not given and <a data-link-type="dfn" href="#c">c</a> is "<code>?</code>" or "<code>#</code>", run these substeps:
      </p>
         <ol>
       
          <li>
           <p>If <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is "<code>\</code>",
       <a data-link-type="dfn" href="#parse-error">parse error</a>.

       </p>
          <li>
        
           <p>If <var>buffer</var>, lowercased, matches any row in the first column of
        the following table, set <var>buffer</var> to the contents of the cell in
        the second column of the matched row:
        

        </p>
           <table>
         
            <tbody>
             <tr>
              <td>"<code>%2e</code>"   
              <td>"<code>.</code>"
         
             <tr>
              <td>"<code>.%2e</code>"  
              <td rowspan="3">"<code>..</code>"
         
             <tr>
              <td>"<code>%2e.</code>"
         
             <tr>
              <td>"<code>%2e%2e</code>"
        
           </table>
           

       
          <li>
           <p>If <var>buffer</var> is "<code>..</code>", remove <var>url</var>’s
       <a data-link-type="dfn" href="#concept-url-path">path</a>’s last string, if any, and then if neither <a data-link-type="dfn" href="#c">c</a> is
       "<code>/</code>", nor <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is
       "<code>\</code>", append the empty string to <var>url</var>’s
       <a data-link-type="dfn" href="#concept-url-path">path</a>.

       </p>
          <li>
           <p>Otherwise, if <var>buffer</var> is "<code>.</code>" and if neither <a data-link-type="dfn" href="#c">c</a>
       is "<code>/</code>", nor <var>url</var> <a data-link-type="dfn" href="#is-special">is special</a> and <a data-link-type="dfn" href="#c">c</a> is
       "<code>\</code>", append the empty string to <var>url</var>’s
       <a data-link-type="dfn" href="#concept-url-path">path</a>.

       </p>
          <li>
        
           <p>Otherwise, if <var>buffer</var> is not
        "<code>.</code>", run these subsubsteps:

        </p>
           <ol>
         
            <li>
          
             <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is
          "<code>file</code>", <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>
          is empty, <var>buffer</var> consists of two
          code points, of which the first is an <a data-link-type="dfn" href="#ascii-alpha">ASCII alpha</a>,
          and the second is "<code>|</code>", replace the second code point in
          <var>buffer</var> with "<code>:</code>".

          </p>
             <p class="note" role="note">This is a (platform-independent) Windows drive letter quirk.
          They are beautiful, no?

         </p>
            <li>
             <p>Append <var>buffer</var> to
         <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>.
        </p>
           </ol>
           

       
          <li>
           <p>Set <var>buffer</var> to the empty string.

       </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>?</code>", set
       <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> to the empty string,
       and <var>state</var> to <a data-link-type="dfn" href="#query-state">query state</a>.

       </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>#</code>", set
       <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty string,
       and <var>state</var> to <a data-link-type="dfn" href="#fragment-state">fragment state</a>.
      </p>
         </ol>
         

     
        <li>
         <p>Otherwise, if <a data-link-type="dfn" href="#c">c</a> is U+0009, U+000A, or U+000D,
     <a data-link-type="dfn" href="#parse-error">parse error</a>.

     </p>
        <li>
      
         <p>Otherwise, run these steps:

      </p>
         <ol>
       
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is not a
       <a data-link-type="dfn" href="#url-code-points">URL code point</a> and not "<code>%</code>",
       <a data-link-type="dfn" href="#parse-error">parse error</a>.

       </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>%</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> does
       not start with two <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digits</a>, <a data-link-type="dfn" href="#parse-error">parse error</a>.

       </p>
          <li>
           <p><a data-link-type="dfn" href="#utf_8-percent-encode">utf-8 percent encode</a> <a data-link-type="dfn" href="#c">c</a> using the
       <a data-link-type="dfn" href="#default-encode-set">default encode set</a>, and append the result to
       <var>buffer</var>.
      </p>
         </ol>
         
    
       </ol>
       

   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="non_relative-path-state">non-relative path state<a class="self-link" href="#non_relative-path-state"></a></dfn>
   
      <dd>
    
       <ol>
     
        <li>
         <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>?</code>", set <var>url</var>’s
     <a data-link-type="dfn" href="#concept-url-query">query</a> to the empty string and <var>state</var> to
     <a data-link-type="dfn" href="#query-state">query state</a>.

     </p>
        <li>
         <p>Otherwise, if <a data-link-type="dfn" href="#c">c</a> is "<code>#</code>", set <var>url</var>’s
     <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty string and <var>state</var> to
     <a data-link-type="dfn" href="#fragment-state">fragment state</a>.

     </p>
        <li>
      
         <p>Otherwise, run these substeps:

      </p>
         <ol>
       
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is not the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, not a
       <a data-link-type="dfn" href="#url-code-points">URL code point</a>, and not
       "<code>%</code>", <a data-link-type="dfn" href="#parse-error">parse error</a>.

       </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>%</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> does
       not start with two <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digits</a>, <a data-link-type="dfn" href="#parse-error">parse error</a>.

       </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is none of
       <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, U+0009, U+000A, and U+000D,
       <a data-link-type="dfn" href="#utf_8-percent-encode">utf-8 percent encode</a> <a data-link-type="dfn" href="#c">c</a> using the
       <a data-link-type="dfn" href="#simple-encode-set">simple encode set</a>, and append the result to the first string in
       <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a>.
      </p>
         </ol>
         
    
       </ol>
       

   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="query-state">query state<a class="self-link" href="#query-state"></a></dfn>
   
      <dd>
    
       <ol>
     
        <li>
      
         <p>If <a data-link-type="dfn" href="#c">c</a> is the <a data-link-type="dfn" href="#eof-code-point">EOF code point</a>, or
      <var>state override</var> is not given and <a data-link-type="dfn" href="#c">c</a>
      is "<code>#</code>", run these substeps:

      </p>
         <ol>
       
          <li>
           <p>If <var>url</var> <a data-link-type="dfn" href="#is-special">is <em>not</em> special</a> or
       <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is either "<code>ws</code>" or
       "<code>wss</code>", set <var>encoding override</var> to <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">utf-8</a>.
       

       </p>
          <li>
           <p>Set <var>buffer</var> to the result of
       <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encode">encoding</a>
       <var>buffer</var> using <var>encoding override</var>.

       </p>
          <li>
        
           <p>For each <var>byte</var> in <var>buffer</var> run
        these subsubsteps:

        </p>
           <ol>
         
            <li>
             <p>If <var>byte</var> is less than 0x21, greater than 0x7E, or is one of
         0x22, 0x23, 0x3C, and 0x3E, append <var>byte</var>,
         <a data-link-type="dfn" href="#percent-encode">percent encoded</a>, to <var>url</var>’s
         <a data-link-type="dfn" href="#concept-url-query">query</a>.

         </p>
            <li>
             <p>Otherwise, append a code point whose value is <var>byte</var> to
         <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>.
        </p>
           </ol>
           

       
          <li>
           <p>Set <var>buffer</var> to the empty string.

       </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>#</code>", set
       <var>url</var>’s
       <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty string,
       and state to <a data-link-type="dfn" href="#fragment-state">fragment state</a>.
      </p>
         </ol>
         

     
        <li>
         <p>Otherwise, if <a data-link-type="dfn" href="#c">c</a> is U+0009, U+000A, or U+000D,
     <a data-link-type="dfn" href="#parse-error">parse error</a>.

     </p>
        <li>
      
         <p>Otherwise, run these substeps:

      </p>
         <ol>
       
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is not a
       <a data-link-type="dfn" href="#url-code-points">URL code point</a> and not "<code>%</code>",
       <a data-link-type="dfn" href="#parse-error">parse error</a>.

       </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>%</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> does
       not start with two <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digits</a>, <a data-link-type="dfn" href="#parse-error">parse error</a>.

       </p>
          <li>
           <p>Append <a data-link-type="dfn" href="#c">c</a> to <var>buffer</var>.
      </p>
         </ol>
         
    
       </ol>
       

   
      <dt><dfn data-dfn-type="dfn" data-noexport="" id="fragment-state">fragment state<a class="self-link" href="#fragment-state"></a></dfn>
   
      <dd>
    
       <p>Based on <a data-link-type="dfn" href="#c">c</a>:
    </p>
       <dl class="switch">
     
        <dt><a data-link-type="dfn" href="#eof-code-point">EOF code point</a>
     
        <dd>
         <p>Do nothing.

     </p>
        <dt>U+0000
     
        <dt>U+0009
     
        <dt>U+000A
     
        <dt>U+000D
     
        <dd>
         <p><a data-link-type="dfn" href="#parse-error">Parse error</a>.

     </p>
        <dt>Otherwise
     
        <dd>
      
         <ol>
       
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is not a <a data-link-type="dfn" href="#url-code-points">URL code point</a> and not
       "<code>%</code>", <a data-link-type="dfn" href="#parse-error">parse error</a>.

       </p>
          <li>
           <p>If <a data-link-type="dfn" href="#c">c</a> is "<code>%</code>" and <a data-link-type="dfn" href="#remaining">remaining</a> does
       not start with two <a data-link-type="dfn" href="#ascii-hex-digits">ASCII hex digits</a>, <a data-link-type="dfn" href="#parse-error">parse error</a>.

       </p>
          <li>
        
           <p>Append <a data-link-type="dfn" href="#c">c</a> to <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a>.

        </p>
           <p class="note" role="note">Unfortunately not using <a data-link-type="dfn" href="#percent-encode">percent-encoding</a> is intentional as
        implementations with majority market share exhibit this behavior.
        
      </p>
         </ol>
         
    
       </dl>
       
  
     </dl>
     

 
    <li>
     <p>Return <var>url</var>.
</p></ol>


   <hr>


   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="set-the-username">set the username<a class="self-link" href="#set-the-username"></a></dfn> given a <var>url</var> and
<var>username</var>, run these steps:

</p>
   <ol>
 
    <li>
     <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to the
 empty string.

 </p>
    <li>
     <p>For each code point in <var>username</var>,
 <a data-link-type="dfn" href="#utf_8-percent-encode">utf-8 percent encode</a> it using the <a data-link-type="dfn" href="#username-encode-set">username encode set</a>, and
 append the result to <var>url</var>’s
 <a data-link-type="dfn" href="#concept-url-username">username</a>.
</p></ol>


   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="set-the-password">set the password<a class="self-link" href="#set-the-password"></a></dfn> given a <var>url</var> and
<var>password</var>, run these steps:

</p>
   <ol>
 
    <li>
     <p>If <var>password</var> is the empty string, set <var>url</var>’s
 <a data-link-type="dfn" href="#concept-url-password">password</a> to null.

 </p>
    <li>
  
     <p>Otherwise, run these substeps:

  </p>
     <ol>
   
      <li>
       <p>Set <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> to
   the empty string.

   </p>
      <li>
       <p>For each code point in <var>password</var>,
   <a data-link-type="dfn" href="#utf_8-percent-encode">utf-8 percent encode</a> it using the <a data-link-type="dfn" href="#password-encode-set">password encode set</a>, and
   append the result to <var>url</var>’s
   <a data-link-type="dfn" href="#concept-url-password">password</a>.
  </p>
     </ol>
     
</ol>



   <h3 class="heading settled" data-level="4.3" id="url-serializing"><span class="secno">4.3. </span><span class="content">URL serializing</span><a class="self-link" href="#url-serializing"></a></h3>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="concept-url-serializer">URL serializer<a class="self-link" href="#concept-url-serializer"></a></dfn> takes a
<a data-link-type="dfn" href="#concept-url">URL</a> <var>url</var>, an optional <i title="">exclude fragment flag</i>, and then runs
these steps:

</p>
   <ol>
 
    <li>
     <p>Let <var>output</var> be <var>url</var>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> and
 "<code>:</code>" concatenated.

 </p>
    <li>
  
     <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-host">host</a> is non-null:

  </p>
     <ol>
   
      <li>
       <p>Append "<code>//</code>" to <var>output</var>.

   </p>
      <li>
    
       <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> is not the empty string
    or <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> is non-null, run these substeps:

    </p>
       <ol>
     
        <li>
         <p>Append <var>url</var>’s <a data-link-type="dfn" href="#concept-url-username">username</a> to
     <var>output</var>.

     </p>
        <li>
         <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a> is non-null, append
     "<code>:</code>", followed by <var>url</var>’s <a data-link-type="dfn" href="#concept-url-password">password</a>, to
     <var>output</var>.

     </p>
        <li>
         <p>Append "<code>@</code>" to <var>output</var>.
    </p>
       </ol>
       

   
      <li>
       <p>Append <var>url</var>’s <a data-link-type="dfn" href="#concept-url-host">host</a>,
   <a data-link-type="dfn" href="#concept-host-serializer">serialized</a>, to <var>output</var>.

   </p>
      <li>
       <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> is not the empty string, append
   "<code>:</code>" followed by <var>url</var>’s <a data-link-type="dfn" href="#concept-url-port">port</a> to
   <var>output</var>.
  </p>
     </ol>
     

 
    <li>
     <p>If <var>url</var>’s <a data-link-type="dfn" href="#non_relative-flag">non-relative flag</a> is set, append the first string in
 <var>url</var>’s <a data-link-type="dfn" href="#concept-url-path">path</a> to <var>output</var>.

 </p>
    <li>
     <p>Otherwise, append "<code>/</code>", followed by the strings in <var>url</var>’s
 <a data-link-type="dfn" href="#concept-url-path">path</a> (including empty strings), separated from each other by
 "<code>/</code>", to <var>output</var>.

 </p>
    <li>
     <p>If <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a> is non-null, append
 "<code>?</code>", followed by <var>url</var>’s <a data-link-type="dfn" href="#concept-url-query">query</a>, to
 <var>output</var>.

 </p>
    <li>
     <p>If the <i title="">exclude fragment flag</i> is unset and <var>url</var>’s
 <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> is non-null, append "<code>#</code>", followed by
 <var>url</var>’s <a data-link-type="dfn" href="#concept-url-fragment">fragment</a>, to <var>output</var>.

 </p>
    <li>
     <p>Return <var>output</var>.
</p></ol>


   <h3 class="heading settled" data-level="4.4" id="origin"><span class="secno">4.4. </span><span class="content">Origin</span><a class="self-link" href="#origin"></a></h3>



   <p class="note" role="note">See <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#origin">origin</a>’s definition in HTML for the
necessary background information. <a data-link-type="biblio" href="#biblio-html">[HTML]</a>

</p>
   <p>A <a data-link-type="dfn" href="#concept-url">URL</a>’s <dfn data-dfn-type="dfn" data-lt="URL origin" data-noexport="" id="concept-url-origin">origin<a class="self-link" href="#concept-url-origin"></a></dfn> is
the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#origin">origin</a> returned by running these steps, switching
on <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>:

</p>
   <dl class="switch">
 
    <dt>"<code>blob</code>"
 
    <dd>
  
     <p>Let <var>url</var> be the result of <a data-link-type="dfn" href="#concept-basic-url-parser">parsing</a> the first
  string in <a data-link-type="dfn" href="#concept-url">URL</a>’s <a data-link-type="dfn" href="#concept-url-path">path</a>.

  </p>
     <p>If <var>url</var> is failure, return a new globally unique identifier. Otherwise,
  return <var>url</var>’s <a data-link-type="dfn" href="#concept-url-origin">origin</a>.
  

  </p>
     <p class="example no-backref" id="example-9b3f82d2"><a class="self-link" href="#example-9b3f82d2"></a>The <a data-link-type="dfn" href="#concept-url-origin">origin</a> of
  <code>blob:https://whatwg.org/d0360e2f-caee-469f-9a2f-87d5b0456f6f</code> is the tuple
  (<code>https</code>, <code>whatwg.org</code>, <code>443</code>).

 </p>
    <dt>"<code>ftp</code>"
 
    <dt>"<code>gopher</code>"
 
    <dt>"<code>http</code>"
 
    <dt>"<code>https</code>"
 
    <dt>"<code>ws</code>"
 
    <dt>"<code>wss</code>"
 
    <dd>
     <p>Return a tuple consisting of <a data-link-type="dfn" href="#concept-url">URL</a>’s
 <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>, its
 <a data-link-type="dfn" href="#concept-url-host">host</a>, and its <a data-link-type="dfn" href="#default-port">default port</a> if its
 <a data-link-type="dfn" href="#concept-url-port">port</a> is the empty string, and its
 <a data-link-type="dfn" href="#concept-url-port">port</a> otherwise.

 </p>
    <dt>"<code>file</code>"
 
    <dd>
     <p>Unfortunate as it is, this is left as an exercise to the reader. When in doubt,
 return a new globally unique identifier.

 </p>
    <dt>Otherwise
 
    <dd>
     <p>Return a new globally unique identifier.
</p></dl>



   <h2 class="heading settled" data-level="5" id="application/x-www-form-urlencoded"><span class="secno">5. </span><span class="content"><code data-lt="application-x-www-form-urlencoded-0"><a data-link-type="dfn" href="#application-x-www-form-urlencoded-0">application/x-www-form-urlencoded</a></code></span><a class="self-link" href="#application/x-www-form-urlencoded"></a></h2>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="application-x-www-form-urlencoded-0"><code>application/x-www-form-urlencoded</code><a class="self-link" href="#application-x-www-form-urlencoded-0"></a></dfn> format is a simple way to
encode name-value pairs in a byte sequence where all bytes are in the 0x00 to 0x7F range.

</p>
   <p class="note no-backref" role="note">While this description makes
<code data-lt="application-x-www-form-urlencoded-0"><a data-link-type="dfn" href="#application-x-www-form-urlencoded-0">application/x-www-form-urlencoded</a></code> sound dated — and really, it is — the
format is in widespread use due to its prevalence of HTML forms.
<a data-link-type="biblio" href="#biblio-html">[HTML]</a>

</p>
   <h3 class="heading settled" data-level="5.1" id="urlencoded-parsing"><span class="secno">5.1. </span><span class="content"><code data-lt="application-x-www-form-urlencoded-0">application/x-www-form-urlencoded</code> parsing</span><a class="self-link" href="#urlencoded-parsing"></a></h3>


   <p class="note no-backref" role="note">The features provided by the
<code data-lt="application-x-www-form-urlencoded-0"><a data-link-type="dfn" href="#concept-urlencoded-parser">application/x-www-form-urlencoded</a></code> parser
are mainly relevant for server-oriented implementations. A browser-based implementation
only needs what the
<code data-lt="application-x-www-form-urlencoded-0"><a data-link-type="dfn" href="#concept-urlencoded-string-parser">application/x-www-form-urlencoded</a></code> string parser
requires.

</p>
   <p>The
<dfn data-dfn-type="dfn" data-lt="urlencoded parser" data-noexport="" id="concept-urlencoded-parser"><code data-lt="application-x-www-form-urlencoded-0"><a data-link-type="dfn" href="#application-x-www-form-urlencoded-0">application/x-www-form-urlencoded</a></code> parser<a class="self-link" href="#concept-urlencoded-parser"></a></dfn>
takes a byte sequence <var>input</var>, optionally with an
<a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encoding">encoding</a> <var>encoding override</var>,
optionally with a <i title="">use _charset_ flag</i>, and optionally with an
<i title="">isindex flag</i>, and then runs these steps:

</p>
   <ol>
 
    <li>
     <p>If <var>encoding override</var> is not given, set it to
 <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">utf-8</a>.

 </p>
    <li>
  
     <p>If <var>encoding override</var> is not
  <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">utf-8</a> and <var>input</var> contains bytes
  whose value is greater than 0x7F, return failure.

  </p>
     <p class="note no-backref" role="note">This can only happen if <var>input</var> was not
  generated through the <a data-link-type="dfn" href="#concept-urlencoded-serializer">serializer</a> or
  <code><a class="idl-code" data-link-type="interface" href="#urlsearchparams">URLSearchParams</a></code>.

 </p>
    <li>
     <p>Let <var>sequences</var> be the result of splitting
 <var>input</var> on `<code>&amp;</code>`.
 

 </p>
    <li>
     <p>If the <i title="">isindex flag</i> is set and the first byte sequence in
 <var>sequences</var> does not contain a `<code>=</code>`, prepend
 `<code>=</code>` to the first byte sequence in <var>sequences</var>.

 </p>
    <li>
     <p>Let <var>pairs</var> be an empty list of name-value pairs where both name
 and value hold a byte sequence.

 </p>
    <li>
  
     <p>For each byte sequence <var>bytes</var> in <var>sequences</var>,
  run these substeps:

  </p>
     <ol>
   
      <li>
       <p>If <var>bytes</var> is the empty byte sequence, run these substeps for the
   next byte sequence.

   </p>
      <li>
       <p>If <var>bytes</var> contains a `<code>=</code>`, then let
   <var>name</var> be the bytes from the start of <var>bytes</var> up to but
   excluding its first `<code>=</code>`, and let <var>value</var> be the
   bytes, if any, after the first `<code>=</code>` up to the end of
   <var>bytes</var>. If `<code>=</code>` is the first byte, then
   <var>name</var> will be the empty byte sequence. If it is the last, then
   <var>value</var> will be the empty byte sequence.

   </p>
      <li>
       <p>Otherwise, let <var>name</var> have the value of <var>bytes</var>
   and let <var>value</var> be the empty byte sequence.

   </p>
      <li>
       <p>Replace any `<code>+</code>` in <var>name</var> and
   <var>value</var> with 0x20.

   </p>
      <li>
    
       <p>If <i title="">use _charset_ flag</i> is set and <var>name</var> is
    `<code>_charset_</code>`, run these substeps:

    </p>
       <ol>
     
        <li>
         <p>Let <var>result</var> be the result of
     <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#concept-encoding-get">getting an encoding</a>
     for <var>value</var>,
     <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decode-without-bom">decoded</a>.

     </p>
        <li>
         <p>If <var>result</var> is not failure, unset <i title="">use _charset_ flag</i> and
     set <var>encoding override</var> to <var>result</var>.
    </p>
       </ol>
       

   
      <li>
       <p>Add a pair consisting of <var>name</var> and
   <var>value</var> to <var>pairs</var>.
  </p>
     </ol>
     

 
    <li>
     <p>Let <var>output</var> be an empty list of name-value pairs where both name
 and value hold a string.

 </p>
    <li>
     <p>For each name-value pair in <var>pairs</var>, append a name-value pair to
 <var>output</var> where the new name and value appended to <var>output</var>
 are the result of running <var>encoding override</var>’s
 <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#decoder">decoder</a> on the
 <a data-link-type="dfn" href="#percent-decode">percent decoding</a> of the name and value from
 <var>pairs</var>, respectively.

 </p>
    <li>
     <p>Return <var>output</var>.
</p></ol>


   <h3 class="heading settled" data-level="5.2" id="urlencoded-serializing"><span class="secno">5.2. </span><span class="content"><code data-lt="application-x-www-form-urlencoded-0">application/x-www-form-urlencoded</code> serializing</span><a class="self-link" href="#urlencoded-serializing"></a></h3>


   <p>The
<dfn data-dfn-type="dfn" data-lt="urlencoded byte serializer" data-noexport="" id="concept-urlencoded-byte-serializer"><code data-lt="application-x-www-form-urlencoded-0"><a data-link-type="dfn" href="#application-x-www-form-urlencoded-0">application/x-www-form-urlencoded</a></code> byte serializer<a class="self-link" href="#concept-urlencoded-byte-serializer"></a></dfn>
takes a byte sequence <var>input</var> and then runs these steps:

</p>
   <ol>
 
    <li>
     <p>Let <var>output</var> be the empty string.
 </p>
    <li>
  
     <p>For each byte in <var>input</var>, depending on
  <var>byte</var>:

  </p>
     <dl>
   
      <dt>0x20
   
      <dd>
       <p>Append U+002B to <var>output</var>.

   </p>
      <dt>0x2A
   
      <dt>0x2D
   
      <dt>0x2E
   
      <dt>0x30 to 0x39
   
      <dt>0x41 to 0x5A
   
      <dt>0x5F
   
      <dt>0x61 to 0x7A
   
      <dd>
       <p>Append a code point whose value is <var>byte</var> to
   <var>output</var>.

   </p>
      <dt>Otherwise
   
      <dd>
       <p>Append <var>byte</var>,
   <a data-link-type="dfn" href="#percent-encode">percent encoded</a>, to
   <var>output</var>.
  </p>
     </dl>
     
 
    <li>
     <p>Return <var>output</var>.
</p></ol>



   <p>The
<dfn data-dfn-type="dfn" data-lt="urlencoded serializer" data-noexport="" id="concept-urlencoded-serializer"><code data-lt="application-x-www-form-urlencoded-0"><a data-link-type="dfn" href="#application-x-www-form-urlencoded-0">application/x-www-form-urlencoded</a></code> serializer<a class="self-link" href="#concept-urlencoded-serializer"></a></dfn>
takes a list of name-value pairs <var>pairs</var>, optionally with an
<a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encoding">encoding</a>
<var>encoding override</var>, and then runs these steps:

</p>
   <ol>
 
    <li>
     <p>If <var>encoding override</var> is not given, set it to
 <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">utf-8</a>.

 </p>
    <li>
     <p>Let <var>output</var> be the empty string.

 </p>
    <li>
  
     <p>For each <var>pair</var> in <var>pairs</var>, run
  these substeps:

  </p>
     <ol>
   
      <li>
       <p>Let <var>outputPair</var> be a copy of <var>pair</var>.

   </p>
      <li>
       <p>Replace <var>outputPair</var>’s name and value with the result of running
   <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encode">encode</a> on them using
   <var>encoding override</var>, respectively.

   </p>
      <li>
       <p>Replace <var>outputPair</var>’s name and value with their
   <a data-link-type="dfn" href="#concept-urlencoded-byte-serializer">serialization</a>.

   </p>
      <li>
       <p>If <var>pair</var> is not the first pair in <var>pairs</var>, append
   "<code>&amp;</code>" to <var>output</var>.

   </p>
      <li>
       <p>Append <var>outputPair</var>’s name, followed by "<code>=</code>",
   followed by <var>outputPair</var>’s value to <var>output</var>.
  </p>
     </ol>
     

 
    <li>Return <var>output</var>.
</ol>


   <h3 class="heading settled" data-level="5.3" id="urlencoded-hooks"><span class="secno">5.3. </span><span class="content">Hooks</span><a class="self-link" href="#urlencoded-hooks"></a></h3>


   <p>The
<dfn data-dfn-type="dfn" data-lt="urlencoded string parser" data-noexport="" id="concept-urlencoded-string-parser"><code data-lt="application-x-www-form-urlencoded-0"><a data-link-type="dfn" href="#application-x-www-form-urlencoded-0">application/x-www-form-urlencoded</a></code> string parser<a class="self-link" href="#concept-urlencoded-string-parser"></a></dfn>
takes a string <var>input</var>,
<a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-encode">utf-8 encodes</a> it, and then
returns the result of
<code data-lt="application-x-www-form-urlencoded-0"><a data-link-type="dfn" href="#concept-urlencoded-parser">application/x-www-form-urlencoded</a></code> parsing
it.



</p>
   <h2 class="heading settled" data-level="6" id="api"><span class="secno">6. </span><span class="content">API</span><a class="self-link" href="#api"></a></h2>


   <pre class="idl">[<a class="idl-code" data-link-type="constructor" href="#dom-url-url">Constructor</a>(USVString <dfn class="idl-code" data-dfn-for="URL/URL(url, base)" data-dfn-type="argument" data-export="" id="dom-url-url-url-base-url">url<a class="self-link" href="#dom-url-url-url-base-url"></a></dfn>, optional USVString <dfn class="idl-code" data-dfn-for="URL/URL(url, base)" data-dfn-type="argument" data-export="" id="dom-url-url-url-base-base">base<a class="self-link" href="#dom-url-url-url-base-base"></a></dfn>),
 Exposed=(Window,Worker)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="url">URL<a class="self-link" href="#url"></a></dfn> {
  static USVString <a class="idl-code" data-link-type="method" href="#dom-url-domaintoascii">domainToASCII</a>(USVString <dfn class="idl-code" data-dfn-for="URL/domainToASCII(domain)" data-dfn-type="argument" data-export="" id="dom-url-domaintoascii-domain-domain">domain<a class="self-link" href="#dom-url-domaintoascii-domain-domain"></a></dfn>);
  static USVString <a class="idl-code" data-link-type="method" href="#dom-url-domaintounicode">domainToUnicode</a>(USVString <dfn class="idl-code" data-dfn-for="URL/domainToUnicode(domain)" data-dfn-type="argument" data-export="" id="dom-url-domaintounicode-domain-domain">domain<a class="self-link" href="#dom-url-domaintounicode-domain-domain"></a></dfn>);
};
<a data-link-type="idl-name" href="#url">URL</a> implements <a data-link-type="idl-name" href="#urlutils">URLUtils</a>;
<a data-link-type="idl-name" href="#url">URL</a> implements <a data-link-type="idl-name" href="#urlutilssearchparams">URLUtilsSearchParams</a>;

[NoInterfaceObject,
 Exposed=(Window,Worker)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="urlutils">URLUtils<a class="self-link" href="#urlutils"></a></dfn> {
  <dfn data-dfn-for="URLUtils" data-dfn-type="dfn" data-lt="stringification behavior" data-noexport="" id="URLUtils-stringification-behavior">stringifier<a class="self-link" href="#URLUtils-stringification-behavior"></a></dfn> attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-href">href</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-origin">origin</a>;

           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-protocol">protocol</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-username">username</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-password">password</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-host">host</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-hostname">hostname</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-port">port</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-pathname">pathname</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-search">search</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-hash">hash</a>;
};

[NoInterfaceObject,
 Exposed=(Window, Worker)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="urlutilssearchparams">URLUtilsSearchParams<a class="self-link" href="#urlutilssearchparams"></a></dfn> {
           attribute <a data-link-type="idl-name" href="#urlsearchparams">URLSearchParams</a> <a class="idl-code" data-link-type="attribute" data-type="URLSearchParams " href="#dom-urlutilssearchparams-searchparams">searchParams</a>;
};

[NoInterfaceObject,
 Exposed=(Window,Worker)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="urlutilsreadonly">URLUtilsReadOnly<a class="self-link" href="#urlutilsreadonly"></a></dfn> {
  <dfn data-dfn-for="URLUtilsReadOnly" data-dfn-type="dfn" data-lt="stringification behavior" data-noexport="" id="URLUtilsReadOnly-stringification-behavior">stringifier<a class="self-link" href="#URLUtilsReadOnly-stringification-behavior"></a></dfn> readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-href">href</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-origin">origin</a>;

  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-protocol">protocol</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-host">host</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-hostname">hostname</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-port">port</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-pathname">pathname</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-search">search</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-hash">hash</a>;
};
</pre>


   <p>Except where different objects implementing <code class="idl"><a data-link-type="idl" href="#urlutilsreadonly">URLUtilsReadOnly</a></code> are identical to
objects implementing <code class="idl"><a data-link-type="idl" href="#urlutils">URLUtils</a></code>. <code class="idl"><a data-link-type="idl" href="#dom-urlutilssearchparams-searchparams">searchParams</a></code> is on its own
interface since <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/browsers.html#location">Location</a></code> cannot support it. <a data-link-type="biblio" href="#biblio-html">[HTML]</a>

</p>
   <p class="note" role="note">Since all members are readonly and certain members from <code class="idl"><a data-link-type="idl" href="#urlutils">URLUtils</a></code> are not
exposed a number of potential optimizations is possible compared to objects implementing
<code class="idl"><a data-link-type="idl" href="#urlutils">URLUtils</a></code>. These are left as an exercise to the reader.

</p>


   <p>Specifications defining objects implementing <code class="idl"><a data-link-type="idl" href="#urlutils">URLUtils</a></code>/<code class="idl"><a data-link-type="idl" href="#urlutilssearchparams">URLUtilsSearchParams</a></code> or
<code class="idl"><a data-link-type="idl" href="#urlutilsreadonly">URLUtilsReadOnly</a></code> must define a
<dfn data-dfn-type="dfn" data-noexport="" id="concept-urlutils-get-the-base">get the base<a class="self-link" href="#concept-urlutils-get-the-base"></a></dfn> algorithm, which must return the
appropriate <a data-link-type="dfn" href="#concept-base-url">base URL</a> for the object.

</p>
   <p>Specifications defining objects implementing <code class="idl"><a data-link-type="idl" href="#urlutils">URLUtils</a></code> may define
<dfn data-dfn-type="dfn" data-lt="URLUtils update" data-noexport="" id="concept-urlutils-update">update steps<a class="self-link" href="#concept-urlutils-update"></a></dfn> to make it
possible for an underlying string (such as an
<a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-attribute-value">attribute value</a>)
to be updated. The <a data-link-type="dfn" href="#concept-urlutils-update">update steps</a> are passed a string
<var>value</var> for this purpose.

</p>
   <p>An object implementing <code class="idl"><a data-link-type="idl" href="#urlutils">URLUtils</a></code> or <code class="idl"><a data-link-type="idl" href="#urlutilsreadonly">URLUtilsReadOnly</a></code> has an
associated <dfn data-dfn-type="dfn" data-lt="URLUtils input" data-noexport="" id="concept-urlutils-input">input<a class="self-link" href="#concept-urlutils-input"></a></dfn> (a string),
<dfn data-dfn-type="dfn" data-lt="URLUtils query encoding" data-noexport="" id="concept-urlutils-query-encoding">query encoding<a class="self-link" href="#concept-urlutils-query-encoding"></a></dfn>
(an <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encoding">encoding</a>),
<dfn data-dfn-type="dfn" data-lt="URLUtils query object" data-noexport="" id="concept-urlutils-query-object">query object<a class="self-link" href="#concept-urlutils-query-object"></a></dfn>
(a <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object or null), and a
<dfn data-dfn-type="dfn" data-lt="URLUtils URL" data-noexport="" id="concept-urlutils-url">url<a class="self-link" href="#concept-urlutils-url"></a></dfn> (a <a data-link-type="dfn" href="#concept-url">URL</a> or null).

</p>
   <p>Unless stated otherwise, <a data-link-type="dfn" href="#concept-urlutils-query-encoding">query encoding</a> is
<a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">utf-8</a> and
<a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a> is null. The others follow
from the <a data-link-type="dfn" href="#concept-urlutils-set-the-input">set the input</a> algorithm.</p>


   <p class="note" role="note">The associated
<a data-link-type="dfn" href="#concept-urlutils-query-encoding">query encoding</a> is a legacy
concept only relevant for HTML.
<a data-link-type="biblio" href="#biblio-html">[HTML]</a>

</p>
   <p>Specifications defining objects implementing <code class="idl"><a data-link-type="idl" href="#urlutils">URLUtils</a></code>/<code class="idl"><a data-link-type="idl" href="#urlutilssearchparams">URLUtilsSearchParams</a></code> or
<code class="idl"><a data-link-type="idl" href="#urlutilsreadonly">URLUtilsReadOnly</a></code> must use the <a data-link-type="dfn" href="#concept-urlutils-set-the-input">set the input</a>
algorithms to set <a data-link-type="dfn" href="#concept-urlutils-input">input</a>, <a data-link-type="dfn" href="#concept-urlutils-url">url</a>, and
<a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a>. To
<dfn data-dfn-type="dfn" data-lt="URLUtils set the input" data-noexport="" id="concept-urlutils-set-the-input">set the input<a class="self-link" href="#concept-urlutils-set-the-input"></a></dfn>
given <var>input</var> and optionally a <var>url</var>, run these steps:

</p>
   <ol>
 
    <li>
     <p>If <var>url</var> is given, set <a data-link-type="dfn" href="#concept-urlutils-url">url</a>
 to <var>url</var> and <a data-link-type="dfn" href="#concept-urlutils-input">input</a> to
 <var>input</var>.

 </p>
    <li>
  
     <p>Otherwise, run these substeps:

  </p>
     <ol>
   
      <li>
       <p>Set <a data-link-type="dfn" href="#concept-urlutils-url">url</a> to null.

   </p>
      <li>
       <p>If <var>input</var> is null, set
   <a data-link-type="dfn" href="#concept-urlutils-input">input</a> to the empty string.

   </p>
      <li>
    
       <p>Otherwise, run these subsubsteps:

    </p>
       <ol>
     
        <li>
         <p>Set <a data-link-type="dfn" href="#concept-urlutils-input">input</a> to <var>input</var>.

     </p>
        <li>
         <p>Let <var>url</var> be the result of running the
     <a data-link-type="dfn" href="#concept-url-parser">URL parser</a> on
     <a data-link-type="dfn" href="#concept-urlutils-input">input</a> with
     <a data-link-type="dfn" href="#concept-base-url">base URL</a> being the result of running
     <a data-link-type="dfn" href="#concept-urlutils-get-the-base">get the base</a> and
     <a data-link-type="dfn" href="#concept-urlutils-query-encoding">query encoding</a> as
     <var>encoding override</var>.
     

     </p>
        <li>
         <p>If <var>url</var> is not failure, set
     <a data-link-type="dfn" href="#concept-urlutils-url">url</a> to <var>url</var>.
    </p>
       </ol>
       
  
     </ol>
     

 
    <li>
     <p>Let <var>query</var> be <a data-link-type="dfn" href="#concept-urlutils-url">url</a>’s <a data-link-type="dfn" href="#concept-url-query">query</a>
 if <a data-link-type="dfn" href="#concept-urlutils-url">url</a> and its <a data-link-type="dfn" href="#concept-url-query">query</a> are non-null, and the
 empty string otherwise.

 </p>
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a> is null, set
 <a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a> to a
 <a data-link-type="dfn" href="#concept-urlsearchparams-new">new <code>URLSearchParams</code> object</a>
 using <var>query</var>, and then append the
 <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a> to
 <a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a>’s list of
 <a data-link-type="dfn" href="#concept-urlsearchparams-url-object">url objects</a>.

 </p>
    <li>
     <p>Otherwise, set <a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a>’s
 <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a> to the result of
 <a data-link-type="dfn" href="#concept-urlencoded-string-parser">parsing</a> <var>query</var>.
</p></ol>


   <p>To run the <dfn data-dfn-type="dfn" data-noexport="" id="pre_update-steps">pre-update steps<a class="self-link" href="#pre_update-steps"></a></dfn> for an object implementing <code class="idl"><a data-link-type="idl" href="#urlutils">URLUtils</a></code>,
optionally given a <var>value</var>, run these steps:

</p>
   <ol>
 
    <li>
     <p>If <var>value</var> is not given, let <var>value</var> be the result
 of <a data-link-type="dfn" href="#concept-url-serializer">serializing</a> the associated
 <a data-link-type="dfn" href="#concept-urlutils-url">url</a>.
 

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#concept-urlutils-update">update steps</a> with
 <var>value</var>.
</p></ol>



   <h3 class="heading settled" data-level="6.1" id="constructors"><span class="secno">6.1. </span><span class="content">Constructors</span><a class="self-link" href="#constructors"></a></h3> 


   <p>The
<dfn class="idl-code" data-dfn-for="URL" data-dfn-type="constructor" data-export="" id="dom-url-url"><code>URL(<var>url</var>, <var>base</var>)</code><a class="self-link" href="#dom-url-url"></a></dfn>
constructor, when invoked, must run these steps:

</p>
   <ol>
 
    <li>
     <p>Let <var>parsedBase</var> be null.

 </p>
    <li>
  
     <p>If <var>base</var> is given, run these substeps:

  </p>
     <ol>
   
      <li>
       <p>Let <var>parsedBase</var> be the result of running the <a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parser</a>
   on <var>base</var>.

   </p>
      <li>
       <p>If <var>parsedBase</var> is failure, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> a <code>TypeError</code>
   exception.
  </p>
     </ol>
     

 
    <li>
     <p>Let <var>parsedURL</var> be the result of running the <a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parser</a> on
 <var>url</var> with <var>parsedBase</var>.

 </p>
    <li>
     <p>If <var>parsedURL</var> is failure, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> a <code>TypeError</code>
 exception.

 </p>
    <li>
     <p>Let <var>result</var> be a new <code class="idl"><a data-link-type="idl" href="#url">URL</a></code> object.

 </p>
    <li>
     <p>Let <var>result</var>’s <a data-link-type="dfn" href="#concept-urlutils-get-the-base">get the base</a> return <var>parsedBase</var>.

 </p>
    <li>
  
     <p>Run <var>result</var>’s
  <a data-link-type="dfn" href="#concept-urlutils-set-the-input">set the input</a> given the empty string
  and <var>parsedURL</var>.

  </p>
     <p class="note no-backref" role="note">A <code class="idl"><a data-link-type="idl" href="#url">URL</a></code> object’s
  <a data-link-type="dfn" href="#concept-urlutils-input">input</a> is never exposed.

 </p>
    <li>
     <p>Return <var>result</var>.
</p></ol>


   <div class="example" id="example-d32a71ef"><a class="self-link" href="#example-d32a71ef"></a>
 
    <p>To <a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> a string into a
 <a data-link-type="dfn" href="#concept-url">URL</a> without using a
 <a data-link-type="dfn" href="#concept-base-url">base URL</a>, invoke the constructor with a single
 argument:

 </p>
    <pre>var input = "https://example.org/💩",    url = new URL(input)
url.pathname // "/%F0%9F%92%A9"</pre>

 
    <p>Alternatively you can use the <a data-link-type="dfn" href="#concept-base-url">base URL</a> of a
 <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">document</a> through
 <code><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#dom-node-baseuri">baseURI</a></code>:

 </p>
    <pre>var input = "/💩",    url = new URL(input, document.baseURI)
url.href // "https://url.spec.whatwg.org/%F0%9F%92%A9"</pre>
</div>



   <h3 class="heading settled" data-level="6.2" id="url-statics"><span class="secno">6.2. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#url">URL</a></code> statics</span><a class="self-link" href="#url-statics"></a></h3>


   <p>The
<dfn class="idl-code" data-dfn-for="URL" data-dfn-type="method" data-export="" id="dom-url-domaintoascii"><code>domainToASCII(<var>domain</var>)</code><a class="self-link" href="#dom-url-domaintoascii"></a></dfn>
static method, when invoked, must run these steps:

</p>
   <ol>
 
    <li>
     <p>Let <var>asciiDomain</var> be the result of
 <a data-link-type="dfn" href="#concept-host-parser">host parsing</a> <var>domain</var>.

 </p>
    <li>
     <p>If <var>asciiDomain</var> is an <a data-link-type="dfn" href="#concept-ipv4">IPv4 address</a>, <a data-link-type="dfn" href="#concept-ipv6">IPv6 address</a>, or
 failure, return the empty string.

 </p>
    <li>
     <p>Return <var>asciiDomain</var>.
</p></ol>


   <p>The
<dfn class="idl-code" data-dfn-for="URL" data-dfn-type="method" data-export="" id="dom-url-domaintounicode"><code>domainToUnicode(<var>domain</var>)</code><a class="self-link" href="#dom-url-domaintounicode"></a></dfn>
static method, when invoked, must run these steps:

</p>
   <ol>
 
    <li>
     <p>Let <var>unicodeDomain</var> be the result of
 <a data-link-type="dfn" href="#concept-host-parser">host parsing</a> <var>domain</var> with the
 <var>Unicode flag</var> set.

 </p>
    <li>
     <p>If <var>unicodeDomain</var> is an <a data-link-type="dfn" href="#concept-ipv4">IPv4 address</a>, <a data-link-type="dfn" href="#concept-ipv6">IPv6 address</a>, or
 failure, return the empty string.

 </p>
    <li>
     <p>Return <var>unicodeDomain</var>.
</p></ol>


   <p class="XXX">Add domainToUI() which follows the UA conventions for when to use the Unicode
representation?


</p>
   <h3 class="heading settled" data-level="6.3" id="urlutils-and-urlutilsreadonly-members"><span class="secno">6.3. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#urlutils">URLUtils</a></code>/<code class="idl"><a data-link-type="idl" href="#urlutilssearchparams">URLUtilsSearchParams</a></code> and <code class="idl"><a data-link-type="idl" href="#urlutilsreadonly">URLUtilsReadOnly</a></code> members</span><a class="self-link" href="#urlutils-and-urlutilsreadonly-members"></a></h3>


   <p class="note" role="note">The <code class="idl"><a data-link-type="idl" href="#urlutils">URLUtils</a></code>/<code class="idl"><a data-link-type="idl" href="#urlutilssearchparams">URLUtilsSearchParams</a></code> and <code class="idl"><a data-link-type="idl" href="#urlutilsreadonly">URLUtilsReadOnly</a></code>
interfaces are not exposed on the global object. They are mixins for other objects, such
as <code class="idl"><a data-link-type="idl" href="#url">URL</a></code>.

</p>
   <p>The <dfn class="idl-code" data-dfn-for="URLUtils, URLUtilsReadOnly" data-dfn-type="attribute" data-export="" id="dom-urlutils-href"><code>href</code><a class="self-link" href="#dom-urlutils-href"></a></dfn>
attribute’s getter must run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, return
 <a data-link-type="dfn" href="#concept-urlutils-input">input</a>.

 </p>
    <li>
     <p>Return the <a data-link-type="dfn" href="#concept-url-serializer">serialization</a>
 of <a data-link-type="dfn" href="#concept-urlutils-url">url</a>.
</p></ol>


   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-urlutils-href">href</a></code> attribute’s
setter must run these steps:

</p>
   <ol>
 
    <li>
     <p>Let <var>input</var> be the given value.

 </p>
    <li>
  
     <p>If the <code><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a></code> is a <code class="idl"><a data-link-type="idl" href="#url">URL</a></code> object, run these substeps:

  </p>
     <ol>
   
      <li>
       <p>Let <var>parsedURL</var> be the result of running the
   <a data-link-type="dfn" href="#concept-basic-url-parser">basic URL parser</a> on <var>input</var>
   with <a data-link-type="dfn" href="#concept-base-url">base URL</a> being the result of running
   <a data-link-type="dfn" href="#concept-urlutils-get-the-base">get the base</a>.

   </p>
      <li>
       <p>If <var>parsedURL</var> is failure,
   <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> a <code>TypeError</code> exception.

   </p>
      <li>
    
       <p>Run <a data-link-type="dfn" href="#concept-urlutils-set-the-input">set the input</a> given the empty
    string and <var>parsedURL</var>.

    </p>
       <p class="note no-backref" role="note">A <code class="idl"><a data-link-type="idl" href="#url">URL</a></code> object’s <a data-link-type="dfn" href="#concept-urlutils-input">input</a> is
    never exposed.
  </p>
     </ol>
     

 
    <li>
  
     <p>Otherwise, run these substeps:

  </p>
     <ol>
   
      <li>
       <p>Run the <a data-link-type="dfn" href="#concept-urlutils-set-the-input">set the input</a>
   algorithm for <var>input</var>.

   </p>
      <li>
       <p>Run the <a data-link-type="dfn" href="#pre_update-steps">pre-update steps</a> with the <var>input</var>.
  </p>
     </ol>
     

  
     <div class="example" id="example-89284f3f"><a class="self-link" href="#example-89284f3f"></a>
   
      <p>This means that if the <code><a class="idl-code" data-link-type="attribute" href="#dom-urlutils-href">href</a></code> attribute is set to
   value that would cause the <a data-link-type="dfn" href="#concept-url-parser">URL parser</a> to return
   failure, that value is still passed through unchanged. This is one of those unfortunate
   legacy incidents.

   </p>
      <pre>var a = document.createElement("a"),    input = "https://test:test/" // invalid port makes the parser return failure
a.href = test
a.href === test // true</pre>
      
  
     </div>
     
</ol>


   <p>The <dfn class="idl-code" data-dfn-for="URLUtils, URLUtilsReadOnly" data-dfn-type="attribute" data-export="" id="dom-urlutils-origin"><code>origin</code><a class="self-link" href="#dom-urlutils-origin"></a></dfn>
attribute’s getter must run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, return the empty
 string.

 </p>
    <li>
     <p>Return the
 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#unicode-serialisation-of-an-origin">Unicode serialization</a>
 of <a data-link-type="dfn" href="#concept-urlutils-url">url</a>’s <a data-link-type="dfn" href="#concept-url-origin">origin</a>.
 <a data-link-type="biblio" href="#biblio-html">[HTML]</a>
</p></ol>


   <p class="note" role="note">It returns the Unicode rather than the ASCII serialization for
compatibility with HTML’s <code>MessageEvent</code> feature.
<a data-link-type="biblio" href="#biblio-html">[HTML]</a>

</p>
   <p>The <dfn class="idl-code" data-dfn-for="URLUtils, URLUtilsReadOnly" data-dfn-type="attribute" data-export="" id="dom-urlutils-protocol"><code>protocol</code><a class="self-link" href="#dom-urlutils-protocol"></a></dfn>
attribute’s getter must run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, return "<code>:</code>".

 </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#concept-url-scheme">scheme</a>, followed by "<code>:</code>".
</p></ol>


   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-urlutils-protocol">protocol</a></code> attribute’s setter must run
these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, terminate these steps.

 </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> the given value, followed by
 "<code>:</code>", with <a data-link-type="dfn" href="#concept-urlutils-url">url</a> as <var>url</var> and
 <a data-link-type="dfn" href="#scheme-start-state">scheme start state</a> as <var>state override</var>.

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#pre_update-steps">pre-update steps</a>.
</p></ol>


   <p>The <dfn class="idl-code" data-dfn-for="URLUtils, URLUtilsReadOnly" data-dfn-type="attribute" data-export="" id="dom-urlutils-username"><code>username</code><a class="self-link" href="#dom-urlutils-username"></a></dfn>
attribute’s getter must run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, return the empty string.

 </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#concept-url-username">username</a>.
</p></ol>


   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-urlutils-username">username</a></code> attribute’s setter must
run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, its <a data-link-type="dfn" href="#concept-url-host">host</a> is null, or
 its <a data-link-type="dfn" href="#non_relative-flag">non-relative flag</a> is set, terminate these steps.

 </p>
    <li>
     <p><a data-link-type="dfn" href="#set-the-username">Set the username</a> given <a data-link-type="dfn" href="#concept-urlutils-url">url</a> and the given value.

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#pre_update-steps">pre-update steps</a>.
</p></ol>


   <p>The <dfn class="idl-code" data-dfn-for="URLUtils, URLUtilsReadOnly" data-dfn-type="attribute" data-export="" id="dom-urlutils-password"><code>password</code><a class="self-link" href="#dom-urlutils-password"></a></dfn>
attribute’s getter must run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null or its <a data-link-type="dfn" href="#concept-url-password">password</a>
 is null, return the empty string.

 </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#concept-url-password">password</a>.
</p></ol>


   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-urlutils-password">password</a></code> attribute’s setter must
run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, its <a data-link-type="dfn" href="#concept-url-host">host</a> is null, or
 its <a data-link-type="dfn" href="#non_relative-flag">non-relative flag</a> is set, terminate these steps.

 </p>
    <li>
     <p><a data-link-type="dfn" href="#set-the-password">Set the password</a> given <a data-link-type="dfn" href="#concept-urlutils-url">url</a>
 and the given value.

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#pre_update-steps">pre-update steps</a>.
</p></ol>


   <p>The <dfn class="idl-code" data-dfn-for="URLUtils, URLUtilsReadOnly" data-dfn-type="attribute" data-export="" id="dom-urlutils-host"><code>host</code><a class="self-link" href="#dom-urlutils-host"></a></dfn> attribute’s
getter must run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, or its <a data-link-type="dfn" href="#concept-url-host">host</a> is null,
 return the empty string.

 </p>
    <li>
     <p>If <a data-link-type="dfn" href="#concept-url-port">port</a> is the empty string, return
 <a data-link-type="dfn" href="#concept-url-host">host</a>, <a data-link-type="dfn" href="#concept-host-serializer">serialized</a>.

 </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#concept-url-host">host</a>, <a data-link-type="dfn" href="#concept-host-serializer">serialized</a>, followed
 by "<code>:</code>" and <a data-link-type="dfn" href="#concept-url-port">port</a>.
</p></ol>


   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-urlutils-host">host</a></code> attribute’s setter must run these
steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, or its <a data-link-type="dfn" href="#non_relative-flag">non-relative flag</a> is set,
 terminate these steps.

 </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> the given value with
 <a data-link-type="dfn" href="#concept-urlutils-url">url</a> as <var>url</var> and <a data-link-type="dfn" href="#host-state">host state</a> as
 <var>state override</var>.

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#pre_update-steps">pre-update steps</a>.
</p></ol>


   <p>The <dfn class="idl-code" data-dfn-for="URLUtils, URLUtilsReadOnly" data-dfn-type="attribute" data-export="" id="dom-urlutils-hostname"><code>hostname</code><a class="self-link" href="#dom-urlutils-hostname"></a></dfn>
attribute’s getter must run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, or its <a data-link-type="dfn" href="#concept-url-host">host</a> is null,
 return the empty string.

 </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#concept-url-host">host</a>, <a data-link-type="dfn" href="#concept-host-serializer">serialized</a>.
</p></ol>


   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-urlutils-hostname">hostname</a></code> attribute’s setter must
run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, or its <a data-link-type="dfn" href="#non_relative-flag">non-relative flag</a> is set,
 terminate these steps.

 </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> the given value with
 <a data-link-type="dfn" href="#concept-urlutils-url">url</a> as <var>url</var> and <a data-link-type="dfn" href="#hostname-state">hostname state</a> as
 <var>state override</var>.

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#pre_update-steps">pre-update steps</a>.
</p></ol>


   <p>The <dfn class="idl-code" data-dfn-for="URLUtils, URLUtilsReadOnly" data-dfn-type="attribute" data-export="" id="dom-urlutils-port"><code>port</code><a class="self-link" href="#dom-urlutils-port"></a></dfn> attribute’s getter must run
these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, return the empty string.

 </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#concept-url-port">port</a>.
</p></ol>


   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-urlutils-port">port</a></code> attribute’s setter must run these
steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, its <a data-link-type="dfn" href="#concept-url-host">host</a> is null,
 its <a data-link-type="dfn" href="#non_relative-flag">non-relative flag</a> is set, or its <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is
 "<code>file</code>", terminate these steps.

 </p>
    <li>
     <p>Otherwise, <a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> the given value with
 <a data-link-type="dfn" href="#concept-urlutils-url">url</a> as <var>url</var> and <a data-link-type="dfn" href="#port-state">port state</a> as
 <var>state override</var>.

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#pre_update-steps">pre-update steps</a>.
</p></ol>


   <p>The <dfn class="idl-code" data-dfn-for="URLUtils, URLUtilsReadOnly" data-dfn-type="attribute" data-export="" id="dom-urlutils-pathname"><code>pathname</code><a class="self-link" href="#dom-urlutils-pathname"></a></dfn>
attribute’s getter must run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, return the empty string.

 </p>
    <li>
     <p>If the <a data-link-type="dfn" href="#non_relative-flag">non-relative flag</a> is set, return the first string in
 <a data-link-type="dfn" href="#concept-url-path">path</a>.

 </p>
    <li>
     <p>Return "<code>/</code>", followed by the strings in <a data-link-type="dfn" href="#concept-url-path">path</a>
 (including empty strings), separated from each other by "<code>/</code>".
</p></ol>


   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-urlutils-pathname">pathname</a></code> attribute’s setter must
run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, or its
 <a data-link-type="dfn" href="#non_relative-flag">non-relative flag</a> is set, terminate these steps.

 </p>
    <li>
     <p>Empty <a data-link-type="dfn" href="#concept-url-path">path</a>.

 </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> the given value with
 <a data-link-type="dfn" href="#concept-urlutils-url">url</a> as <var>url</var> and <a data-link-type="dfn" href="#path-start-state">path start state</a> as
 <var>state override</var>.

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#pre_update-steps">pre-update steps</a>.
</p></ol>


   <p>The <dfn class="idl-code" data-dfn-for="URLUtils, URLUtilsReadOnly" data-dfn-type="attribute" data-export="" id="dom-urlutils-search"><code>search</code><a class="self-link" href="#dom-urlutils-search"></a></dfn>
attribute’s getter must run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, or its <a data-link-type="dfn" href="#concept-url-query">query</a> is
 either null or the empty string, return the empty string.

 </p>
    <li>
     <p>Return "<code>?</code>", followed by <a data-link-type="dfn" href="#concept-url-query">query</a>.
</p></ol>


   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-urlutils-search">search</a></code> attribute’s setter must run these
steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, terminate these steps.

 </p>
    <li>
     <p>If the given value is the empty string, set
 <a data-link-type="dfn" href="#concept-url-query">query</a> to null, empty
 <a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a>’s
 <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>, run its
 <a data-link-type="dfn" href="#concept-urlsearchparams-update">update steps</a>, and terminate these
 steps.

 </p>
    <li>
     <p>Let <var>input</var> be the given value with a single leading
 "<code>?</code>" removed, if any.

 </p>
    <li>
     <p>Set <a data-link-type="dfn" href="#concept-url-query">query</a> to the empty string.

 </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> <var>input</var>
 with <a data-link-type="dfn" href="#concept-urlutils-url">url</a> as <var>url</var>,
 <a data-link-type="dfn" href="#query-state">query state</a> as <var>state override</var>, and the
 associated <a data-link-type="dfn" href="#concept-urlutils-query-encoding">query encoding</a> as
 <var>encoding override</var>.

 </p>
    <li>
     <p>Set <a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a>’s
 <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a> to the result of
 <a data-link-type="dfn" href="#concept-urlencoded-string-parser">parsing</a> <var data-lt="">input</var>.

 </p>
    <li>
     <p>Run <a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a>’s
 <a data-link-type="dfn" href="#concept-urlsearchparams-update">update steps</a>.
</p></ol>


   <p class="note no-backref" role="note">The <a data-link-type="dfn" href="#concept-urlsearchparams-update">update steps</a> of
<a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a> are run to ensure all
<a data-link-type="dfn" href="#concept-urlsearchparams-url-object">url objects</a> remain synchronized.

</p>
   <p>The <dfn class="idl-code" data-dfn-for="URLUtilsSearchParams" data-dfn-type="attribute" data-export="" id="dom-urlutilssearchparams-searchparams"><code>searchParams</code><a class="self-link" href="#dom-urlutilssearchparams-searchparams"></a></dfn> attribute’s
getter must return the <a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a>.

</p>
   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-urlutilssearchparams-searchparams">searchParams</a></code> attribute’s
setter must run these steps:

</p>
   <ol>
 
    <li>
     <p>Let <var>object</var> be the given value.

 </p>
    <li>
     <p>Remove the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a> from
 <a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a>’s list of
 <a data-link-type="dfn" href="#concept-urlsearchparams-url-object">url objects</a>.

 </p>
    <li>
     <p>Append the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a> to
 <var>object</var>’s list of
 <a data-link-type="dfn" href="#concept-urlsearchparams-url-object">url objects</a>.

 </p>
    <li>
     <p>Set <a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a> to
 <var>object</var>.

 </p>
    <li>
     <p>Set <a data-link-type="dfn" href="#concept-url-query">query</a> to the
 <a data-link-type="dfn" href="#concept-urlencoded-serializer">serialization</a> of the
 <a data-link-type="dfn" href="#concept-urlutils-query-object">query object</a>’s
 <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>.

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#pre_update-steps">pre-update steps</a>.
</p></ol>


   <p>The <dfn class="idl-code" data-dfn-for="URLUtils, URLUtilsReadOnly" data-dfn-type="attribute" data-export="" id="dom-urlutils-hash"><code>hash</code><a class="self-link" href="#dom-urlutils-hash"></a></dfn> attribute’s
getter must run these steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, or its <a data-link-type="dfn" href="#concept-url-fragment">fragment</a>
 is either null or the empty string, return the empty string.

 </p>
    <li>
     <p>Return "<code>#</code>", followed by <a data-link-type="dfn" href="#concept-url-fragment">fragment</a>.
</p></ol>


   <p>The <code><a class="idl-code" data-link-type="attribute" href="#dom-urlutils-hash">hash</a></code> attribute’s setter must run these
steps:

</p>
   <ol>
 
    <li>
     <p>If <a data-link-type="dfn" href="#concept-urlutils-url">url</a> is null, or its <a data-link-type="dfn" href="#concept-url-scheme">scheme</a> is
 "<code>javascript</code>", terminate these steps.

 </p>
    <li>
     <p>If the given value is the empty string, set <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to
 null, run the <a data-link-type="dfn" href="#pre_update-steps">pre-update steps</a>, and terminate these steps.

 </p>
    <li>
     <p>Let <var>input</var> be the given value with a single leading "<code>#</code>"
 removed, if any.

 </p>
    <li>
     <p>Set <a data-link-type="dfn" href="#concept-url-fragment">fragment</a> to the empty string.

 </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-basic-url-parser">Basic URL parse</a> <var>input</var> with
 <a data-link-type="dfn" href="#concept-urlutils-url">url</a> as <var>url</var> and <a data-link-type="dfn" href="#fragment-state">fragment state</a> as
 <var>state override</var>.

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#pre_update-steps">pre-update steps</a>.
</p></ol>



   <h3 class="heading settled" data-level="6.4" id="interface-urlsearchparams"><span class="secno">6.4. </span><span class="content">Interface <code><a class="idl-code" data-link-type="interface" href="#urlsearchparams">URLSearchParams</a></code></span><a class="self-link" href="#interface-urlsearchparams"></a></h3>


   <pre class="idl">[<a class="idl-code" data-link-type="constructor" href="#dom-urlsearchparams-urlsearchparams">Constructor</a>(optional (USVString or <a data-link-type="idl-name" href="#urlsearchparams">URLSearchParams</a>) <dfn class="idl-code" data-dfn-for="URLSearchParams/URLSearchParams(init)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-urlsearchparams-init-init">init<a class="self-link" href="#dom-urlsearchparams-urlsearchparams-init-init"></a></dfn> = ""),
 Exposed=(Window,Worker)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="urlsearchparams">URLSearchParams<a class="self-link" href="#urlsearchparams"></a></dfn> {
  void <a class="idl-code" data-link-type="method" href="#dom-urlsearchparams-append">append</a>(USVString <dfn class="idl-code" data-dfn-for="URLSearchParams/append(name, value)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-append-name-value-name">name<a class="self-link" href="#dom-urlsearchparams-append-name-value-name"></a></dfn>, USVString <dfn class="idl-code" data-dfn-for="URLSearchParams/append(name, value)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-append-name-value-value">value<a class="self-link" href="#dom-urlsearchparams-append-name-value-value"></a></dfn>);
  void <a class="idl-code" data-link-type="method" href="#dom-urlsearchparams-delete">delete</a>(USVString <dfn class="idl-code" data-dfn-for="URLSearchParams/delete(name)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-delete-name-name">name<a class="self-link" href="#dom-urlsearchparams-delete-name-name"></a></dfn>);
  USVString? <a class="idl-code" data-link-type="method" href="#dom-urlsearchparams-get">get</a>(USVString <dfn class="idl-code" data-dfn-for="URLSearchParams/get(name)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-get-name-name">name<a class="self-link" href="#dom-urlsearchparams-get-name-name"></a></dfn>);
  sequence&lt;USVString> <a class="idl-code" data-link-type="method" href="#dom-urlsearchparams-getall">getAll</a>(USVString <dfn class="idl-code" data-dfn-for="URLSearchParams/getAll(name)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-getall-name-name">name<a class="self-link" href="#dom-urlsearchparams-getall-name-name"></a></dfn>);
  boolean <a class="idl-code" data-link-type="method" href="#dom-urlsearchparams-has">has</a>(USVString <dfn class="idl-code" data-dfn-for="URLSearchParams/has(name)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-has-name-name">name<a class="self-link" href="#dom-urlsearchparams-has-name-name"></a></dfn>);
  void <a class="idl-code" data-link-type="method" href="#dom-urlsearchparams-set">set</a>(USVString <dfn class="idl-code" data-dfn-for="URLSearchParams/set(name, value)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-set-name-value-name">name<a class="self-link" href="#dom-urlsearchparams-set-name-value-name"></a></dfn>, USVString <dfn class="idl-code" data-dfn-for="URLSearchParams/set(name, value)" data-dfn-type="argument" data-export="" id="dom-urlsearchparams-set-name-value-value">value<a class="self-link" href="#dom-urlsearchparams-set-name-value-value"></a></dfn>);
  iterable&lt;USVString, USVString>;
  <a data-link-type="dfn" href="#stringification-behavior">stringifier</a>;
};
</pre>


   <p>A <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object has an associated
<dfn data-dfn-type="dfn" data-lt="URLSearchParams list" data-noexport="" id="concept-urlsearchparams-list">list<a class="self-link" href="#concept-urlsearchparams-list"></a></dfn> of name-value pairs, which is initially
empty.

</p>
   <p>A <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object has an associated list of zero or more
<dfn data-dfn-type="dfn" data-lt="URLSearchParams URL object" data-noexport="" id="concept-urlsearchparams-url-object">url objects<a class="self-link" href="#concept-urlsearchparams-url-object"></a></dfn>, which is initially empty.

</p>
   <p class="note" role="note"><code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> objects always use <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">utf-8</a> as <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#encoding">encoding</a>,
despite the existence of concepts such as
<a data-link-type="dfn" href="#concept-urlutils-query-encoding">query encoding</a>. This is to
encourage developers to migrate towards
<a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8">utf-8</a>, which they really ought to
have done a long time ago now.

</p>
   <p>To create a
<dfn data-dfn-type="dfn" data-lt="URLSearchParams new" data-noexport="" id="concept-urlsearchparams-new">new <code>URLSearchParams</code> object<a class="self-link" href="#concept-urlsearchparams-new"></a></dfn>,
optionally using <var>init</var>, run these steps:

</p>
   <ol>
 
    <li>
     <p>Let <var>query</var> be a new <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object.

 </p>
    <li>
     <p>If <var>init</var> is a string,
 set <var>query</var>’s <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a> to the
 result of <a data-link-type="dfn" href="#concept-urlencoded-string-parser">parsing</a>
 <var>init</var>.

 </p>
    <li>
     <p>If <var>init</var> is a <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object, set
 <var>query</var>’s <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a> to a copy
 of <var>init</var>’s <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>.

 </p>
    <li>
     <p>Return <var>query</var>.
</p></ol>


   <p>A <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object’s
<dfn data-dfn-type="dfn" data-lt="URLSearchParams update" data-noexport="" id="concept-urlsearchparams-update">update steps<a class="self-link" href="#concept-urlsearchparams-update"></a></dfn> are to run these steps for
each associated  <a data-link-type="dfn" href="#concept-urlsearchparams-url-object">url object</a>
<var>urlObject</var>, in order:

</p>
   <ol>
 
    <li>
     <p>Set <var>urlObject</var>’s <a data-link-type="dfn" href="#concept-urlutils-url">url</a>’s
 <a data-link-type="dfn" href="#concept-url-query">query</a> to the
 <a data-link-type="dfn" href="#concept-urlencoded-serializer">serialization</a> of
 <code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object’s
 <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>.

 </p>
    <li>
     <p>Run <var>urlObject</var>’s <a data-link-type="dfn" href="#pre_update-steps">pre-update steps</a>.
</p></ol>


   <p>The
<dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="constructor" data-export="" id="dom-urlsearchparams-urlsearchparams"><code>URLSearchParams(<var>init</var>)</code><a class="self-link" href="#dom-urlsearchparams-urlsearchparams"></a></dfn>
constructor, when invoked, must return a
<a data-link-type="dfn" href="#concept-urlsearchparams-new">new <code>URLSearchParams</code> object</a>
using <var>init</var> if given.

</p>
   <p>The
<dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="method" data-export="" id="dom-urlsearchparams-append"><code>append(<var>name</var>, <var>value</var>)</code><a class="self-link" href="#dom-urlsearchparams-append"></a></dfn>
method, when invoked, must run these steps:

</p>
   <ol>
 
    <li>
     <p>Append a new name-value pair whose name is <var>name</var> and
 value is <var>value</var>, to <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>.

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#concept-urlsearchparams-update">update steps</a>.
</p></ol>


   <p>The
<dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="method" data-export="" id="dom-urlsearchparams-delete"><code>delete(<var>name</var>)</code><a class="self-link" href="#dom-urlsearchparams-delete"></a></dfn>
method, when invoked, must run these steps:

</p>
   <ol>
 
    <li>
     <p>Remove all name-value pairs whose name is <var>name</var> from
 <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>.

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#concept-urlsearchparams-update">update steps</a>.
</p></ol>


   <p>The
<dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="method" data-export="" id="dom-urlsearchparams-get"><code>get(<var>name</var>)</code><a class="self-link" href="#dom-urlsearchparams-get"></a></dfn>
method, when invoked, must return the value of the first name-value pair whose name is
<var>name</var> in <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>, and null if
there is no such pair.

</p>
   <p>The
<dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="method" data-export="" id="dom-urlsearchparams-getall"><code>getAll(<var>name</var>)</code><a class="self-link" href="#dom-urlsearchparams-getall"></a></dfn>
method, when invoked, must return the values of all name-value pairs whose name is
<var>name</var>, in <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>,
in list order, and the empty sequence otherwise.

</p>
   <p>The
<dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="method" data-export="" id="dom-urlsearchparams-set"><code>set(<var>name</var>, <var>value</var>)</code><a class="self-link" href="#dom-urlsearchparams-set"></a></dfn>
method, when invoked, must run these steps:

</p>
   <ol>
 
    <li>
     <p>If there are any name-value pairs whose name is <var>name</var>, in
 <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>, set the value of the first such
 name-value pair to <var>value</var> and remove the others.

 </p>
    <li>
     <p>Otherwise, append a new name-value pair whose name is <var>name</var> and
 value is <var>value</var>, to <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>.

 </p>
    <li>
     <p>Run the <a data-link-type="dfn" href="#concept-urlsearchparams-update">update steps</a>.
</p></ol>


   <p>The
<dfn class="idl-code" data-dfn-for="URLSearchParams" data-dfn-type="method" data-export="" id="dom-urlsearchparams-has"><code>has(<var>name</var>)</code><a class="self-link" href="#dom-urlsearchparams-has"></a></dfn>
method, when invoked, must return true if there is a name-value pair whose name is
<var>name</var> in <a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>, and false
otherwise.

</p>
   <p>The <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-value-pairs-to-iterate-over">value pairs to iterate over</a> are the
<a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a> name-value pairs with the key being
the name and the value being the value.

</p>
   <p>The <dfn data-dfn-for="URLSearchParams" data-dfn-type="dfn" data-noexport="" id="stringification-behavior">stringification behavior<a class="self-link" href="#stringification-behavior"></a></dfn> must return the
<a data-link-type="dfn" href="#concept-urlencoded-serializer">serialization</a> of the
<code class="idl"><a data-link-type="idl" href="#urlsearchparams">URLSearchParams</a></code> object’s
<a data-link-type="dfn" href="#concept-urlsearchparams-list">list</a>.


</p>
   <h3 class="heading settled" data-level="6.5" id="url-apis-elsewhere"><span class="secno">6.5. </span><span class="content">URL APIs elsewhere</span><a class="self-link" href="#url-apis-elsewhere"></a></h3>


   <p>A standard that exposes <a data-link-type="dfn" href="#concept-url">URLs</a>, should expose the
<a data-link-type="dfn" href="#concept-url">URL</a> as a string (by <a data-link-type="dfn" href="#concept-url-serializer">serializing</a> an internal
<a data-link-type="dfn" href="#concept-url">URL</a>). A standard should not expose a <a data-link-type="dfn" href="#concept-url">URL</a> using a
<code class="idl"><a data-link-type="idl" href="#url">URL</a></code> object. <code class="idl"><a data-link-type="idl" href="#url">URL</a></code> objects are
meant for <a data-link-type="dfn" href="#concept-url">URL</a> manipulation. In IDL the USVString type should be used.

</p>
   <p class="note" role="note">The higher-level notion here is that values are to be exposed as immutable
data structures.

</p>
   <p>If a standard decides to use a variant of the name "URL" for a feature it defines, it
should name such a feature "url" (i.e. lowercase and with an "l" at the end). Names such
as "URL", "URI", and "IRI" should not be used. However, if the name is a compound, "URL"
(i.e. uppercase) is preferred, e.g. "newURL" and "oldURL".

</p>
   <p class="note" role="note">The <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#eventsource">EventSource</a></code> and
<code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#hashchangeevent">HashChangeEvent</a></code> interfaces in HTML are examples of
proper naming. <a data-link-type="biblio" href="#biblio-html">[HTML]</a>



</p>
   <h2 class="no-num heading settled" id="acknowledgments"><span class="content">Acknowledgments</span><a class="self-link" href="#acknowledgments"></a></h2>


   <p>There have been a lot of people that have helped make
<a class="no-backref" data-link-type="dfn" href="#concept-url">URLs</a> more interoperable over the years and
thereby furthered the goals of this standard. Likewise many people have helped making this
standard what it is today.

</p>
   <p>With that, many thanks to
Adam Barth,
Albert Wiersch,
Alexandre Morgaut,
Arkadiusz Michalski,
Behnam Esfahbod,
Bobby Holley,
Boris Zbarsky,
Brandon Ross,
Chris Rebert,
Dan Appelquist,
Daniel Bratell,
David Håsäther,
David Sheets,
David Singer,
David Walp,
Erik Arvidsson,
Gavin Carothers,
Geoff Richards,
Glenn Maynard,
Henri Sivonen,
Ian Hickson,
James Graham,
James Manger,
James Ross,
Joshua Bell,
Jxck,
Kevin Grandon,
Larry Masinter,
Mark Davis,
Marcos Cáceres,
Martin Dürst,
Mathias Bynens,
Michael Peick,
Michael™ Smith,
Michel Suignard,
Peter Occil,
Rodney Rehm,
Roy Fielding,
Santiago M. Mola,
Sebastian Mayr,
Simon Pieters,
Simon Sapin,
Stuart Cook,
Sven Uhlig,
Tab Atkins,
Tantek Çelik,
Tim Berners-Lee,
Tomek Wytrębowicz,
Valentin Gosu,
Vyacheslav Matva, and
成瀬ゆい (Yui Naruse)
for being awesome!

</p>
   <p>This standard is written by
<a href="https://annevankesteren.nl/" lang="nl">Anne van Kesteren</a>
(<a href="https://www.mozilla.org/">Mozilla</a>,
<a href="mailto:annevk@annevk.nl">annevk@annevk.nl</a>)
and
<a href="http://intertwingly.net/" lang="en-US">Sam Ruby</a>
(<a href="//www.ibm.com/">IBM</a>,
<a href="mailto:rubys@intertwingly.net">rubys@intertwingly.net</a>).

</p>
   <p>Per <a href="//creativecommons.org/publicdomain/zero/1.0/" rel="license">CC0</a>, to
the extent possible under law, the editors have waived all copyright and related or
neighboring rights to this work.





</p></main>
  

  <div data-fill-with="conformance">
	
   <h2 class="no-num no-ref heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>

	
   <p>All diagrams, examples, and notes in this specification are non-normative, as are all sections explicitly marked non-normative. Everything else in this specification is normative.

	</p>
   <p>The key words "MUST", "MUST NOT", "REQUIRED",  "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this specification are to be interpreted as described in RFC2119. For readability, these words do not appear in all uppercase letters in this specification. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a>

	</p>
   <p>Conformance requirements phrased as algorithms or specific steps may be implemented in any manner, so long as the end result is equivalent. (In particular, the algorithms defined in this specification are intended to be easy to follow, and not intended to be performant.)
</p></div>
  

  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="indexlist">
   <li>absolute URL, <a href="#concept-absolute-url">4.1</a>
   <li>append(name, value), <a href="#dom-urlsearchparams-append">6.4</a>
   <li>application/x-www-form-urlencoded, <a href="#application-x-www-form-urlencoded-0">5</a>
   <li>ASCII alpha, <a href="#ascii-alpha">1</a>
   <li>ASCII alphanumeric, <a href="#ascii-alphanumeric">1</a>
   <li>ASCII digits, <a href="#ascii-digits">1</a>
   <li>ASCII hex digits, <a href="#ascii-hex-digits">1</a>
   <li>ASCII string, <a href="#ascii-string">1</a>
   <li>authority state, <a href="#authority-state">4.2</a>
   <li>base, <a href="#dom-url-url-url-base-base">6</a>
   <li>base URL, <a href="#concept-base-url">4</a>
   <li>basic URL parser, <a href="#concept-basic-url-parser">4.2</a>
   <li>c, <a href="#c">1.1</a>
   <li>C0 controls, <a href="#c0-controls">1</a>
   <li>C0 controls and space, <a href="#c0-controls-and-space">1</a>
   <li>default encode set, <a href="#default-encode-set">2</a>
   <li>default port, <a href="#default-port">4</a>
   <li>delete(name), <a href="#dom-urlsearchparams-delete">6.4</a>
   <li>domain
    <ul>
     <li>definition of, <a href="#concept-domain">3</a>
     <li>argument for URL/domainToASCII(domain), <a href="#dom-url-domaintoascii-domain-domain">6</a>
     <li>argument for URL/domainToUnicode(domain), <a href="#dom-url-domaintounicode-domain-domain">6</a>
    </ul>
   <li>domain to ASCII, <a href="#concept-domain-to-ascii">3.1</a>
   <li>domainToASCII(domain), <a href="#dom-url-domaintoascii">6.2</a>
   <li>domain to Unicode, <a href="#concept-domain-to-unicode">3.1</a>
   <li>domainToUnicode(domain), <a href="#dom-url-domaintounicode">6.2</a>
   <li>EOF code point, <a href="#eof-code-point">1.1</a>
   <li>file host state, <a href="#file-host-state">4.2</a>
   <li>fragment state, <a href="#fragment-state">4.2</a>
   <li>getAll(name), <a href="#dom-urlsearchparams-getall">6.4</a>
   <li>get(name), <a href="#dom-urlsearchparams-get">6.4</a>
   <li>get the base, <a href="#concept-urlutils-get-the-base">6</a>
   <li>hash, <a href="#dom-urlutils-hash">6.3</a>
   <li>has(name), <a href="#dom-urlsearchparams-has">6.4</a>
   <li>host
    <ul>
     <li>definition of, <a href="#concept-host">3</a>
     <li>attribute for URLUtils, URLUtilsReadOnly, <a href="#dom-urlutils-host">6.3</a>
    </ul>
   <li>hostname, <a href="#dom-urlutils-hostname">6.3</a>
   <li>hostname state, <a href="#hostname-state">4.2</a>
   <li>host parser, <a href="#concept-host-parser">3.3</a>
   <li>host serializer, <a href="#concept-host-serializer">3.4</a>
   <li>host state, <a href="#host-state">4.2</a>
   <li>href, <a href="#dom-urlutils-href">6.3</a>
   <li>include credentials, <a href="#include-credentials">4</a>
   <li>init, <a href="#dom-urlsearchparams-urlsearchparams-init-init">6.4</a>
   <li>IPV4 address, <a href="#concept-ipv4">3</a>
   <li>IPv4 number parser, <a href="#ipv4-number-parser">3.3</a>
   <li>IPv4 parser, <a href="#concept-ipv4-parser">3.3</a>
   <li>IPv4 serializer, <a href="#concept-ipv4-serializer">3.4</a>
   <li>IPv6 address, <a href="#concept-ipv6">3</a>
   <li>IPv6 parser, <a href="#concept-ipv6-parser">3.3</a>
   <li>IPv6 parser Finale, <a href="#concept-ipv6-parser-finale">3.3</a>
   <li>IPv6 parser IPv4, <a href="#concept-ipv6-parser-ipv4">3.3</a>
   <li>IPv6 parser Main, <a href="#concept-ipv6-parser-main">3.3</a>
   <li>IPv6 piece, <a href="#concept-ipv6-piece">3</a>
   <li>IPv6 serializer, <a href="#concept-ipv6-serializer">3.4</a>
   <li>is local, <a href="#is-local">4</a>
   <li>is special, <a href="#is-special">4</a>
   <li>local scheme, <a href="#local-scheme">4</a>
   <li>name
    <ul>
     <li>argument for URLSearchParams/append(name, value), <a href="#dom-urlsearchparams-append-name-value-name">6.4</a>
     <li>argument for URLSearchParams/delete(name), <a href="#dom-urlsearchparams-delete-name-name">6.4</a>
     <li>argument for URLSearchParams/get(name), <a href="#dom-urlsearchparams-get-name-name">6.4</a>
     <li>argument for URLSearchParams/getAll(name), <a href="#dom-urlsearchparams-getall-name-name">6.4</a>
     <li>argument for URLSearchParams/has(name), <a href="#dom-urlsearchparams-has-name-name">6.4</a>
     <li>argument for URLSearchParams/set(name, value), <a href="#dom-urlsearchparams-set-name-value-name">6.4</a>
    </ul>
   <li>non-relative flag, <a href="#non_relative-flag">4</a>
   <li>non-relative path state, <a href="#non_relative-path-state">4.2</a>
   <li>no scheme state, <a href="#no-scheme-state">4.2</a>
   <li>origin, <a href="#dom-urlutils-origin">6.3</a>
   <li>parse error, <a href="#parse-error">1.1</a>
   <li>password, <a href="#dom-urlutils-password">6.3</a>
   <li>password encode set, <a href="#password-encode-set">2</a>
   <li>pathname, <a href="#dom-urlutils-pathname">6.3</a>
   <li>path or authority state, <a href="#path-or-authority-state">4.2</a>
   <li>path start state, <a href="#path-start-state">4.2</a>
   <li>path state, <a href="#path-state">4.2</a>
   <li>percent decode, <a href="#percent-decode">2</a>
   <li>percent encode, <a href="#percent-encode">2</a>
   <li>percent-encoded byte, <a href="#percent_encoded-byte">2</a>
   <li>port, <a href="#dom-urlutils-port">6.3</a>
   <li>port state, <a href="#port-state">4.2</a>
   <li>pre-update steps, <a href="#pre_update-steps">6</a>
   <li>protocol, <a href="#dom-urlutils-protocol">6.3</a>
   <li>query state, <a href="#query-state">4.2</a>
   <li>relative slash state, <a href="#relative-slash-state">4.2</a>
   <li>relative state, <a href="#relative-state">4.2</a>
   <li>relative URL, <a href="#concept-relative-url">4.1</a>
   <li>remaining, <a href="#remaining">1.1</a>
   <li>scheme-relative URL, <a href="#concept-scheme-relative-url">4.1</a>
   <li>scheme start state, <a href="#scheme-start-state">4.2</a>
   <li>scheme state, <a href="#scheme-state">4.2</a>
   <li>search, <a href="#dom-urlutils-search">6.3</a>
   <li>searchParams, <a href="#dom-urlutilssearchparams-searchparams">6.3</a>
   <li>set(name, value), <a href="#dom-urlsearchparams-set">6.4</a>
   <li>set the password, <a href="#set-the-password">4.2</a>
   <li>set the username, <a href="#set-the-username">4.2</a>
   <li>simple encode set, <a href="#simple-encode-set">2</a>
   <li>special authority ignore slashes state, <a href="#special-authority-ignore-slashes-state">4.2</a>
   <li>special authority slashes state, <a href="#special-authority-slashes-state">4.2</a>
   <li>special relative or authority state, <a href="#special-relative-or-authority-state">4.2</a>
   <li>special scheme, <a href="#special-scheme">4</a>
   <li>stringification behavior
    <ul>
     <li>dfn for URLUtils, <a href="#URLUtils-stringification-behavior">6</a>
     <li>dfn for URLUtilsReadOnly, <a href="#URLUtilsReadOnly-stringification-behavior">6</a>
     <li>dfn for URLSearchParams, <a href="#stringification-behavior">6.4</a>
    </ul>
   <li>URL
    <ul>
     <li>definition of, <a href="#concept-url">4</a>
     <li>(interface), <a href="#url">6</a>
    </ul>
   <li>url, <a href="#dom-url-url-url-base-url">6</a>
   <li>URL code points, <a href="#url-code-points">4.1</a>
   <li>urlencoded byte serializer, <a href="#concept-urlencoded-byte-serializer">5.2</a>
   <li>urlencoded parser, <a href="#concept-urlencoded-parser">5.1</a>
   <li>urlencoded serializer, <a href="#concept-urlencoded-serializer">5.2</a>
   <li>urlencoded string parser, <a href="#concept-urlencoded-string-parser">5.3</a>
   <li>URL fragment, <a href="#concept-url-fragment">4</a>
   <li>URL host, <a href="#concept-url-host">4</a>
   <li>URL object, <a href="#concept-url-object">4</a>
   <li>URL origin, <a href="#concept-url-origin">4.4</a>
   <li>URL parser, <a href="#concept-url-parser">4.2</a>
   <li>URL password, <a href="#concept-url-password">4</a>
   <li>URL path, <a href="#concept-url-path">4</a>
   <li>URL port, <a href="#concept-url-port">4</a>
   <li>URL query, <a href="#concept-url-query">4</a>
   <li>URL scheme, <a href="#concept-url-scheme">4</a>
   <li>URLSearchParams, <a href="#urlsearchparams">6.4</a>
   <li>URLSearchParams(init), <a href="#dom-urlsearchparams-urlsearchparams">6.4</a>
   <li>URLSearchParams list, <a href="#concept-urlsearchparams-list">6.4</a>
   <li>URLSearchParams new, <a href="#concept-urlsearchparams-new">6.4</a>
   <li>URLSearchParams update, <a href="#concept-urlsearchparams-update">6.4</a>
   <li>URLSearchParams URL object, <a href="#concept-urlsearchparams-url-object">6.4</a>
   <li>URL serializer, <a href="#concept-url-serializer">4.3</a>
   <li>URL units, <a href="#url-units">4.1</a>
   <li>URL(url, base), <a href="#dom-url-url">6.1</a>
   <li>URL username, <a href="#concept-url-username">4</a>
   <li>URLUtils, <a href="#urlutils">6</a>
   <li>URLUtils input, <a href="#concept-urlutils-input">6</a>
   <li>URLUtils query encoding, <a href="#concept-urlutils-query-encoding">6</a>
   <li>URLUtils query object, <a href="#concept-urlutils-query-object">6</a>
   <li>URLUtilsReadOnly, <a href="#urlutilsreadonly">6</a>
   <li>URLUtilsSearchParams, <a href="#urlutilssearchparams">6</a>
   <li>URLUtils set the input, <a href="#concept-urlutils-set-the-input">6</a>
   <li>URLUtils update, <a href="#concept-urlutils-update">6</a>
   <li>URLUtils URL, <a href="#concept-urlutils-url">6</a>
   <li>username, <a href="#dom-urlutils-username">6.3</a>
   <li>username encode set, <a href="#username-encode-set">2</a>
   <li>utf-8 percent encode, <a href="#utf_8-percent-encode">2</a>
   <li>valid domain, <a href="#valid-domain">3.2</a>
   <li>value
    <ul>
     <li>argument for URLSearchParams/append(name, value), <a href="#dom-urlsearchparams-append-name-value-value">6.4</a>
     <li>argument for URLSearchParams/set(name, value), <a href="#dom-urlsearchparams-set-name-value-value">6.4</a>
    </ul></ul>
  <h3 class="no-num heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="indexlist">
   <li><a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#location">Location</a>
    </ul></ul>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom"><a class="self-link" href="#biblio-dom"></a>[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM</a>. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-encoding"><a class="self-link" href="#biblio-encoding"></a>[ENCODING]
   <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/">Encoding</a>. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
   <dt id="biblio-fileapi"><a class="self-link" href="#biblio-fileapi"></a>[FILEAPI]
   <dd>Arun Ranganathan; Jonas Sicking. <a href="http://dev.w3.org/2006/webapi/FileAPI/">File API</a>. URL: <a href="http://dev.w3.org/2006/webapi/FileAPI/">http://dev.w3.org/2006/webapi/FileAPI/</a>
   <dt id="biblio-html"><a class="self-link" href="#biblio-html"></a>[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-idna"><a class="self-link" href="#biblio-idna"></a>[IDNA]
   <dd>Mark Davis; Michel Suignard. <a href="http://www.unicode.org/reports/tr46/">Unicode IDNA Compatibility Processing</a>. URL: <a href="http://www.unicode.org/reports/tr46/">http://www.unicode.org/reports/tr46/</a>
   <dt id="biblio-webidl"><a class="self-link" href="#biblio-webidl"></a>[WEBIDL]
   <dd>Boris Zbarsky; Cameron McCormack. <a href="https://heycam.github.io/webidl/">Web IDL</a>. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc4291"><a class="self-link" href="#biblio-rfc4291"></a>[RFC4291]
   <dd>R. Hinden; S. Deering. <a href="https://tools.ietf.org/html/rfc4291">IP Version 6 Addressing Architecture</a>. February 2006. Draft Standard. URL: <a href="https://tools.ietf.org/html/rfc4291">https://tools.ietf.org/html/rfc4291</a></dl>
  <h3 class="no-num heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-fetch"><a class="self-link" href="#biblio-fetch"></a>[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-referrer-policy"><a class="self-link" href="#biblio-referrer-policy"></a>[REFERRER-POLICY]
   <dd>Jochen Eisinger; Mike West. <a href="https://w3c.github.io/webappsec/specs/referrer-policy/">Referrer Policy</a>. 7 August 2014. WD. URL: <a href="https://w3c.github.io/webappsec/specs/referrer-policy/">https://w3c.github.io/webappsec/specs/referrer-policy/</a>
   <dt id="biblio-rfc3986"><a class="self-link" href="#biblio-rfc3986"></a>[RFC3986]
   <dd>T. Berners-Lee; R. Fielding; L. Masinter. <a href="https://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>. January 2005. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc3986">https://tools.ietf.org/html/rfc3986</a>
   <dt id="biblio-rfc3987"><a class="self-link" href="#biblio-rfc3987"></a>[RFC3987]
   <dd>M. Duerst; M. Suignard. <a href="https://tools.ietf.org/html/rfc3987">Internationalized Resource Identifiers (IRIs)</a>. January 2005. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc3987">https://tools.ietf.org/html/rfc3987</a>
   <dt id="biblio-rfc5952"><a class="self-link" href="#biblio-rfc5952"></a>[RFC5952]
   <dd>S. Kawamura; M. Kawashima. <a href="https://tools.ietf.org/html/rfc5952">A Recommendation for IPv6 Address Text Representation</a>. August 2010. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc5952">https://tools.ietf.org/html/rfc5952</a>
   <dt id="biblio-rfc6454"><a class="self-link" href="#biblio-rfc6454"></a>[RFC6454]
   <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a></dl>
  <h2 class="no-num heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
  <pre class="idl">[<a class="idl-code" data-link-type="constructor" href="#dom-url-url">Constructor</a>(USVString <a href="#dom-url-url-url-base-url">url</a>, optional USVString <a href="#dom-url-url-url-base-base">base</a>),
 Exposed=(Window,Worker)]
interface <a href="#url">URL</a> {
  static USVString <a class="idl-code" data-link-type="method" href="#dom-url-domaintoascii">domainToASCII</a>(USVString <a href="#dom-url-domaintoascii-domain-domain">domain</a>);
  static USVString <a class="idl-code" data-link-type="method" href="#dom-url-domaintounicode">domainToUnicode</a>(USVString <a href="#dom-url-domaintounicode-domain-domain">domain</a>);
};
<a data-link-type="idl-name" href="#url">URL</a> implements <a data-link-type="idl-name" href="#urlutils">URLUtils</a>;
<a data-link-type="idl-name" href="#url">URL</a> implements <a data-link-type="idl-name" href="#urlutilssearchparams">URLUtilsSearchParams</a>;

[NoInterfaceObject,
 Exposed=(Window,Worker)]
interface <a href="#urlutils">URLUtils</a> {
  <a href="#URLUtils-stringification-behavior">stringifier</a> attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-href">href</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-origin">origin</a>;

           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-protocol">protocol</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-username">username</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-password">password</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-host">host</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-hostname">hostname</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-port">port</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-pathname">pathname</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-search">search</a>;
           attribute USVString <a class="idl-code" data-link-type="attribute" data-type="USVString " href="#dom-urlutils-hash">hash</a>;
};

[NoInterfaceObject,
 Exposed=(Window, Worker)]
interface <a href="#urlutilssearchparams">URLUtilsSearchParams</a> {
           attribute <a data-link-type="idl-name" href="#urlsearchparams">URLSearchParams</a> <a class="idl-code" data-link-type="attribute" data-type="URLSearchParams " href="#dom-urlutilssearchparams-searchparams">searchParams</a>;
};

[NoInterfaceObject,
 Exposed=(Window,Worker)]
interface <a href="#urlutilsreadonly">URLUtilsReadOnly</a> {
  <a href="#URLUtilsReadOnly-stringification-behavior">stringifier</a> readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-href">href</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-origin">origin</a>;

  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-protocol">protocol</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-host">host</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-hostname">hostname</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-port">port</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-pathname">pathname</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-search">search</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-urlutils-hash">hash</a>;
};

[<a class="idl-code" data-link-type="constructor" href="#dom-urlsearchparams-urlsearchparams">Constructor</a>(optional (USVString or <a data-link-type="idl-name" href="#urlsearchparams">URLSearchParams</a>) <a href="#dom-urlsearchparams-urlsearchparams-init-init">init</a> = ""),
 Exposed=(Window,Worker)]
interface <a href="#urlsearchparams">URLSearchParams</a> {
  void <a class="idl-code" data-link-type="method" href="#dom-urlsearchparams-append">append</a>(USVString <a href="#dom-urlsearchparams-append-name-value-name">name</a>, USVString <a href="#dom-urlsearchparams-append-name-value-value">value</a>);
  void <a class="idl-code" data-link-type="method" href="#dom-urlsearchparams-delete">delete</a>(USVString <a href="#dom-urlsearchparams-delete-name-name">name</a>);
  USVString? <a class="idl-code" data-link-type="method" href="#dom-urlsearchparams-get">get</a>(USVString <a href="#dom-urlsearchparams-get-name-name">name</a>);
  sequence&lt;USVString> <a class="idl-code" data-link-type="method" href="#dom-urlsearchparams-getall">getAll</a>(USVString <a href="#dom-urlsearchparams-getall-name-name">name</a>);
  boolean <a class="idl-code" data-link-type="method" href="#dom-urlsearchparams-has">has</a>(USVString <a href="#dom-urlsearchparams-has-name-name">name</a>);
  void <a class="idl-code" data-link-type="method" href="#dom-urlsearchparams-set">set</a>(USVString <a href="#dom-urlsearchparams-set-name-value-name">name</a>, USVString <a href="#dom-urlsearchparams-set-name-value-value">value</a>);
  iterable&lt;USVString, USVString>;
  <a data-link-type="dfn" href="#stringification-behavior">stringifier</a>;
};

</pre>
 </body>
</html>